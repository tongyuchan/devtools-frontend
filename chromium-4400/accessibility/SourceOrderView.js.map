{"version":3,"file":"SourceOrderView.js","sourceRoot":"","sources":["../../../../../front_end/accessibility/SourceOrderView.js"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../host/host.js';\nimport {ls} from '../platform/platform.js';\nimport * as SDK from '../sdk/sdk.js';  // eslint-disable-line no-unused-vars\nimport * as UI from '../ui/ui.js';\n\nimport {AccessibilitySubPane} from './AccessibilitySubPane.js';\n\nconst MAX_CHILD_ELEMENTS_THRESHOLD = 300;\n\nexport class SourceOrderPane extends AccessibilitySubPane {\n  constructor() {\n    super(ls`Source Order Viewer`);\n\n    this._noNodeInfo = this.createInfo(ls`No source order information available`);\n    this._warning =\n        this.createInfo(ls`There may be a delay in displaying source order for elements with many children`);\n    this._warning.id = 'source-order-warning';\n    this._checked = false;\n    this._checkboxLabel = UI.UIUtils.CheckboxLabel.create(/* title */ ls`Show source order`, /* checked */ false);\n    this._checkboxElement = this._checkboxLabel.checkboxElement;\n\n    this._checkboxLabel.classList.add('source-order-checkbox');\n    this._checkboxElement.addEventListener('click', this._checkboxClicked.bind(this), false);\n    this.element.appendChild(this._checkboxLabel);\n\n    /** @type {?SDK.DOMModel.DOMNode} */\n    this._node = null;\n    this._overlayModel = null;\n  }\n\n  /**\n   * @param {?SDK.DOMModel.DOMNode} node\n   * @returns {!Promise.<?>}\n   */\n  async setNodeAsync(node) {\n    if (!this._checkboxLabel.classList.contains('hidden')) {\n      this._checked = this._checkboxElement.checked;\n    }\n    this._checkboxElement.checked = false;\n    this._checkboxClicked();\n    super.setNode(node);\n    if (!this._node) {\n      this._overlayModel = null;\n      return;\n    }\n\n    let foundSourceOrder = false;\n    const childCount = this._node.childNodeCount();\n    if (childCount > 0) {\n      if (!this._node.children()) {\n        await this._node.getSubtree(1, false);\n      }\n      const children = /** @type {!Array<!SDK.DOMModel.DOMNode>} */ (this._node.children());\n      foundSourceOrder = children.some(child => child.nodeType() === Node.ELEMENT_NODE);\n    }\n\n    this._noNodeInfo.classList.toggle('hidden', foundSourceOrder);\n    this._warning.classList.toggle('hidden', childCount < MAX_CHILD_ELEMENTS_THRESHOLD);\n    this._checkboxLabel.classList.toggle('hidden', !foundSourceOrder);\n    if (foundSourceOrder) {\n      this._overlayModel = this._node.domModel().overlayModel();\n      this._checkboxElement.checked = this._checked;\n      this._checkboxClicked();\n    } else {\n      this._overlayModel = null;\n    }\n  }\n\n  _checkboxClicked() {\n    if (!this._node || !this._overlayModel) {\n      return;\n    }\n\n    if (this._checkboxElement.checked) {\n      Host.userMetrics.actionTaken(Host.UserMetrics.Action.SourceOrderViewActivated);\n      this._overlayModel.highlightSourceOrderInOverlay(this._node);\n    } else {\n      this._overlayModel.hideSourceOrderInOverlay();\n    }\n  }\n}\n"]}