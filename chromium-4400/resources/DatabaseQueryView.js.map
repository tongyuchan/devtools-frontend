{"version":3,"file":"DatabaseQueryView.js","sourceRoot":"","sources":["../../../../../front_end/resources/DatabaseQueryView.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2008 Apple Inc. All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as DataGrid from '../data_grid/data_grid.js';\nimport {ls} from '../platform/platform.js';\nimport * as UI from '../ui/ui.js';\n\nimport {Database} from './DatabaseModel.js';  // eslint-disable-line no-unused-vars\n\nexport class DatabaseQueryView extends UI.Widget.VBox {\n  /**\n   * @param {!Database} database\n   */\n  constructor(database) {\n    super();\n\n    this.database = database;\n\n    this.element.classList.add('storage-view', 'query', 'monospace');\n    this.element.addEventListener('selectstart', this._selectStart.bind(this), false);\n\n    this._queryWrapper = this.element.createChild('div', 'database-query-group-messages');\n    this._queryWrapper.addEventListener('focusin', /** @type {!EventListener} */ (this._onFocusIn.bind(this)));\n    this._queryWrapper.addEventListener('focusout', /** @type {!EventListener} */ (this._onFocusOut.bind(this)));\n    this._queryWrapper.addEventListener('keydown', /** @type {!EventListener} */ (this._onKeyDown.bind(this)));\n    this._queryWrapper.tabIndex = -1;\n\n    this._promptContainer = this.element.createChild('div', 'database-query-prompt-container');\n    this._promptContainer.appendChild(UI.Icon.Icon.create('smallicon-text-prompt', 'prompt-icon'));\n    this._promptElement = this._promptContainer.createChild('div');\n    this._promptElement.className = 'database-query-prompt';\n    this._promptElement.addEventListener('keydown', /** @type {!EventListener} */ (this._promptKeyDown.bind(this)));\n\n    this._prompt = new UI.TextPrompt.TextPrompt();\n    this._prompt.initialize(this.completions.bind(this), ' ');\n    this._proxyElement = this._prompt.attach(this._promptElement);\n\n    this.element.addEventListener('click', this._messagesClicked.bind(this), true);\n\n    /** @type {!Array<!HTMLElement>} */\n    this._queryResults = [];\n    this._virtualSelectedIndex = -1;\n    /** @type {?Element} */\n    this._lastSelectedElement;\n    /** @type {number} */\n    this._selectionTimeout = 0;\n  }\n\n  _messagesClicked() {\n    this._prompt.focus();\n    if (!this._prompt.isCaretInsidePrompt() && !this.element.hasSelection()) {\n      this._prompt.moveCaretToEndOfPrompt();\n    }\n  }\n\n  /**\n   * @param {!KeyboardEvent} event\n   */\n  _onKeyDown(event) {\n    if (UI.UIUtils.isEditing() || !this._queryResults.length || event.shiftKey) {\n      return;\n    }\n    switch (event.key) {\n      case 'ArrowUp':\n        if (this._virtualSelectedIndex > 0) {\n          this._virtualSelectedIndex--;\n        } else {\n          return;\n        }\n        break;\n      case 'ArrowDown':\n        if (this._virtualSelectedIndex < this._queryResults.length - 1) {\n          this._virtualSelectedIndex++;\n        } else {\n          return;\n        }\n        break;\n      case 'Home':\n        this._virtualSelectedIndex = 0;\n        break;\n      case 'End':\n        this._virtualSelectedIndex = this._queryResults.length - 1;\n        break;\n      default:\n        return;\n    }\n    event.consume(true);\n    this._updateFocusedItem();\n  }\n\n  /**\n   * @param {!FocusEvent} event\n   */\n  _onFocusIn(event) {\n    // Make default selection when moving from external (e.g. prompt) to the container.\n    if (this._virtualSelectedIndex === -1 && this._isOutsideViewport(/** @type {?Element} */ (event.relatedTarget)) &&\n        event.target === this._queryWrapper && this._queryResults.length) {\n      this._virtualSelectedIndex = this._queryResults.length - 1;\n    }\n    this._updateFocusedItem();\n  }\n\n  /**\n   * @param {!FocusEvent} event\n   */\n  _onFocusOut(event) {\n    // Remove selection when focus moves to external location (e.g. prompt).\n    if (this._isOutsideViewport(/** @type {?Element} */ (event.relatedTarget))) {\n      this._virtualSelectedIndex = -1;\n    }\n    this._updateFocusedItem();\n\n    this._queryWrapper.scrollTop = 10000000;\n  }\n\n  /**\n   * @param {?Element} element\n   * @return {boolean}\n   */\n  _isOutsideViewport(element) {\n    return element !== null && !element.isSelfOrDescendant(this._queryWrapper);\n  }\n\n  _updateFocusedItem() {\n    let index = this._virtualSelectedIndex;\n    if (this._queryResults.length && this._virtualSelectedIndex < 0) {\n      index = this._queryResults.length - 1;\n    }\n\n    const selectedElement = index >= 0 ? this._queryResults[index] : null;\n    const changed = this._lastSelectedElement !== selectedElement;\n    const containerHasFocus = this._queryWrapper === this.element.ownerDocument.deepActiveElement();\n\n    if (selectedElement && (changed || containerHasFocus) && this.element.hasFocus()) {\n      if (!selectedElement.hasFocus()) {\n        selectedElement.focus();\n      }\n    }\n\n    if (this._queryResults.length && !this._queryWrapper.hasFocus()) {\n      this._queryWrapper.tabIndex = 0;\n    } else {\n      this._queryWrapper.tabIndex = -1;\n    }\n    this._lastSelectedElement = selectedElement;\n  }\n\n  /**\n   * @param {string} expression\n   * @param {string} prefix\n   * @param {boolean=} force\n   * @return {!Promise<!UI.SuggestBox.Suggestions>}\n   */\n  async completions(expression, prefix, force) {\n    if (!prefix) {\n      return [];\n    }\n\n    prefix = prefix.toLowerCase();\n    const tableNames = await this.database.tableNames();\n    return tableNames.map(name => name + ' ')\n        .concat(SQL_BUILT_INS)\n        .filter(proposal => proposal.toLowerCase().startsWith(prefix))\n        .map(completion => (/** @type {!UI.SuggestBox.Suggestion} */ ({text: completion})));\n  }\n\n  /**\n   * @param {!Event} event\n   */\n  _selectStart(event) {\n    if (this._selectionTimeout) {\n      clearTimeout(this._selectionTimeout);\n    }\n\n    this._prompt.clearAutocomplete();\n\n    /**\n     * @this {DatabaseQueryView}\n     */\n    function moveBackIfOutside() {\n      this._selectionTimeout = 0;\n      if (!this._prompt.isCaretInsidePrompt() && !this.element.hasSelection()) {\n        this._prompt.moveCaretToEndOfPrompt();\n      }\n      this._prompt.autoCompleteSoon();\n    }\n\n    this._selectionTimeout = window.setTimeout(moveBackIfOutside.bind(this), 100);\n  }\n\n  /**\n   * @param {!KeyboardEvent} event\n   */\n  _promptKeyDown(event) {\n    if (event.key === 'Enter') {\n      this._enterKeyPressed(event);\n      return;\n    }\n  }\n\n  /**\n   * @param {!KeyboardEvent} event\n   */\n  async _enterKeyPressed(event) {\n    event.consume(true);\n\n    const query = this._prompt.textWithCurrentSuggestion();\n    this._prompt.clearAutocomplete();\n\n    if (!query.length) {\n      return;\n    }\n\n    this._prompt.setEnabled(false);\n    try {\n      const result = await new Promise((resolve, reject) => {\n        this.database.executeSql(\n            query, (columnNames, values) => resolve({columnNames, values}), errorText => reject(errorText));\n      });\n      this._queryFinished(query, result.columnNames, result.values);\n    } catch (e) {\n      this._appendErrorQueryResult(query, e);\n    }\n    this._prompt.setEnabled(true);\n    this._prompt.setText('');\n    this._prompt.focus();\n  }\n\n  /**\n   *\n   * @param {string} query\n   * @param {!Array<string>} columnNames\n   * @param {!Array<*>} values\n   */\n  _queryFinished(query, columnNames, values) {\n    const dataGrid = DataGrid.SortableDataGrid.SortableDataGrid.create(columnNames, values, ls`Database Query`);\n    const trimmedQuery = query.trim();\n\n    let view = null;\n    if (dataGrid) {\n      dataGrid.setStriped(true);\n      dataGrid.renderInline();\n      dataGrid.autoSizeColumns(5);\n      view = dataGrid.asWidget();\n      dataGrid.setFocusable(false);\n    }\n    this._appendViewQueryResult(trimmedQuery, view);\n\n    if (trimmedQuery.match(/^create /i) || trimmedQuery.match(/^drop table /i)) {\n      this.dispatchEventToListeners(Events.SchemaUpdated, this.database);\n    }\n  }\n\n  /**\n   * @param {string} query\n   * @param {?UI.Widget.Widget} view\n   */\n  _appendViewQueryResult(query, view) {\n    const resultElement = this._appendQueryResult(query);\n    if (view) {\n      view.show(resultElement);\n    } else {\n      resultElement.remove();\n    }\n\n    this._scrollResultIntoView();\n  }\n\n  /**\n   * @param {string} query\n   * @param {string} errorText\n   */\n  _appendErrorQueryResult(query, errorText) {\n    const resultElement = this._appendQueryResult(query);\n    resultElement.classList.add('error');\n    resultElement.appendChild(UI.Icon.Icon.create('smallicon-error', 'prompt-icon'));\n    UI.UIUtils.createTextChild(resultElement, errorText);\n\n    this._scrollResultIntoView();\n  }\n\n  _scrollResultIntoView() {\n    this._queryResults[this._queryResults.length - 1].scrollIntoView(false);\n    this._promptElement.scrollIntoView(false);\n  }\n\n  /**\n   * @param {string} query\n   */\n  _appendQueryResult(query) {\n    const element = /** @type {!HTMLElement} */ (document.createElement('div'));\n    element.className = 'database-user-query';\n    element.tabIndex = -1;\n\n    UI.ARIAUtils.setAccessibleName(element, ls`Query: ${query}`);\n    this._queryResults.push(element);\n    this._updateFocusedItem();\n\n    element.appendChild(UI.Icon.Icon.create('smallicon-user-command', 'prompt-icon'));\n\n    const commandTextElement = document.createElement('span');\n    commandTextElement.className = 'database-query-text';\n    commandTextElement.textContent = query;\n    element.appendChild(commandTextElement);\n\n    const resultElement = document.createElement('div');\n    resultElement.className = 'database-query-result';\n    element.appendChild(resultElement);\n\n    this._queryWrapper.appendChild(element);\n    return resultElement;\n  }\n}\n\n/** @enum {symbol} */\nexport const Events = {\n  SchemaUpdated: Symbol('SchemaUpdated')\n};\n\nexport const SQL_BUILT_INS = [\n  'SELECT ', 'FROM ', 'WHERE ', 'LIMIT ', 'DELETE FROM ', 'CREATE ', 'DROP ', 'TABLE ', 'INDEX ', 'UPDATE ',\n  'INSERT INTO ', 'VALUES ('\n];\n"]}