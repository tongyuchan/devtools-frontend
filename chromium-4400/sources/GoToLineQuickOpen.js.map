{"version":3,"file":"GoToLineQuickOpen.js","sourceRoot":"","sources":["../../../../../front_end/sources/GoToLineQuickOpen.js"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../common/common.js';\nimport {ls} from '../platform/platform.js';\nimport * as QuickOpen from '../quick_open/quick_open.js';\nimport * as UI from '../ui/ui.js';\nimport * as Workspace from '../workspace/workspace.js';  // eslint-disable-line no-unused-vars\n\nimport {SourcesView} from './SourcesView.js';\nimport {UISourceCodeFrame} from './UISourceCodeFrame.js';  // eslint-disable-line no-unused-vars\n\nexport class GoToLineQuickOpen extends QuickOpen.FilteredListWidget.Provider {\n  /**\n   * @override\n   * @param {?number} itemIndex\n   * @param {string} promptValue\n   */\n  selectItem(itemIndex, promptValue) {\n    const uiSourceCode = this._currentUISourceCode();\n    if (!uiSourceCode) {\n      return;\n    }\n    const position = this._parsePosition(promptValue);\n    if (!position) {\n      return;\n    }\n    Common.Revealer.reveal(uiSourceCode.uiLocation(position.line - 1, position.column - 1));\n  }\n\n  /**\n   * @override\n   * @param {string} query\n   * @return {string}\n   */\n  notFoundText(query) {\n    if (!this._currentUISourceCode()) {\n      return Common.UIString.UIString('No file selected.');\n    }\n    const position = this._parsePosition(query);\n    const sourceFrame = this._currentSourceFrame();\n    if (!position) {\n      if (!sourceFrame) {\n        return ls`Type a number to go to that line.`;\n      }\n      const disassembly = sourceFrame.wasmDisassembly;\n      const currentLineNumber = sourceFrame.textEditor.currentLineNumber();\n      if (disassembly) {\n        const lastBytecodeOffset = disassembly.lineNumberToBytecodeOffset(disassembly.lineNumbers - 1);\n        const bytecodeOffsetDigits = lastBytecodeOffset.toString(16).length;\n        const currentPosition = disassembly.lineNumberToBytecodeOffset(currentLineNumber);\n        return ls`Current position: 0x${\n            currentPosition.toString(16).padStart(\n                bytecodeOffsetDigits,\n                '0')}. Type an offset between 0x${'0'.padStart(bytecodeOffsetDigits, '0')} and 0x${\n            lastBytecodeOffset.toString(16)} to navigate to.`;\n      }\n      const linesCount = sourceFrame.textEditor.linesCount;\n      return ls`Current line: ${currentLineNumber}. Type a line number between 1 and ${linesCount} to navigate to.`;\n    }\n\n    if (sourceFrame && sourceFrame.wasmDisassembly) {\n      return ls`Go to offset 0x${(position.column - 1).toString(16)}.`;\n    }\n    if (position.column && position.column > 1) {\n      return ls`Go to line ${position.line} and column ${position.column}.`;\n    }\n    return ls`Go to line ${position.line}.`;\n  }\n\n  /**\n   * @param {string} query\n   * @return {?{line: number, column: number}}\n   */\n  _parsePosition(query) {\n    const sourceFrame = this._currentSourceFrame();\n    if (sourceFrame && sourceFrame.wasmDisassembly) {\n      const parts = query.match(/0x([0-9a-fA-F]+)/);\n      if (!parts || !parts[0] || parts[0].length !== query.length) {\n        return null;\n      }\n\n      const column = parseInt(parts[0], 16) + 1;\n      return {line: 0, column};\n    }\n\n    const parts = query.match(/([0-9]+)(\\:[0-9]*)?/);\n    if (!parts || !parts[0] || parts[0].length !== query.length) {\n      return null;\n    }\n    const line = parseInt(parts[1], 10);\n    let column = 0;\n    if (parts[2]) {\n      column = parseInt(parts[2].substring(1), 10);\n    }\n    return {line: Math.max(line | 0, 1), column: Math.max(column | 0, 1)};\n  }\n\n  /**\n   * @return {?Workspace.UISourceCode.UISourceCode}\n   */\n  _currentUISourceCode() {\n    const sourcesView = UI.Context.Context.instance().flavor(SourcesView);\n    if (!sourcesView) {\n      return null;\n    }\n    return sourcesView.currentUISourceCode();\n  }\n\n  /**\n   * @return {?UISourceCodeFrame}\n   */\n  _currentSourceFrame() {\n    const sourcesView = UI.Context.Context.instance().flavor(SourcesView);\n    if (!sourcesView) {\n      return null;\n    }\n    return sourcesView.currentSourceFrame();\n  }\n}\n"]}