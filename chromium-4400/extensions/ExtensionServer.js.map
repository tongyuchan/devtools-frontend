{"version":3,"file":"ExtensionServer.js","sourceRoot":"","sources":["../../../../../front_end/extensions/ExtensionServer.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2011 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// @ts-nocheck\n// TODO(crbug.com/1011811): Enable TypeScript compiler checks\n\nimport * as Bindings from '../bindings/bindings.js';\nimport * as Common from '../common/common.js';\nimport * as Components from '../components/components.js';\nimport * as Host from '../host/host.js';\nimport * as Platform from '../platform/platform.js';\nimport * as ProtocolClient from '../protocol_client/protocol_client.js';  // eslint-disable-line no-unused-vars\nimport * as Root from '../root/root.js';                                  // eslint-disable-line no-unused-vars\nimport * as SDK from '../sdk/sdk.js';\nimport * as TextUtils from '../text_utils/text_utils.js';  // eslint-disable-line no-unused-vars\nimport * as ThemeSupport from '../theme_support/theme_support.js';\nimport * as UI from '../ui/ui.js';\nimport * as Workspace from '../workspace/workspace.js';\n\nimport {ExtensionButton, ExtensionPanel, ExtensionSidebarPane} from './ExtensionPanel.js';\nimport {ExtensionTraceProvider, TracingSession} from './ExtensionTraceProvider.js';  // eslint-disable-line no-unused-vars\nimport {LanguageExtensionEndpoint} from './LanguageExtensionEndpoint.js';\n\nconst extensionOriginSymbol = Symbol('extensionOrigin');\n\nconst kAllowedOrigins = [\n  'chrome://newtab',\n  'chrome://new-tab-page',\n].map(url => (new URL(url)).origin);\n\n/** @type {?ExtensionServer} */\nlet extensionServerInstance;\n\nexport class ExtensionServer extends Common.ObjectWrapper.ObjectWrapper {\n  /**\n   * @private\n   */\n  constructor() {\n    super();\n    this._clientObjects = {};\n    this._handlers = {};\n    /** @type {!Map<string, !Set<!MessagePort>>} */\n    this._subscribers = new Map();\n    this._subscriptionStartHandlers = {};\n    this._subscriptionStopHandlers = {};\n    /** @type {!Map<string, !Map<string, *>>} */\n    this._extraHeaders = new Map();\n    this._requests = {};\n    this._lastRequestId = 0;\n    /** @type {!Map<string, !{name: string}>} */\n    this._registeredExtensions = new Map();\n    this._status = new ExtensionStatus();\n    /** @type {!Array<!ExtensionSidebarPane>} */\n    this._sidebarPanes = [];\n    /** @type {!Array<!ExtensionTraceProvider>} */\n    this._traceProviders = [];\n    /** @type {!Map<string, !TracingSession>} */\n    this._traceSessions = new Map();\n    // TODO(caseq): properly unload extensions when we disable them.\n    this._extensionsEnabled = true;\n\n    const commands = Extensions.extensionAPI.Commands;\n\n    this._registerHandler(commands.AddRequestHeaders, this._onAddRequestHeaders.bind(this));\n    this._registerHandler(commands.AddTraceProvider, this._onAddTraceProvider.bind(this));\n    this._registerHandler(commands.ApplyStyleSheet, this._onApplyStyleSheet.bind(this));\n    this._registerHandler(commands.CompleteTraceSession, this._onCompleteTraceSession.bind(this));\n    this._registerHandler(commands.CreatePanel, this._onCreatePanel.bind(this));\n    this._registerHandler(commands.CreateSidebarPane, this._onCreateSidebarPane.bind(this));\n    this._registerHandler(commands.CreateToolbarButton, this._onCreateToolbarButton.bind(this));\n    this._registerHandler(commands.EvaluateOnInspectedPage, this._onEvaluateOnInspectedPage.bind(this));\n    this._registerHandler(commands.ForwardKeyboardEvent, this._onForwardKeyboardEvent.bind(this));\n    this._registerHandler(commands.GetHAR, this._onGetHAR.bind(this));\n    this._registerHandler(commands.GetPageResources, this._onGetPageResources.bind(this));\n    this._registerHandler(commands.GetRequestContent, this._onGetRequestContent.bind(this));\n    this._registerHandler(commands.GetResourceContent, this._onGetResourceContent.bind(this));\n    this._registerHandler(commands.Reload, this._onReload.bind(this));\n    this._registerHandler(commands.SetOpenResourceHandler, this._onSetOpenResourceHandler.bind(this));\n    this._registerHandler(commands.SetResourceContent, this._onSetResourceContent.bind(this));\n    this._registerHandler(commands.SetSidebarHeight, this._onSetSidebarHeight.bind(this));\n    this._registerHandler(commands.SetSidebarContent, this._onSetSidebarContent.bind(this));\n    this._registerHandler(commands.SetSidebarPage, this._onSetSidebarPage.bind(this));\n    this._registerHandler(commands.ShowPanel, this._onShowPanel.bind(this));\n    this._registerHandler(commands.Subscribe, this._onSubscribe.bind(this));\n    this._registerHandler(commands.OpenResource, this._onOpenResource.bind(this));\n    this._registerHandler(commands.Unsubscribe, this._onUnsubscribe.bind(this));\n    this._registerHandler(commands.UpdateButton, this._onUpdateButton.bind(this));\n    this._registerHandler(commands.RegisterLanguageExtensionPlugin, this._registerLanguageExtensionEndpoint.bind(this));\n    window.addEventListener('message', this._onWindowMessage.bind(this), false);  // Only for main window.\n\n    const existingTabId =\n        window.DevToolsAPI && window.DevToolsAPI.getInspectedTabId && window.DevToolsAPI.getInspectedTabId();\n\n    if (existingTabId) {\n      this._setInspectedTabId({data: existingTabId});\n    }\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.events.addEventListener(\n        Host.InspectorFrontendHostAPI.Events.SetInspectedTabId, this._setInspectedTabId, this);\n\n    this._languageExtensionRequests = new Map();\n    this._initExtensions();\n  }\n\n  /**\n   * @param {{forceNew: ?boolean}} opts\n   */\n  static instance(opts = {forceNew: null}) {\n    const {forceNew} = opts;\n    if (!extensionServerInstance || forceNew) {\n      extensionServerInstance = new ExtensionServer();\n    }\n\n    return extensionServerInstance;\n  }\n\n  initializeExtensions() {\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.setAddExtensionCallback(this._addExtension.bind(this));\n  }\n\n  /**\n   * @return {boolean}\n   */\n  hasExtensions() {\n    return Boolean(this._registeredExtensions.size);\n  }\n\n  /**\n   * @param {string} panelId\n   * @param {string} action\n   * @param {string=} searchString\n   */\n  notifySearchAction(panelId, action, searchString) {\n    this._postNotification(Extensions.extensionAPI.Events.PanelSearch + panelId, action, searchString);\n  }\n\n  /**\n   * @param {string} identifier\n   * @param {number=} frameIndex\n   */\n  notifyViewShown(identifier, frameIndex) {\n    this._postNotification(Extensions.extensionAPI.Events.ViewShown + identifier, frameIndex);\n  }\n\n  /**\n   * @param {string} identifier\n   */\n  notifyViewHidden(identifier) {\n    this._postNotification(Extensions.extensionAPI.Events.ViewHidden + identifier);\n  }\n\n  /**\n   * @param {string} identifier\n   */\n  notifyButtonClicked(identifier) {\n    this._postNotification(Extensions.extensionAPI.Events.ButtonClicked + identifier);\n  }\n\n  _registerLanguageExtensionEndpoint(message, shared_port) {\n    const {pluginManager} = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance();\n    if (!pluginManager) {\n      return this._status.E_FAILED('WebAssembly DWARF support needs to be enabled to use this extension');\n    }\n\n    const {pluginName, port, supportedScriptTypes: {language, symbol_types}} = message;\n    const symbol_types_array = /** @type !Array<string> */\n        (Array.isArray(symbol_types) && symbol_types.every(e => typeof e === 'string') ? symbol_types : []);\n    const endpoint = new LanguageExtensionEndpoint(pluginName, {language, symbol_types: symbol_types_array}, port);\n    pluginManager.addPlugin(endpoint);\n    return this._status.OK();\n  }\n\n  _inspectedURLChanged(event) {\n    if (!this._canInspectURL(event.data.inspectedURL())) {\n      this._disableExtensions();\n      return;\n    }\n    if (event.data !== SDK.SDKModel.TargetManager.instance().mainTarget()) {\n      return;\n    }\n    this._requests = {};\n    const url = event.data.inspectedURL();\n    this._postNotification(Extensions.extensionAPI.Events.InspectedURLChanged, url);\n  }\n\n  /**\n   * @param {string} providerId\n   * @param {string} sessionId\n   * @param {!TracingSession} session\n   */\n  startTraceRecording(providerId, sessionId, session) {\n    this._traceSessions.set(sessionId, session);\n    this._postNotification('trace-recording-started-' + providerId, sessionId);\n  }\n\n  /**\n   * @param {string} providerId\n   */\n  stopTraceRecording(providerId) {\n    this._postNotification('trace-recording-stopped-' + providerId);\n  }\n\n  /**\n   * @param {string} type\n   * @return {boolean}\n   */\n  hasSubscribers(type) {\n    return this._subscribers.has(type);\n  }\n\n  /**\n   * @param {string} type\n   * @param {...*} vararg\n   */\n  _postNotification(type, vararg) {\n    if (!this._extensionsEnabled) {\n      return;\n    }\n    const subscribers = this._subscribers.get(type);\n    if (!subscribers) {\n      return;\n    }\n    const message = {command: 'notify-' + type, arguments: Array.prototype.slice.call(arguments, 1)};\n    for (const subscriber of subscribers) {\n      subscriber.postMessage(message);\n    }\n  }\n\n  _onSubscribe(message, port) {\n    const subscribers = this._subscribers.get(message.type);\n    if (subscribers) {\n      subscribers.add(port);\n    } else {\n      this._subscribers.set(message.type, new Set([port]));\n      if (this._subscriptionStartHandlers[message.type]) {\n        this._subscriptionStartHandlers[message.type]();\n      }\n    }\n  }\n\n  _onUnsubscribe(message, port) {\n    const subscribers = this._subscribers.get(message.type);\n    if (!subscribers) {\n      return;\n    }\n    subscribers.delete(port);\n    if (!subscribers.size) {\n      this._subscribers.delete(message.type);\n      if (this._subscriptionStopHandlers[message.type]) {\n        this._subscriptionStopHandlers[message.type]();\n      }\n    }\n  }\n\n  _onAddRequestHeaders(message) {\n    const id = message.extensionId;\n    if (typeof id !== 'string') {\n      return this._status.E_BADARGTYPE('extensionId', typeof id, 'string');\n    }\n    let extensionHeaders = this._extraHeaders.get(id);\n    if (!extensionHeaders) {\n      extensionHeaders = new Map();\n      this._extraHeaders.set(id, extensionHeaders);\n    }\n    for (const name in message.headers) {\n      extensionHeaders.set(name, message.headers[name]);\n    }\n    const allHeaders = /** @type {!Protocol.Network.Headers} */ ({});\n    for (const headers of this._extraHeaders.values()) {\n      for (const name of headers.keys()) {\n        if (name !== '__proto__' && typeof headers.get(name) === 'string') {\n          allHeaders[name] = headers.get(name);\n        }\n      }\n    }\n\n    SDK.NetworkManager.MultitargetNetworkManager.instance().setExtraHTTPHeaders(allHeaders);\n  }\n\n  /**\n   * @param {*} message\n   */\n  _onApplyStyleSheet(message) {\n    if (!Root.Runtime.experiments.isEnabled('applyCustomStylesheet')) {\n      return;\n    }\n    const styleSheet = createElement('style');\n    styleSheet.textContent = message.styleSheet;\n    document.head.appendChild(styleSheet);\n\n    ThemeSupport.ThemeSupport.instance().addCustomStylesheet(message.styleSheet);\n    // Add to all the shadow roots that have already been created\n    for (let node = document.body; node; node = node.traverseNextNode(document.body)) {\n      if (node instanceof ShadowRoot) {\n        ThemeSupport.ThemeSupport.instance().injectCustomStyleSheets(node);\n      }\n    }\n  }\n\n  _onCreatePanel(message, port) {\n    const id = message.id;\n    // The ids are generated on the client API side and must be unique, so the check below\n    // shouldn't be hit unless someone is bypassing the API.\n    if (id in this._clientObjects || UI.InspectorView.InspectorView.instance().hasPanel(id)) {\n      return this._status.E_EXISTS(id);\n    }\n\n    const page = this._expandResourcePath(port[extensionOriginSymbol], message.page);\n    let persistentId = port[extensionOriginSymbol] + message.title;\n    persistentId = persistentId.replace(/\\s/g, '');\n    const panelView =\n        new ExtensionServerPanelView(persistentId, message.title, new ExtensionPanel(this, persistentId, id, page));\n    this._clientObjects[id] = panelView;\n    UI.InspectorView.InspectorView.instance().addPanel(panelView);\n    return this._status.OK();\n  }\n\n  _onShowPanel(message) {\n    let panelViewId = message.id;\n    const panelView = this._clientObjects[message.id];\n    if (panelView && panelView instanceof ExtensionServerPanelView) {\n      panelViewId = panelView.viewId();\n    }\n    UI.InspectorView.InspectorView.instance().showPanel(panelViewId);\n  }\n\n  _onCreateToolbarButton(message, port) {\n    const panelView = this._clientObjects[message.panel];\n    if (!panelView || !(panelView instanceof ExtensionServerPanelView)) {\n      return this._status.E_NOTFOUND(message.panel);\n    }\n    const button = new ExtensionButton(\n        this, message.id, this._expandResourcePath(port[extensionOriginSymbol], message.icon), message.tooltip,\n        message.disabled);\n    this._clientObjects[message.id] = button;\n\n    panelView.widget().then(appendButton);\n\n    /**\n     * @param {!UI.Widget.Widget} panel\n     */\n    function appendButton(panel) {\n      /** @type {!ExtensionPanel} panel*/ (panel).addToolbarItem(button.toolbarButton());\n    }\n\n    return this._status.OK();\n  }\n\n  _onUpdateButton(message, port) {\n    const button = this._clientObjects[message.id];\n    if (!button || !(button instanceof ExtensionButton)) {\n      return this._status.E_NOTFOUND(message.id);\n    }\n    button.update(\n        this._expandResourcePath(port[extensionOriginSymbol], message.icon), message.tooltip, message.disabled);\n    return this._status.OK();\n  }\n\n  /**\n   * @param {!Object} message\n   */\n  _onCompleteTraceSession(message) {\n    const session = this._traceSessions.get(message.id);\n    if (!session) {\n      return this._status.E_NOTFOUND(message.id);\n    }\n    this._traceSessions.delete(message.id);\n    session.complete(message.url, message.timeOffset);\n  }\n\n  _onCreateSidebarPane(message) {\n    if (message.panel !== 'elements' && message.panel !== 'sources') {\n      return this._status.E_NOTFOUND(message.panel);\n    }\n    const id = message.id;\n    const sidebar = new ExtensionSidebarPane(this, message.panel, message.title, id);\n    this._sidebarPanes.push(sidebar);\n    this._clientObjects[id] = sidebar;\n    this.dispatchEventToListeners(Events.SidebarPaneAdded, sidebar);\n\n    return this._status.OK();\n  }\n\n  /**\n   * @return {!Array.<!ExtensionSidebarPane>}\n   */\n  sidebarPanes() {\n    return this._sidebarPanes;\n  }\n\n  _onSetSidebarHeight(message) {\n    const sidebar = this._clientObjects[message.id];\n    if (!sidebar) {\n      return this._status.E_NOTFOUND(message.id);\n    }\n    sidebar.setHeight(message.height);\n    return this._status.OK();\n  }\n\n  _onSetSidebarContent(message, port) {\n    const sidebar = this._clientObjects[message.id];\n    if (!sidebar) {\n      return this._status.E_NOTFOUND(message.id);\n    }\n\n    /**\n     * @this {ExtensionServer}\n     */\n    function callback(error) {\n      const result = error ? this._status.E_FAILED(error) : this._status.OK();\n      this._dispatchCallback(message.requestId, port, result);\n    }\n    if (message.evaluateOnPage) {\n      return sidebar.setExpression(\n          message.expression, message.rootTitle, message.evaluateOptions, port[extensionOriginSymbol],\n          callback.bind(this));\n    }\n    sidebar.setObject(message.expression, message.rootTitle, callback.bind(this));\n  }\n\n  _onSetSidebarPage(message, port) {\n    const sidebar = this._clientObjects[message.id];\n    if (!sidebar) {\n      return this._status.E_NOTFOUND(message.id);\n    }\n    sidebar.setPage(this._expandResourcePath(port[extensionOriginSymbol], message.page));\n  }\n\n  _onOpenResource(message) {\n    const uiSourceCode = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(message.url);\n    if (uiSourceCode) {\n      Common.Revealer.reveal(uiSourceCode.uiLocation(message.lineNumber, 0));\n      return this._status.OK();\n    }\n\n    const resource = Bindings.ResourceUtils.resourceForURL(message.url);\n    if (resource) {\n      Common.Revealer.reveal(resource);\n      return this._status.OK();\n    }\n\n    const request = SDK.NetworkLog.NetworkLog.instance().requestForURL(message.url);\n    if (request) {\n      Common.Revealer.reveal(request);\n      return this._status.OK();\n    }\n\n    return this._status.E_NOTFOUND(message.url);\n  }\n\n  _onSetOpenResourceHandler(message, port) {\n    const name = this._registeredExtensions.get(port[extensionOriginSymbol]).name;\n    if (message.handlerPresent) {\n      Components.Linkifier.Linkifier.registerLinkHandler(name, this._handleOpenURL.bind(this, port));\n    } else {\n      Components.Linkifier.Linkifier.unregisterLinkHandler(name);\n    }\n  }\n\n  _handleOpenURL(port, contentProvider, lineNumber) {\n    port.postMessage(\n        {command: 'open-resource', resource: this._makeResource(contentProvider), lineNumber: lineNumber + 1});\n  }\n\n  _onReload(message) {\n    const options = /** @type {!ExtensionReloadOptions} */ (message.options || {});\n\n    SDK.NetworkManager.MultitargetNetworkManager.instance().setUserAgentOverride(\n        typeof options.userAgent === 'string' ? options.userAgent : '', null);\n    let injectedScript;\n    if (options.injectedScript) {\n      injectedScript = '(function(){' + options.injectedScript + '})()';\n    }\n    SDK.ResourceTreeModel.ResourceTreeModel.reloadAllPages(Boolean(options.ignoreCache), injectedScript);\n    return this._status.OK();\n  }\n\n  _onEvaluateOnInspectedPage(message, port) {\n    /**\n     * @param {?ProtocolClient.InspectorBackend.ProtocolError} error\n     * @param {?SDK.RemoteObject.RemoteObject} object\n     * @param {boolean} wasThrown\n     * @this {ExtensionServer}\n     */\n    function callback(error, object, wasThrown) {\n      let result;\n      if (error || !object) {\n        result = this._status.E_PROTOCOLERROR(error.toString());\n      } else if (wasThrown) {\n        result = {isException: true, value: object.description};\n      } else {\n        result = {value: object.value};\n      }\n\n      this._dispatchCallback(message.requestId, port, result);\n    }\n    return this.evaluate(\n        message.expression, true, true, message.evaluateOptions, port[extensionOriginSymbol], callback.bind(this));\n  }\n\n  async _onGetHAR() {\n    const requests = SDK.NetworkLog.NetworkLog.instance().requests();\n    const harLog = await SDK.HARLog.HARLog.build(requests);\n    for (let i = 0; i < harLog.entries.length; ++i) {\n      harLog.entries[i]._requestId = this._requestId(requests[i]);\n    }\n    return harLog;\n  }\n\n  /**\n   * @param {!TextUtils.ContentProvider.ContentProvider} contentProvider\n   */\n  _makeResource(contentProvider) {\n    return {url: contentProvider.contentURL(), type: contentProvider.contentType().name()};\n  }\n\n  /**\n   * @return {!Array<!TextUtils.ContentProvider.ContentProvider>}\n   */\n  _onGetPageResources() {\n    /** @type {!Map<string, !TextUtils.ContentProvider.ContentProvider>} */\n    const resources = new Map();\n\n    /**\n     * @this {ExtensionServer}\n     */\n    function pushResourceData(contentProvider) {\n      if (!resources.has(contentProvider.contentURL())) {\n        resources.set(contentProvider.contentURL(), this._makeResource(contentProvider));\n      }\n    }\n    let uiSourceCodes = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodesForProjectType(\n        Workspace.Workspace.projectTypes.Network);\n    uiSourceCodes = uiSourceCodes.concat(Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodesForProjectType(\n        Workspace.Workspace.projectTypes.ContentScripts));\n    uiSourceCodes.forEach(pushResourceData.bind(this));\n    for (const resourceTreeModel of SDK.SDKModel.TargetManager.instance().models(\n             SDK.ResourceTreeModel.ResourceTreeModel)) {\n      resourceTreeModel.forAllResources(pushResourceData.bind(this));\n    }\n    return [...resources.values()];\n  }\n\n  /**\n   * @param {!TextUtils.ContentProvider.ContentProvider} contentProvider\n   * @param {!Object} message\n   * @param {!MessagePort} port\n   */\n  async _getResourceContent(contentProvider, message, port) {\n    const {content} = await contentProvider.requestContent();\n    const encoded = await contentProvider.contentEncoded();\n    this._dispatchCallback(message.requestId, port, {encoding: encoded ? 'base64' : '', content: content});\n  }\n\n  _onGetRequestContent(message, port) {\n    const request = this._requestById(message.id);\n    if (!request) {\n      return this._status.E_NOTFOUND(message.id);\n    }\n    this._getResourceContent(request, message, port);\n  }\n\n  _onGetResourceContent(message, port) {\n    const url = /** @type {string} */ (message.url);\n    const contentProvider = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(url) ||\n        Bindings.ResourceUtils.resourceForURL(url);\n    if (!contentProvider) {\n      return this._status.E_NOTFOUND(url);\n    }\n    this._getResourceContent(contentProvider, message, port);\n  }\n\n  _onSetResourceContent(message, port) {\n    /**\n     * @param {?ProtocolClient.InspectorBackend.ProtocolError} error\n     * @this {ExtensionServer}\n     */\n    function callbackWrapper(error) {\n      const response = error ? this._status.E_FAILED(error) : this._status.OK();\n      this._dispatchCallback(message.requestId, port, response);\n    }\n\n    const url = /** @type {string} */ (message.url);\n    const uiSourceCode = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(url);\n    if (!uiSourceCode || !uiSourceCode.contentType().isDocumentOrScriptOrStyleSheet()) {\n      const resource = SDK.ResourceTreeModel.ResourceTreeModel.resourceForURL(url);\n      if (!resource) {\n        return this._status.E_NOTFOUND(url);\n      }\n      return this._status.E_NOTSUPPORTED('Resource is not editable');\n    }\n    uiSourceCode.setWorkingCopy(message.content);\n    if (message.commit) {\n      uiSourceCode.commitWorkingCopy();\n    }\n    callbackWrapper.call(this, null);\n  }\n\n  _requestId(request) {\n    if (!request._extensionRequestId) {\n      request._extensionRequestId = ++this._lastRequestId;\n      this._requests[request._extensionRequestId] = request;\n    }\n    return request._extensionRequestId;\n  }\n\n  _requestById(id) {\n    return this._requests[id];\n  }\n\n  /**\n   * @param {!Object} message\n   * @param {!MessagePort} port\n   */\n  _onAddTraceProvider(message, port) {\n    const provider = new ExtensionTraceProvider(\n        port[extensionOriginSymbol], message.id, message.categoryName, message.categoryTooltip);\n    this._clientObjects[message.id] = provider;\n    this._traceProviders.push(provider);\n    this.dispatchEventToListeners(Events.TraceProviderAdded, provider);\n  }\n\n  /**\n   * @return {!Array<!ExtensionTraceProvider>}\n   */\n  traceProviders() {\n    return this._traceProviders;\n  }\n\n  _onForwardKeyboardEvent(message) {\n    message.entries.forEach(handleEventEntry);\n\n    /**\n     * @param {*} entry\n     */\n    function handleEventEntry(entry) {\n      // Fool around closure compiler -- it has its own notion of both KeyboardEvent constructor\n      // and initKeyboardEvent methods and overriding these in externs.js does not have effect.\n      const event = new window.KeyboardEvent(entry.eventType, {\n        key: entry.key,\n        code: entry.code,\n        keyCode: entry.keyCode,\n        location: entry.location,\n        ctrlKey: entry.ctrlKey,\n        altKey: entry.altKey,\n        shiftKey: entry.shiftKey,\n        metaKey: entry.metaKey\n      });\n      event.__keyCode = keyCodeForEntry(entry);\n      document.dispatchEvent(event);\n    }\n\n    function keyCodeForEntry(entry) {\n      let keyCode = entry.keyCode;\n      if (!keyCode) {\n        // This is required only for synthetic events (e.g. dispatched in tests).\n        if (entry.key === 'Escape') {\n          keyCode = 27;\n        }\n      }\n      return keyCode || 0;\n    }\n  }\n\n  _dispatchCallback(requestId, port, result) {\n    if (requestId) {\n      port.postMessage({command: 'callback', requestId: requestId, result: result});\n    }\n  }\n\n  _initExtensions() {\n    this._registerAutosubscriptionHandler(\n        Extensions.extensionAPI.Events.ResourceAdded, Workspace.Workspace.WorkspaceImpl.instance(),\n        Workspace.Workspace.Events.UISourceCodeAdded, this._notifyResourceAdded);\n    this._registerAutosubscriptionTargetManagerHandler(\n        Extensions.extensionAPI.Events.NetworkRequestFinished, SDK.NetworkManager.NetworkManager,\n        SDK.NetworkManager.Events.RequestFinished, this._notifyRequestFinished);\n\n    /**\n     * @this {ExtensionServer}\n     */\n    function onElementsSubscriptionStarted() {\n      UI.Context.Context.instance().addFlavorChangeListener(\n          SDK.DOMModel.DOMNode, this._notifyElementsSelectionChanged, this);\n    }\n\n    /**\n     * @this {ExtensionServer}\n     */\n    function onElementsSubscriptionStopped() {\n      UI.Context.Context.instance().removeFlavorChangeListener(\n          SDK.DOMModel.DOMNode, this._notifyElementsSelectionChanged, this);\n    }\n\n    this._registerSubscriptionHandler(\n        Extensions.extensionAPI.Events.PanelObjectSelected + 'elements', onElementsSubscriptionStarted.bind(this),\n        onElementsSubscriptionStopped.bind(this));\n    this._registerResourceContentCommittedHandler(this._notifyUISourceCodeContentCommitted);\n\n    SDK.SDKModel.TargetManager.instance().addEventListener(\n        SDK.SDKModel.Events.InspectedURLChanged, this._inspectedURLChanged, this);\n  }\n\n  _notifyResourceAdded(event) {\n    const uiSourceCode = /** @type {!Workspace.UISourceCode.UISourceCode} */ (event.data);\n    this._postNotification(Extensions.extensionAPI.Events.ResourceAdded, this._makeResource(uiSourceCode));\n  }\n\n  _notifyUISourceCodeContentCommitted(event) {\n    const uiSourceCode = /** @type {!Workspace.UISourceCode.UISourceCode} */ (event.data.uiSourceCode);\n    const content = /** @type {string} */ (event.data.content);\n    this._postNotification(\n        Extensions.extensionAPI.Events.ResourceContentCommitted, this._makeResource(uiSourceCode), content);\n  }\n\n  async _notifyRequestFinished(event) {\n    const request = /** @type {!SDK.NetworkRequest.NetworkRequest} */ (event.data);\n    const entry = await SDK.HARLog.Entry.build(request);\n    this._postNotification(Extensions.extensionAPI.Events.NetworkRequestFinished, this._requestId(request), entry);\n  }\n\n  _notifyElementsSelectionChanged() {\n    this._postNotification(Extensions.extensionAPI.Events.PanelObjectSelected + 'elements');\n  }\n\n  /**\n   * @param {string} url\n   * @param {!TextUtils.TextRange.TextRange} range\n   */\n  sourceSelectionChanged(url, range) {\n    this._postNotification(Extensions.extensionAPI.Events.PanelObjectSelected + 'sources', {\n      startLine: range.startLine,\n      startColumn: range.startColumn,\n      endLine: range.endLine,\n      endColumn: range.endColumn,\n      url: url,\n    });\n  }\n\n  /**\n   * @param {!Common.EventTarget.EventTargetEvent} event\n   */\n  _setInspectedTabId(event) {\n    this._inspectedTabId = /** @type {string} */ (event.data);\n  }\n\n  /**\n   * @param {!Root.Runtime.RuntimeExtensionDescriptor} extensionInfo\n   */\n  _addExtension(extensionInfo) {\n    const startPage = extensionInfo.startPage;\n\n    const inspectedURL = SDK.SDKModel.TargetManager.instance().mainTarget().inspectedURL();\n    if (inspectedURL !== '' && !this._canInspectURL(inspectedURL)) {\n      this._disableExtensions();\n    }\n    if (!this._extensionsEnabled) {\n      return;\n    }\n    try {\n      const startPageURL = new URL(/** @type {string} */ (startPage));\n      const extensionOrigin = startPageURL.origin;\n      if (!this._registeredExtensions.get(extensionOrigin)) {\n        // See ExtensionAPI.js for details.\n        const injectedAPI = self.buildExtensionAPIInjectedScript(\n            /** @type {!{startPage: string, name: string, exposeExperimentalAPIs: boolean}} */ (extensionInfo),\n            this._inspectedTabId, ThemeSupport.ThemeSupport.instance().themeName(),\n            UI.ShortcutRegistry.ShortcutRegistry.instance().globalShortcutKeys(),\n            ExtensionServer.instance()['_extensionAPITestHook']);\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance.setInjectedScriptForOrigin(\n            extensionOrigin, injectedAPI);\n        const name = extensionInfo.name || `Extension ${extensionOrigin}`;\n        this._registeredExtensions.set(extensionOrigin, {name});\n      }\n      const iframe = createElement('iframe');\n      iframe.src = startPage;\n      iframe.dataset.devtoolsExtension = extensionInfo.name;\n      iframe.style.display = 'none';\n      document.body.appendChild(iframe);  // Only for main window.\n    } catch (e) {\n      console.error('Failed to initialize extension ' + startPage + ':' + e);\n      return false;\n    }\n    return true;\n  }\n\n  _registerExtension(origin, port) {\n    if (!this._registeredExtensions.has(origin)) {\n      if (origin !== window.location.origin) {  // Just ignore inspector frames.\n        console.error('Ignoring unauthorized client request from ' + origin);\n      }\n      return;\n    }\n    port[extensionOriginSymbol] = origin;\n    port.addEventListener('message', this._onmessage.bind(this), false);\n    port.start();\n  }\n\n  _onWindowMessage(event) {\n    if (event.data === 'registerExtension') {\n      this._registerExtension(event.origin, event.ports[0]);\n    }\n  }\n\n  async _onmessage(event) {\n    const message = event.data;\n    let result;\n\n    if (!(message.command in this._handlers)) {\n      result = this._status.E_NOTSUPPORTED(message.command);\n    } else if (!this._extensionsEnabled) {\n      result = this._status.E_FAILED('Permission denied');\n    } else {\n      result = await this._handlers[message.command](message, event.target);\n    }\n\n    if (result && message.requestId) {\n      this._dispatchCallback(message.requestId, event.target, result);\n    }\n  }\n\n  _registerHandler(command, callback) {\n    console.assert(command);\n    this._handlers[command] = callback;\n  }\n\n  _registerSubscriptionHandler(eventTopic, onSubscribeFirst, onUnsubscribeLast) {\n    this._subscriptionStartHandlers[eventTopic] = onSubscribeFirst;\n    this._subscriptionStopHandlers[eventTopic] = onUnsubscribeLast;\n  }\n\n  /**\n   * @param {string} eventTopic\n   * @param {!Object} eventTarget\n   * @param {symbol} frontendEventType\n   * @param {function(!Common.EventTarget.EventTargetEvent)} handler\n   */\n  _registerAutosubscriptionHandler(eventTopic, eventTarget, frontendEventType, handler) {\n    this._registerSubscriptionHandler(\n        eventTopic, eventTarget.addEventListener.bind(eventTarget, frontendEventType, handler, this),\n        eventTarget.removeEventListener.bind(eventTarget, frontendEventType, handler, this));\n  }\n\n  /**\n   * @param {string} eventTopic\n   * @param {!Function} modelClass\n   * @param {symbol} frontendEventType\n   * @param {function(!Common.EventTarget.EventTargetEvent)} handler\n   */\n  _registerAutosubscriptionTargetManagerHandler(eventTopic, modelClass, frontendEventType, handler) {\n    this._registerSubscriptionHandler(\n        eventTopic,\n        SDK.SDKModel.TargetManager.instance().addModelListener.bind(\n            SDK.SDKModel.TargetManager.instance(), modelClass, frontendEventType, handler, this),\n        SDK.SDKModel.TargetManager.instance().removeModelListener.bind(\n            SDK.SDKModel.TargetManager.instance(), modelClass, frontendEventType, handler, this));\n  }\n\n  _registerResourceContentCommittedHandler(handler) {\n    /**\n     * @this {ExtensionServer}\n     */\n    function addFirstEventListener() {\n      Workspace.Workspace.WorkspaceImpl.instance().addEventListener(\n          Workspace.Workspace.Events.WorkingCopyCommittedByUser, handler, this);\n      Workspace.Workspace.WorkspaceImpl.instance().setHasResourceContentTrackingExtensions(true);\n    }\n\n    /**\n     * @this {ExtensionServer}\n     */\n    function removeLastEventListener() {\n      Workspace.Workspace.WorkspaceImpl.instance().setHasResourceContentTrackingExtensions(false);\n      Workspace.Workspace.WorkspaceImpl.instance().removeEventListener(\n          Workspace.Workspace.Events.WorkingCopyCommittedByUser, handler, this);\n    }\n\n    this._registerSubscriptionHandler(\n        Extensions.extensionAPI.Events.ResourceContentCommitted, addFirstEventListener.bind(this),\n        removeLastEventListener.bind(this));\n  }\n\n  _expandResourcePath(extensionPath, resourcePath) {\n    if (!resourcePath) {\n      return;\n    }\n    return extensionPath + this._normalizePath(resourcePath);\n  }\n\n  _normalizePath(path) {\n    const source = path.split('/');\n    const result = [];\n\n    for (let i = 0; i < source.length; ++i) {\n      if (source[i] === '.') {\n        continue;\n      }\n      // Ignore empty path components resulting from //, as well as a leading and traling slashes.\n      if (source[i] === '') {\n        continue;\n      }\n      if (source[i] === '..') {\n        result.pop();\n      } else {\n        result.push(source[i]);\n      }\n    }\n    return '/' + result.join('/');\n  }\n\n  /**\n   * @param {string} expression\n   * @param {boolean} exposeCommandLineAPI\n   * @param {boolean} returnByValue\n   * @param {?Object} options\n   * @param {string} securityOrigin\n   * @param {function(?string, ?SDK.RemoteObject.RemoteObject, boolean)} callback\n   * @return {!Record|undefined}\n   */\n  evaluate(expression, exposeCommandLineAPI, returnByValue, options, securityOrigin, callback) {\n    let context;\n\n    /**\n     * @param {string} url\n     * @return {boolean}\n     */\n    function resolveURLToFrame(url) {\n      let found;\n      function hasMatchingURL(frame) {\n        found = (frame.url === url) ? frame : null;\n        return found;\n      }\n      SDK.ResourceTreeModel.ResourceTreeModel.frames().some(hasMatchingURL);\n      return found;\n    }\n\n    options = options || {};\n    let frame;\n    if (options.frameURL) {\n      frame = resolveURLToFrame(options.frameURL);\n    } else {\n      const target = SDK.SDKModel.TargetManager.instance().mainTarget();\n      const resourceTreeModel = target && target.model(SDK.ResourceTreeModel.ResourceTreeModel);\n      frame = resourceTreeModel && resourceTreeModel.mainFrame;\n    }\n    if (!frame) {\n      if (options.frameURL) {\n        console.warn('evaluate: there is no frame with URL ' + options.frameURL);\n      } else {\n        console.warn('evaluate: the main frame is not yet available');\n      }\n      return this._status.E_NOTFOUND(options.frameURL || '<top>');\n    }\n    // We shouldn't get here if the top frame can't be inspected by an extension, but\n    // let's double check for subframes.\n    if (!this._canInspectURL(frame.url)) {\n      return this._status.E_FAILED('Permission denied');\n    }\n\n    let contextSecurityOrigin;\n    if (options.useContentScriptContext) {\n      contextSecurityOrigin = securityOrigin;\n    } else if (options.scriptExecutionContext) {\n      contextSecurityOrigin = options.scriptExecutionContext;\n    }\n\n    const runtimeModel = frame.resourceTreeModel().target().model(SDK.RuntimeModel.RuntimeModel);\n    const executionContexts = runtimeModel ? runtimeModel.executionContexts() : [];\n    if (contextSecurityOrigin) {\n      for (let i = 0; i < executionContexts.length; ++i) {\n        const executionContext = executionContexts[i];\n        if (executionContext.frameId === frame.id && executionContext.origin === contextSecurityOrigin &&\n            !executionContext.isDefault) {\n          context = executionContext;\n        }\n      }\n      if (!context) {\n        console.warn('The JavaScript context ' + contextSecurityOrigin + ' was not found in the frame ' + frame.url);\n        return this._status.E_NOTFOUND(contextSecurityOrigin);\n      }\n    } else {\n      for (let i = 0; i < executionContexts.length; ++i) {\n        const executionContext = executionContexts[i];\n        if (executionContext.frameId === frame.id && executionContext.isDefault) {\n          context = executionContext;\n        }\n      }\n      if (!context) {\n        return this._status.E_FAILED(frame.url + ' has no execution context');\n      }\n    }\n    if (!this._canInspectURL(context.origin)) {\n      return this._status.E_FAILED('Permission denied');\n    }\n\n    context\n        .evaluate(\n            {\n              expression: expression,\n              objectGroup: 'extension',\n              includeCommandLineAPI: exposeCommandLineAPI,\n              silent: true,\n              returnByValue: returnByValue,\n              generatePreview: false\n            },\n            /* userGesture */ false, /* awaitPromise */ false)\n        .then(onEvaluate);\n\n    /**\n     * @param {!SDK.RuntimeModel.EvaluationResult} result\n     */\n    function onEvaluate(result) {\n      if (result.error) {\n        callback(result.error, null, false);\n        return;\n      }\n      callback(null, result.object || null, Boolean(result.exceptionDetails));\n    }\n  }\n\n  /**\n   *\n   * @param {string} url\n   */\n  _canInspectURL(url) {\n    let parsedURL;\n    // This is only to work around invalid URLs we're occasionally getting from some tests.\n    // TODO(caseq): make sure tests supply valid URLs or we specifically handle invalid ones.\n    try {\n      parsedURL = new URL(url);\n    } catch (exception) {\n      return false;\n    }\n    if (kAllowedOrigins.includes(parsedURL.origin)) {\n      return true;\n    }\n    if (parsedURL.protocol === 'chrome:' || parsedURL.protocol === 'devtools:') {\n      return false;\n    }\n    if (parsedURL.protocol.startsWith('http') && parsedURL.hostname === 'chrome.google.com' &&\n        parsedURL.pathname.startsWith('/webstore')) {\n      return false;\n    }\n    return true;\n  }\n\n  _disableExtensions() {\n    this._extensionsEnabled = false;\n  }\n}\n\n/** @enum {symbol} */\nexport const Events = {\n  SidebarPaneAdded: Symbol('SidebarPaneAdded'),\n  TraceProviderAdded: Symbol('TraceProviderAdded')\n};\n\nclass ExtensionServerPanelView extends UI.View.SimpleView {\n  /**\n   * @param {string} name\n   * @param {string} title\n   * @param {!UI.Panel.Panel} panel\n   */\n  constructor(name, title, panel) {\n    super(title);\n    this._name = name;\n    this._panel = panel;\n  }\n\n  /**\n   * @override\n   * @return {string}\n   */\n  viewId() {\n    return this._name;\n  }\n\n  /**\n   * @override\n   * @return {!Promise.<!UI.Widget.Widget>}\n   */\n  widget() {\n    return /** @type {!Promise.<!UI.Widget.Widget>} */ (Promise.resolve(this._panel));\n  }\n}\n\nexport class ExtensionStatus {\n  constructor() {\n    /**\n     * @param {string} code\n     * @param {string} description\n     * @return {!Record}\n     */\n    function makeStatus(code, description) {\n      const details = Array.prototype.slice.call(arguments, 2);\n      const status = {code: code, description: description, details: details};\n      if (code !== 'OK') {\n        status.isError = true;\n        console.error('Extension server error: ' + Platform.StringUtilities.vsprintf(description, details));\n      }\n      return status;\n    }\n\n    this.OK = makeStatus.bind(null, 'OK', 'OK');\n    this.E_EXISTS = makeStatus.bind(null, 'E_EXISTS', 'Object already exists: %s');\n    this.E_BADARG = makeStatus.bind(null, 'E_BADARG', 'Invalid argument %s: %s');\n    this.E_BADARGTYPE = makeStatus.bind(null, 'E_BADARGTYPE', 'Invalid type for argument %s: got %s, expected %s');\n    this.E_NOTFOUND = makeStatus.bind(null, 'E_NOTFOUND', 'Object not found: %s');\n    this.E_NOTSUPPORTED = makeStatus.bind(null, 'E_NOTSUPPORTED', 'Object does not support requested operation: %s');\n    this.E_PROTOCOLERROR = makeStatus.bind(null, 'E_PROTOCOLERROR', 'Inspector protocol error: %s');\n    this.E_FAILED = makeStatus.bind(null, 'E_FAILED', 'Operation failed: %s');\n  }\n}\n\n/**\n * @typedef {{code: string, description: string, details: !Array.<*>}}\n */\nexport let Record;\n"]}