{"version":3,"file":"CrossOriginEmbedderPolicyIssue.js","sourceRoot":"","sources":["../../../../../front_end/sdk/CrossOriginEmbedderPolicyIssue.js"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {ls} from '../common/common.js';  // eslint-disable-line rulesdir/es_modules_import\n\nimport {Issue, IssueCategory, IssueKind, MarkdownIssueDescription} from './Issue.js';  // eslint-disable-line no-unused-vars\nimport {IssuesModel} from './IssuesModel.js';  // eslint-disable-line no-unused-vars\n\n/**\n * @param {!Protocol.Audits.BlockedByResponseReason} reason\n * @return {boolean}\n */\nexport function isCrossOriginEmbedderPolicyIssue(reason) {\n  switch (reason) {\n    case Protocol.Audits.BlockedByResponseReason.CoepFrameResourceNeedsCoepHeader:\n      return true;\n    case Protocol.Audits.BlockedByResponseReason.CoopSandboxedIFrameCannotNavigateToCoopPage:\n      return true;\n    case Protocol.Audits.BlockedByResponseReason.CorpNotSameOrigin:\n      return true;\n    case Protocol.Audits.BlockedByResponseReason.CorpNotSameOriginAfterDefaultedToSameOriginByCoep:\n      return true;\n    case Protocol.Audits.BlockedByResponseReason.CorpNotSameSite:\n      return true;\n  }\n  return false;\n}\n\nexport class CrossOriginEmbedderPolicyIssue extends Issue {\n  /**\n   * @param {!Protocol.Audits.BlockedByResponseIssueDetails} issueDetails\n   * @param {!IssuesModel} issuesModel\n   */\n  constructor(issueDetails, issuesModel) {\n    super(`CrossOriginEmbedderPolicyIssue::${issueDetails.reason}`, issuesModel);\n    /** @type {!Protocol.Audits.BlockedByResponseIssueDetails} */\n    this._details = issueDetails;\n  }\n\n  /**\n   * @override\n   */\n  primaryKey() {\n    return `${this.code()}-(${this._details.request.requestId})`;\n  }\n\n  /**\n   * @override\n   * @returns {!Iterable<Protocol.Audits.BlockedByResponseIssueDetails>}\n   */\n  blockedByResponseDetails() {\n    return [this._details];\n  }\n\n  /**\n   * @override\n   * @returns {!Iterable<Protocol.Audits.AffectedRequest>}\n   */\n  requests() {\n    return [this._details.request];\n  }\n\n  /**\n   * @override\n   * @return {!IssueCategory}\n   */\n  getCategory() {\n    return IssueCategory.CrossOriginEmbedderPolicy;\n  }\n\n  /**\n   * @override\n   * @returns {?MarkdownIssueDescription}\n   */\n  getDescription() {\n    const description = issueDescriptions.get(this.code());\n    if (!description) {\n      return null;\n    }\n    return description;\n  }\n}\n\n/** @type {!Map<string, !MarkdownIssueDescription>} */\nconst issueDescriptions = new Map([\n  [\n    'CrossOriginEmbedderPolicyIssue::CorpNotSameOriginAfterDefaultedToSameOriginByCoep', {\n      file: 'issues/descriptions/CoepCorpNotSameOriginAfterDefaultedToSameOriginByCoep.md',\n      substitutions: undefined,\n      issueKind: IssueKind.BreakingChange,\n      links: [\n        {link: 'https://web.dev/coop-coep/', linkTitle: ls`COOP and COEP`},\n        {link: 'https://web.dev/same-site-same-origin/', linkTitle: ls`Same-Site and Same-Origin`},\n      ],\n    }\n  ],\n  [\n    'CrossOriginEmbedderPolicyIssue::CoepFrameResourceNeedsCoepHeader', {\n      file: 'issues/descriptions/CoepFrameResourceNeedsCoepHeader.md',\n      substitutions: undefined,\n      issueKind: IssueKind.BreakingChange,\n      links: [\n        {link: 'https://web.dev/coop-coep/', linkTitle: ls`COOP and COEP`},\n      ],\n    }\n  ],\n  [\n    'CrossOriginEmbedderPolicyIssue::CoopSandboxedIframeCannotNavigateToCoopPage', {\n      file: 'issues/descriptions/CoepCoopSandboxedIframeCannotNavigateToCoopPage.md',\n      substitutions: undefined,\n      issueKind: IssueKind.BreakingChange,\n      links: [\n        {link: 'https://web.dev/coop-coep/', linkTitle: ls`COOP and COEP`},\n      ],\n    }\n  ],\n  [\n    'CrossOriginEmbedderPolicyIssue::CorpNotSameSite', {\n      file: 'issues/descriptions/CoepCorpNotSameSite.md',\n      substitutions: undefined,\n      issueKind: IssueKind.BreakingChange,\n      links: [\n        {link: 'https://web.dev/coop-coep/', linkTitle: ls`COOP and COEP`},\n        {link: 'https://web.dev/same-site-same-origin/', linkTitle: ls`Same-Site and Same-Origin`},\n      ],\n    }\n  ],\n  [\n    'CrossOriginEmbedderPolicyIssue::CorpNotSameOrigin', {\n      file: 'issues/descriptions/CoepCorpNotSameOrigin.md',\n      substitutions: undefined,\n      issueKind: IssueKind.BreakingChange,\n      links: [\n        {link: 'https://web.dev/coop-coep/', linkTitle: ls`COOP and COEP`},\n        {link: 'https://web.dev/same-site-same-origin/', linkTitle: ls`Same-Site and Same-Origin`},\n      ],\n    }\n  ],\n]);\n"]}