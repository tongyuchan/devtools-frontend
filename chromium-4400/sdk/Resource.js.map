{"version":3,"file":"Resource.js","sourceRoot":"","sources":["../../../../../front_end/sdk/Resource.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;GA0BG;AAEH,OAAO,KAAK,MAAM,MAAM,qBAAqB,CAAC;AAC9C,OAAO,KAAK,QAAQ,MAAM,yBAAyB,CAAC;AACpD,OAAO,KAAK,SAAS,MAAM,6BAA6B,CAAC;AAEzD,OAAO,EAAC,MAAM,EAAiB,MAAM,qBAAqB,CAAC,CAAmB,qCAAqC;AAGnH;;GAEG;AACH,MAAM,OAAO,QAAQ;IACnB;;;;;;;;;;;OAWG;IACH,YACI,iBAAiB,EAAE,OAAO,EAAE,GAAG,EAAE,WAAW,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,YAAY,EAAE,WAAW;QAC5G,IAAI,CAAC,kBAAkB,GAAG,iBAAiB,CAAC;QAC5C,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QACxB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACf,qBAAqB;QACrB,IAAI,CAAC,IAAI,CAAC;QAEV,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;QAChC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QACxB,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC1B,IAAI,CAAC,KAAK,GAAG,IAAI,IAAI,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,KAAK,CAAC;QAC7D,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAE1B,IAAI,CAAC,aAAa,GAAG,YAAY,IAAI,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC;QACxG,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;QAEhC,sBAAsB,CAAC,IAAI,CAAC,QAAQ,CAAC;QACrC,sBAAsB,CAAC,IAAI,CAAC,iBAAiB,CAAC;QAC9C,sBAAsB,CAAC,IAAI,CAAC,eAAe,CAAC;QAC5C,6CAA6C;QAC7C,IAAI,CAAC,wBAAwB,GAAG,EAAE,CAAC;QACnC,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;YAC5C,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;SACrF;IACH,CAAC;IAED;;OAEG;IACH,YAAY;QACV,IAAI,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YACxC,OAAO,IAAI,CAAC,aAAa,CAAC;SAC3B;QACD,MAAM,kBAAkB,GAAG,IAAI,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC;QAChE,MAAM,IAAI,GAAG,kBAAkB,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACtE,IAAI,CAAC,aAAa,GAAG,IAAI,IAAI,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;QAChF,OAAO,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAED;;OAEG;IACH,WAAW;QACT,IAAI,OAAO,IAAI,CAAC,YAAY,KAAK,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAC3D,OAAO,IAAI,CAAC,YAAY,CAAC;SAC1B;QACD,OAAO,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC;IACvB,CAAC;IAED;;OAEG;IACH,IAAI,GAAG;QACL,OAAO,IAAI,CAAC,IAAI,CAAC;IACnB,CAAC;IAED;;OAEG;IACH,IAAI,GAAG,CAAC,CAAC;QACP,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;QACd,IAAI,CAAC,UAAU,GAAG,IAAI,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;IACtD,CAAC;IAED,IAAI,SAAS;QACX,OAAO,IAAI,CAAC,UAAU,CAAC;IACzB,CAAC;IAED;;OAEG;IACH,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;IAED;;OAEG;IACH,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC;IACvB,CAAC;IAED;;OAEG;IACH,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,SAAS,CAAC;IACxB,CAAC;IAED;;OAEG;IACH,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC;IAC5D,CAAC;IAED;;OAEG;IACH,YAAY;QACV,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC;IACnE,CAAC;IAED;;OAEG;IACH,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;IACjE,CAAC;IAED;;OAEG;IACH,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC;IACvB,CAAC;IAED;;;OAGG;IACH,UAAU;QACR,OAAO,IAAI,CAAC,IAAI,CAAC;IACnB,CAAC;IAED;;;OAGG;IACH,WAAW;QACT,IAAI,IAAI,CAAC,YAAY,EAAE,KAAK,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,QAAQ;YAClE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,EAAE;YAC9C,OAAO,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,MAAM,CAAC;SACjD;QACD,OAAO,IAAI,CAAC,YAAY,EAAE,CAAC;IAC7B,CAAC;IAED;;;OAGG;IACH,KAAK,CAAC,cAAc;QAClB,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;QAC5B,OAAO,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAED;;;OAGG;IACH,cAAc;QACZ,IAAI,OAAO,IAAI,CAAC,QAAQ,KAAK,WAAW,EAAE;YACxC,OAAO,OAAO,CAAC,OAAO,CAAC,EAAC,OAAO,EAAE,qBAAqB,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,eAAe,EAAC,CAAC,CAAC;SAC3G;QAED,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;YAC3B,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,qCAAqC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACpF,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;gBAC5C,IAAI,CAAC,oBAAoB,EAAE,CAAC;aAC7B;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,iBAAiB;QACf,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC,QAAQ,CAAC;IACjE,CAAC;IAED;;;;;;OAMG;IACH,KAAK,CAAC,eAAe,CAAC,KAAK,EAAE,aAAa,EAAE,OAAO;QACjD,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YACjB,OAAO,EAAE,CAAC;SACX;QACD,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,OAAO,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,KAAK,EAAE,aAAa,EAAE,OAAO,CAAC,CAAC;SACpE;QACD,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,CAAC,SAAS,EAAE,CAAC,uBAAuB,CACrF,EAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,aAAa,EAAE,OAAO,EAAC,CAAC,CAAC;QAC3E,OAAO,MAAM,CAAC,MAAM,IAAI,EAAE,CAAC;IAC7B,CAAC;IAED;;OAEG;IACH,KAAK,CAAC,mBAAmB,CAAC,KAAK;QAC7B,MAAM,EAAC,OAAO,EAAC,GAAG,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;QAC9C,MAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC;QACrC,KAAK,CAAC,GAAG,GAAG,SAAS,CAAC,eAAe,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,EAAE,OAAO,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC;IACxG,CAAC;IAED,gBAAgB;QACd,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;SACxF;QACD,IAAI,IAAI,CAAC,wBAAwB,CAAC,MAAM,EAAE;YACxC,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;IACH,CAAC;IAED,KAAK,CAAC,oBAAoB;QACxB,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,OAAO;SACR;QACD,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAE9B,yDAAyD;QACzD,IAAI,UAAU,CAAC;QACf,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;YACrD,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC,OAAO,CAAC;YACpC,IAAI,CAAC,eAAe,GAAG,WAAW,CAAC,OAAO,CAAC;YAC3C,UAAU,GAAG,EAAC,OAAO,EAAE,oBAAoB,CAAC,CAAC,WAAW,CAAC,OAAO,CAAC,EAAE,SAAS,EAAE,WAAW,CAAC,OAAO,EAAC,CAAC;SACpG;aAAM;YACL,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,CAAC,SAAS,EAAE,CAAC,yBAAyB,CACzF,EAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAC,CAAC,CAAC;YAC5C,MAAM,aAAa,GAAG,QAAQ,CAAC,QAAQ,EAAE,CAAC;YAC1C,IAAI,aAAa,EAAE;gBACjB,IAAI,CAAC,iBAAiB,GAAG,aAAa,CAAC;gBACvC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,UAAU,GAAG,EAAC,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,aAAa,EAAE,SAAS,EAAE,KAAK,EAAC,CAAC;aACtE;iBAAM;gBACL,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC;gBACjC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;gBAC9B,UAAU,GAAG,EAAC,OAAO,EAAE,QAAQ,CAAC,OAAO,EAAE,SAAS,EAAE,QAAQ,CAAC,aAAa,EAAC,CAAC;aAC7E;YACD,IAAI,CAAC,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC;SAC/C;QAED,IAAI,IAAI,CAAC,QAAQ,KAAK,IAAI,EAAE;YAC1B,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;SAC9B;QAED,KAAK,MAAM,QAAQ,IAAI,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;YAC9D,QAAQ,CAAC,UAAU,CAAC,CAAC;SACtB;QAED,OAAO,IAAI,CAAC,iBAAiB,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,cAAc;QACZ,IAAI,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,EAAE;YAC3B,OAAO,IAAI,CAAC;SACb;QACD,IAAI,IAAI,CAAC,KAAK,KAAK,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,KAAK,EAAE;YAC1D,OAAO,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC;SACxD;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAED;;OAEG;IACH,KAAK;QACH,OAAO,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAED;;OAEG;IACH,UAAU;QACR,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;IACtD,CAAC;CACF","sourcesContent":["/*\n * Copyright (C) 2007, 2008 Apple Inc.  All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * 1.  Redistributions of source code must retain the above copyright\n *     notice, this list of conditions and the following disclaimer.\n * 2.  Redistributions in binary form must reproduce the above copyright\n *     notice, this list of conditions and the following disclaimer in the\n *     documentation and/or other materials provided with the distribution.\n * 3.  Neither the name of Apple Computer, Inc. (\"Apple\") nor the names of\n *     its contributors may be used to endorse or promote products derived\n *     from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS \"AS IS\" AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as Common from '../common/common.js';\nimport * as Platfrom from '../platform/platform.js';\nimport * as TextUtils from '../text_utils/text_utils.js';\n\nimport {Events, NetworkRequest} from './NetworkRequest.js';                   // eslint-disable-line no-unused-vars\nimport {ResourceTreeFrame, ResourceTreeModel} from './ResourceTreeModel.js';  // eslint-disable-line no-unused-vars\n\n/**\n * @implements {TextUtils.ContentProvider.ContentProvider}\n */\nexport class Resource {\n  /**\n   * @param {!ResourceTreeModel} resourceTreeModel\n   * @param {?NetworkRequest} request\n   * @param {string} url\n   * @param {string} documentURL\n   * @param {!Protocol.Page.FrameId} frameId\n   * @param {!Protocol.Network.LoaderId} loaderId\n   * @param {!Common.ResourceType.ResourceType} type\n   * @param {string} mimeType\n   * @param {?Date} lastModified\n   * @param {?number} contentSize\n   */\n  constructor(\n      resourceTreeModel, request, url, documentURL, frameId, loaderId, type, mimeType, lastModified, contentSize) {\n    this._resourceTreeModel = resourceTreeModel;\n    this._request = request;\n    this.url = url;\n    /** @type {string} */\n    this._url;\n\n    this._documentURL = documentURL;\n    this._frameId = frameId;\n    this._loaderId = loaderId;\n    this._type = type || Common.ResourceType.resourceTypes.Other;\n    this._mimeType = mimeType;\n\n    this._lastModified = lastModified && Platfrom.DateUtilities.isValid(lastModified) ? lastModified : null;\n    this._contentSize = contentSize;\n\n    /** @type {?string} */ this._content;\n    /** @type {?string} */ this._contentLoadError;\n    /** @type {boolean} */ this._contentEncoded;\n    /** @type {!Array<function(?Object):void>} */\n    this._pendingContentCallbacks = [];\n    if (this._request && !this._request.finished) {\n      this._request.addEventListener(Events.FinishedLoading, this._requestFinished, this);\n    }\n  }\n\n  /**\n   * @return {?Date}\n   */\n  lastModified() {\n    if (this._lastModified || !this._request) {\n      return this._lastModified;\n    }\n    const lastModifiedHeader = this._request.responseLastModified();\n    const date = lastModifiedHeader ? new Date(lastModifiedHeader) : null;\n    this._lastModified = date && Platfrom.DateUtilities.isValid(date) ? date : null;\n    return this._lastModified;\n  }\n\n  /**\n   * @return {?number}\n   */\n  contentSize() {\n    if (typeof this._contentSize === 'number' || !this._request) {\n      return this._contentSize;\n    }\n    return this._request.resourceSize;\n  }\n\n  /**\n   * @return {?NetworkRequest}\n   */\n  get request() {\n    return this._request;\n  }\n\n  /**\n   * @return {string}\n   */\n  get url() {\n    return this._url;\n  }\n\n  /**\n   * @param {string} x\n   */\n  set url(x) {\n    this._url = x;\n    this._parsedURL = new Common.ParsedURL.ParsedURL(x);\n  }\n\n  get parsedURL() {\n    return this._parsedURL;\n  }\n\n  /**\n   * @return {string}\n   */\n  get documentURL() {\n    return this._documentURL;\n  }\n\n  /**\n   * @return {!Protocol.Page.FrameId}\n   */\n  get frameId() {\n    return this._frameId;\n  }\n\n  /**\n   * @return {!Protocol.Network.LoaderId}\n   */\n  get loaderId() {\n    return this._loaderId;\n  }\n\n  /**\n   * @return {string}\n   */\n  get displayName() {\n    return this._parsedURL ? this._parsedURL.displayName : '';\n  }\n\n  /**\n   * @return {!Common.ResourceType.ResourceType}\n   */\n  resourceType() {\n    return this._request ? this._request.resourceType() : this._type;\n  }\n\n  /**\n   * @return {string}\n   */\n  get mimeType() {\n    return this._request ? this._request.mimeType : this._mimeType;\n  }\n\n  /**\n   * @return {?string}\n   */\n  get content() {\n    return this._content;\n  }\n\n  /**\n   * @override\n   * @return {string}\n   */\n  contentURL() {\n    return this._url;\n  }\n\n  /**\n   * @override\n   * @return {!Common.ResourceType.ResourceType}\n   */\n  contentType() {\n    if (this.resourceType() === Common.ResourceType.resourceTypes.Document &&\n        this.mimeType.indexOf('javascript') !== -1) {\n      return Common.ResourceType.resourceTypes.Script;\n    }\n    return this.resourceType();\n  }\n\n  /**\n   * @override\n   * @return {!Promise<boolean>}\n   */\n  async contentEncoded() {\n    await this.requestContent();\n    return this._contentEncoded;\n  }\n\n  /**\n   * @override\n   * @return {!Promise<!TextUtils.ContentProvider.DeferredContent>}\n   */\n  requestContent() {\n    if (typeof this._content !== 'undefined') {\n      return Promise.resolve({content: /** @type {string} */ (this._content), isEncoded: this._contentEncoded});\n    }\n\n    return new Promise(resolve => {\n      this._pendingContentCallbacks.push(/** @type {function(?Object):void} */ (resolve));\n      if (!this._request || this._request.finished) {\n        this._innerRequestContent();\n      }\n    });\n  }\n\n  /**\n   * @return {string}\n   */\n  canonicalMimeType() {\n    return this.contentType().canonicalMimeType() || this.mimeType;\n  }\n\n  /**\n   * @override\n   * @param {string} query\n   * @param {boolean} caseSensitive\n   * @param {boolean} isRegex\n   * @return {!Promise<!Array<!TextUtils.ContentProvider.SearchMatch>>}\n   */\n  async searchInContent(query, caseSensitive, isRegex) {\n    if (!this.frameId) {\n      return [];\n    }\n    if (this.request) {\n      return this.request.searchInContent(query, caseSensitive, isRegex);\n    }\n    const result = await this._resourceTreeModel.target().pageAgent().invoke_searchInResource(\n        {frameId: this.frameId, url: this.url, query, caseSensitive, isRegex});\n    return result.result || [];\n  }\n\n  /**\n   * @param {!HTMLImageElement} image\n   */\n  async populateImageSource(image) {\n    const {content} = await this.requestContent();\n    const encoded = this._contentEncoded;\n    image.src = TextUtils.ContentProvider.contentAsDataURL(content, this._mimeType, encoded) || this._url;\n  }\n\n  _requestFinished() {\n    if (this._request) {\n      this._request.removeEventListener(Events.FinishedLoading, this._requestFinished, this);\n    }\n    if (this._pendingContentCallbacks.length) {\n      this._innerRequestContent();\n    }\n  }\n\n  async _innerRequestContent() {\n    if (this._contentRequested) {\n      return;\n    }\n    this._contentRequested = true;\n\n    /** @type {!TextUtils.ContentProvider.DeferredContent} */\n    let loadResult;\n    if (this.request) {\n      const contentData = await this.request.contentData();\n      this._content = contentData.content;\n      this._contentEncoded = contentData.encoded;\n      loadResult = {content: /** @type{string} */ (contentData.content), isEncoded: contentData.encoded};\n    } else {\n      const response = await this._resourceTreeModel.target().pageAgent().invoke_getResourceContent(\n          {frameId: this.frameId, url: this.url});\n      const protocolError = response.getError();\n      if (protocolError) {\n        this._contentLoadError = protocolError;\n        this._content = null;\n        loadResult = {content: null, error: protocolError, isEncoded: false};\n      } else {\n        this._content = response.content;\n        this._contentLoadError = null;\n        loadResult = {content: response.content, isEncoded: response.base64Encoded};\n      }\n      this._contentEncoded = response.base64Encoded;\n    }\n\n    if (this._content === null) {\n      this._contentEncoded = false;\n    }\n\n    for (const callback of this._pendingContentCallbacks.splice(0)) {\n      callback(loadResult);\n    }\n\n    delete this._contentRequested;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  hasTextContent() {\n    if (this._type.isTextType()) {\n      return true;\n    }\n    if (this._type === Common.ResourceType.resourceTypes.Other) {\n      return Boolean(this._content) && !this._contentEncoded;\n    }\n    return false;\n  }\n\n  /**\n   * @return {?ResourceTreeFrame}\n   */\n  frame() {\n    return this._resourceTreeModel.frameForId(this._frameId);\n  }\n\n  /**\n   * @return {number}\n   */\n  statusCode() {\n    return this._request ? this._request.statusCode : 0;\n  }\n}\n"]}