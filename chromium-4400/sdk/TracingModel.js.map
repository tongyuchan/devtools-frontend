{"version":3,"file":"TracingModel.js","sourceRoot":"","sources":["../../../../../front_end/sdk/TracingModel.js"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../common/common.js';\n\nimport {EventPayload} from './TracingManager.js';  // eslint-disable-line no-unused-vars\n\nexport class TracingModel {\n  /**\n   * @param {!BackingStorage} backingStorage\n   */\n  constructor(backingStorage) {\n    this._backingStorage = backingStorage;\n    // Avoid extra reset of the storage as it's expensive.\n    this._firstWritePending = true;\n    /** @type {!Map<(number|string), !Process>} */\n    this._processById = new Map();\n    this._processByName = new Map();\n    this._minimumRecordTime = 0;\n    /** @type {number} */\n    this._maximumRecordTime = 0;\n    /** @type {!Array<!Event>} */\n    this._devToolsMetadataEvents = [];\n    /** @type {!Array<!AsyncEvent>} */\n    this._asyncEvents = [];\n    /** @type {!Map<string, !AsyncEvent>} */\n    this._openAsyncEvents = new Map();\n    /** @type {!Map<string, !Array<!AsyncEvent>>} */\n    this._openNestableAsyncEvents = new Map();\n    /** @type {!Map<string, !ProfileEventsGroup>} */\n    this._profileGroups = new Map();\n    /** @type {!Map<string, !Set<string>>} */\n    this._parsedCategories = new Map();\n    /** @type {!Map<string, !Event>} */\n    this._mainFrameNavStartTimes = new Map();\n  }\n\n  /**\n   * @param {string} phase\n   * @return {boolean}\n   */\n  static isNestableAsyncPhase(phase) {\n    return phase === 'b' || phase === 'e' || phase === 'n';\n  }\n\n  /**\n   * @param {string} phase\n   * @return {boolean}\n   */\n  static isAsyncBeginPhase(phase) {\n    return phase === 'S' || phase === 'b';\n  }\n\n  /**\n   * @param {string} phase\n   * @return {boolean}\n   */\n  static isAsyncPhase(phase) {\n    return TracingModel.isNestableAsyncPhase(phase) || phase === 'S' || phase === 'T' || phase === 'F' || phase === 'p';\n  }\n\n  /**\n   * @param {string} phase\n   * @return {boolean}\n   */\n  static isFlowPhase(phase) {\n    return phase === 's' || phase === 't' || phase === 'f';\n  }\n\n  /**\n   * @param {string} phase\n   * @return {boolean}\n   */\n  static isCompletePhase(phase) {\n    return phase === 'X';\n  }\n\n  /**\n   * @param {!Event} event\n   * @return {boolean}\n   */\n  static isTopLevelEvent(event) {\n    return event.hasCategory(DevToolsTimelineEventCategory) && event.name === 'RunTask' ||\n        event.hasCategory(LegacyTopLevelEventCategory) ||\n        event.hasCategory(DevToolsMetadataEventCategory) &&\n        event.name === 'Program';  // Older timelines may have this instead of toplevel.\n  }\n\n  /**\n   * @param {!EventPayload} payload\n   * @return {string|undefined}\n   */\n  static _extractId(payload) {\n    const scope = payload.scope || '';\n    if (typeof payload.id2 === 'undefined') {\n      return scope && payload.id ? `${scope}@${payload.id}` : payload.id;\n    }\n    const id2 = payload.id2;\n    if (typeof id2 === 'object' && ('global' in id2) !== ('local' in id2)) {\n      return typeof id2['global'] !== 'undefined' ? `:${scope}:${id2['global']}` :\n                                                    `:${scope}:${payload.pid}:${id2['local']}`;\n    }\n    console.error(\n        `Unexpected id2 field at ${payload.ts / 1000}, one and only one of 'local' and 'global' should be present.`);\n    return undefined;\n  }\n\n  /**\n   * @param {!TracingModel} tracingModel\n   * @return {?Thread}\n   *\n   * TODO: Move this to a better place. This is here just for convenience o\n   * re-use between modules. This really belongs to a higher level, since it\n   * is specific to chrome's usage of tracing.\n   */\n  static browserMainThread(tracingModel) {\n    const processes = tracingModel.sortedProcesses();\n    // Avoid warning for an empty model.\n    if (!processes.length) {\n      return null;\n    }\n    const browserMainThreadName = 'CrBrowserMain';\n    const browserProcesses = [];\n    const browserMainThreads = [];\n    for (const process of processes) {\n      if (process.name().toLowerCase().endsWith('browser')) {\n        browserProcesses.push(process);\n      }\n      browserMainThreads.push(...process.sortedThreads().filter(t => t.name() === browserMainThreadName));\n    }\n    if (browserMainThreads.length === 1) {\n      return browserMainThreads[0];\n    }\n    if (browserProcesses.length === 1) {\n      return browserProcesses[0].threadByName(browserMainThreadName);\n    }\n    const tracingStartedInBrowser =\n        tracingModel.devToolsMetadataEvents().filter(e => e.name === 'TracingStartedInBrowser');\n    if (tracingStartedInBrowser.length === 1) {\n      return tracingStartedInBrowser[0].thread;\n    }\n    Common.Console.Console.instance().error('Failed to find browser main thread in trace, some timeline features may be unavailable');\n    return null;\n  }\n\n  /**\n   * @return {!Array<!Event>}\n   */\n  devToolsMetadataEvents() {\n    return this._devToolsMetadataEvents;\n  }\n\n  /**\n   * @param {!Array<!EventPayload>} events\n   */\n  addEvents(events) {\n    for (let i = 0; i < events.length; ++i) {\n      this._addEvent(events[i]);\n    }\n  }\n\n  tracingComplete() {\n    this._processPendingAsyncEvents();\n    this._backingStorage.appendString(this._firstWritePending ? '[]' : ']');\n    this._backingStorage.finishWriting();\n    this._firstWritePending = false;\n    for (const process of this._processById.values()) {\n      for (const thread of process._threads.values()) {\n        thread.tracingComplete();\n      }\n    }\n  }\n\n  dispose() {\n    if (!this._firstWritePending) {\n      this._backingStorage.reset();\n    }\n  }\n\n  /**\n   * @param {number} offset\n   */\n  adjustTime(offset) {\n    this._minimumRecordTime += offset;\n    this._maximumRecordTime += offset;\n    for (const process of this._processById.values()) {\n      for (const thread of process._threads.values()) {\n        for (const event of thread.events()) {\n          event.startTime += offset;\n          if (typeof event.endTime === 'number') {\n            event.endTime += offset;\n          }\n        }\n        for (const event of thread.asyncEvents()) {\n          event.startTime += offset;\n          if (typeof event.endTime === 'number') {\n            event.endTime += offset;\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {!EventPayload} payload\n   */\n  _addEvent(payload) {\n    let process = this._processById.get(payload.pid);\n    if (!process) {\n      process = new Process(this, payload.pid);\n      this._processById.set(payload.pid, process);\n    }\n\n    const phase = Phase;\n    const eventsDelimiter = ',\\n';\n    this._backingStorage.appendString(this._firstWritePending ? '[' : eventsDelimiter);\n    this._firstWritePending = false;\n    const stringPayload = JSON.stringify(payload);\n    const isAccessible = payload.ph === phase.SnapshotObject;\n    let backingStorage = null;\n    const keepStringsLessThan = 10000;\n    if (isAccessible && stringPayload.length > keepStringsLessThan) {\n      backingStorage = this._backingStorage.appendAccessibleString(stringPayload);\n    } else {\n      this._backingStorage.appendString(stringPayload);\n    }\n\n    const timestamp = payload.ts / 1000;\n    // We do allow records for unrelated threads to arrive out-of-order,\n    // so there's a chance we're getting records from the past.\n    if (timestamp && (!this._minimumRecordTime || timestamp < this._minimumRecordTime) &&\n        (payload.ph === phase.Begin || payload.ph === phase.Complete || payload.ph === phase.Instant)) {\n      this._minimumRecordTime = timestamp;\n    }\n\n    // Track only main thread navigation start items. This is done by tracking isLoadingMainFrame,\n    // and whether documentLoaderURL is set.\n    if (payload.name === 'navigationStart') {\n      const data = /** @type {?{isLoadingMainFrame: boolean, documentLoaderURL: string, navigationId: string}} */ (\n          payload.args.data);\n      if (data) {\n        const {isLoadingMainFrame, documentLoaderURL, navigationId} = data;\n        if (isLoadingMainFrame && documentLoaderURL !== '') {\n          const thread = process.threadById(payload.tid);\n          const navStartEvent = Event.fromPayload(payload, thread);\n          this._mainFrameNavStartTimes.set(navigationId, navStartEvent);\n        }\n      }\n    }\n\n    const endTimeStamp = (payload.ts + (payload.dur || 0)) / 1000;\n    this._maximumRecordTime = Math.max(this._maximumRecordTime, endTimeStamp);\n    const event = process._addEvent(payload);\n    if (!event) {\n      return;\n    }\n    if (payload.ph === phase.Sample) {\n      this._addSampleEvent(event);\n      return;\n    }\n    // Build async event when we've got events from all threads & processes, so we can sort them and process in the\n    // chronological order. However, also add individual async events to the thread flow (above), so we can easily\n    // display them on the same chart as other events, should we choose so.\n    if (TracingModel.isAsyncPhase(payload.ph)) {\n      this._asyncEvents.push(/** @type {!AsyncEvent} */ (event));\n    }\n    event._setBackingStorage(backingStorage);\n    if (event.hasCategory(DevToolsMetadataEventCategory)) {\n      this._devToolsMetadataEvents.push(event);\n    }\n\n    if (payload.ph !== phase.Metadata) {\n      return;\n    }\n\n    switch (payload.name) {\n      case MetadataEvent.ProcessSortIndex: {\n        process._setSortIndex(payload.args['sort_index']);\n        break;\n      }\n      case MetadataEvent.ProcessName: {\n        const processName = payload.args['name'];\n        process._setName(processName);\n        this._processByName.set(processName, process);\n        break;\n      }\n      case MetadataEvent.ThreadSortIndex: {\n        process.threadById(payload.tid)._setSortIndex(payload.args['sort_index']);\n        break;\n      }\n      case MetadataEvent.ThreadName: {\n        process.threadById(payload.tid)._setName(payload.args['name']);\n        break;\n      }\n    }\n  }\n\n  /**\n   * @param {!Event} event\n   */\n  _addSampleEvent(event) {\n    const id = `${event.thread.process().id()}:${event.id}`;\n    const group = this._profileGroups.get(id);\n    if (group) {\n      group._addChild(event);\n    } else {\n      this._profileGroups.set(id, new ProfileEventsGroup(event));\n    }\n  }\n\n  /**\n   * @param {!Event} event\n   * @return {?ProfileEventsGroup}\n   */\n  profileGroup(event) {\n    return this._profileGroups.get(`${event.thread.process().id()}:${event.id}`) || null;\n  }\n\n  /**\n   * @return {number}\n   */\n  minimumRecordTime() {\n    return this._minimumRecordTime;\n  }\n\n  /**\n   * @return {number}\n   */\n  maximumRecordTime() {\n    return this._maximumRecordTime;\n  }\n\n  /**\n   * @return {!Map<string, !Event>}\n   */\n  navStartTimes() {\n    return this._mainFrameNavStartTimes;\n  }\n\n  /**\n   * @return {!Array<!Process>}\n   */\n  sortedProcesses() {\n    return Sorter.sort([...this._processById.values()]);\n  }\n\n  /**\n   * @param {string} name\n   * @return {?Process}\n   */\n  processByName(name) {\n    return this._processByName.get(name);\n  }\n\n  /**\n   * @param {number} pid\n   * @return {?Process}\n   */\n  processById(pid) {\n    return this._processById.get(pid) || null;\n  }\n\n  /**\n   * @param {string} processName\n   * @param {string} threadName\n   * @return {?Thread}\n   */\n  threadByName(processName, threadName) {\n    const process = this.processByName(processName);\n    return process && process.threadByName(threadName);\n  }\n\n  /**\n   * @param {string} processName\n   * @param {string} threadName\n   * @param {string} eventName\n   * @return {!Array<!Event>}\n   */\n  extractEventsFromThreadByName(processName, threadName, eventName) {\n    const thread = this.threadByName(processName, threadName);\n    if (!thread) {\n      return [];\n    }\n\n    return thread.removeEventsByName(eventName);\n  }\n\n  _processPendingAsyncEvents() {\n    this._asyncEvents.sort(Event.compareStartTime);\n    for (let i = 0; i < this._asyncEvents.length; ++i) {\n      const event = this._asyncEvents[i];\n      if (TracingModel.isNestableAsyncPhase(event.phase)) {\n        this._addNestableAsyncEvent(event);\n      } else {\n        this._addAsyncEvent(event);\n      }\n    }\n    this._asyncEvents = [];\n    this._closeOpenAsyncEvents();\n  }\n\n  _closeOpenAsyncEvents() {\n    for (const event of this._openAsyncEvents.values()) {\n      event.setEndTime(this._maximumRecordTime);\n      // FIXME: remove this once we figure a better way to convert async console\n      // events to sync [waterfall] timeline records.\n      event.steps[0].setEndTime(this._maximumRecordTime);\n    }\n    this._openAsyncEvents.clear();\n\n    for (const eventStack of this._openNestableAsyncEvents.values()) {\n      while (eventStack.length) {\n        const event = eventStack.pop();\n        if (!event) {\n          continue;\n        }\n        event.setEndTime(this._maximumRecordTime);\n      }\n    }\n    this._openNestableAsyncEvents.clear();\n  }\n\n  /**\n   * @param {!Event} event\n   */\n  _addNestableAsyncEvent(event) {\n    const phase = Phase;\n    const key = event.categoriesString + '.' + event.id;\n    let openEventsStack = this._openNestableAsyncEvents.get(key);\n\n    switch (event.phase) {\n      case phase.NestableAsyncBegin: {\n        if (!openEventsStack) {\n          openEventsStack = [];\n          this._openNestableAsyncEvents.set(key, openEventsStack);\n        }\n        const asyncEvent = new AsyncEvent(event);\n        openEventsStack.push(asyncEvent);\n        event.thread._addAsyncEvent(asyncEvent);\n        break;\n      }\n\n      case phase.NestableAsyncInstant: {\n        if (openEventsStack && openEventsStack.length) {\n          const event = openEventsStack[openEventsStack.length - 1];\n          if (event) {\n            event._addStep(event);\n          }\n        }\n        break;\n      }\n\n      case phase.NestableAsyncEnd: {\n        if (!openEventsStack || !openEventsStack.length) {\n          break;\n        }\n        const top = openEventsStack.pop();\n        if (!top) {\n          break;\n        }\n        if (top.name !== event.name) {\n          console.error(\n              `Begin/end event mismatch for nestable async event, ${top.name} vs. ${event.name}, key: ${key}`);\n          break;\n        }\n        top._addStep(event);\n      }\n    }\n  }\n\n  /**\n   * @param {!Event} event\n   */\n  _addAsyncEvent(event) {\n    const phase = Phase;\n    const key = event.categoriesString + '.' + event.name + '.' + event.id;\n    let asyncEvent = this._openAsyncEvents.get(key);\n\n    if (event.phase === phase.AsyncBegin) {\n      if (asyncEvent) {\n        console.error(`Event ${event.name} has already been started`);\n        return;\n      }\n      asyncEvent = new AsyncEvent(event);\n      this._openAsyncEvents.set(key, asyncEvent);\n      event.thread._addAsyncEvent(asyncEvent);\n      return;\n    }\n    if (!asyncEvent) {\n      // Quietly ignore stray async events, we're probably too late for the start.\n      return;\n    }\n    if (event.phase === phase.AsyncEnd) {\n      asyncEvent._addStep(event);\n      this._openAsyncEvents.delete(key);\n      return;\n    }\n    if (event.phase === phase.AsyncStepInto || event.phase === phase.AsyncStepPast) {\n      const lastStep = asyncEvent.steps[asyncEvent.steps.length - 1];\n      if (lastStep && lastStep.phase !== phase.AsyncBegin && lastStep.phase !== event.phase) {\n        console.assert(\n            false, 'Async event step phase mismatch: ' + lastStep.phase + ' at ' + lastStep.startTime + ' vs. ' +\n                event.phase + ' at ' + event.startTime);\n        return;\n      }\n      asyncEvent._addStep(event);\n      return;\n    }\n    console.assert(false, 'Invalid async event phase');\n  }\n\n  /**\n   * @return {!BackingStorage}\n   */\n  backingStorage() {\n    return this._backingStorage;\n  }\n\n  /**\n   * @param {string} str\n   * @return {!Set<string>}\n   */\n  _parsedCategoriesForString(str) {\n    let parsedCategories = this._parsedCategories.get(str);\n    if (!parsedCategories) {\n      parsedCategories = new Set(str ? str.split(',') : []);\n      this._parsedCategories.set(str, parsedCategories);\n    }\n    return parsedCategories;\n  }\n}\n\n/**\n * @enum {string}\n */\nexport const Phase = {\n  Begin: 'B',\n  End: 'E',\n  Complete: 'X',\n  Instant: 'I',\n  AsyncBegin: 'S',\n  AsyncStepInto: 'T',\n  AsyncStepPast: 'p',\n  AsyncEnd: 'F',\n  NestableAsyncBegin: 'b',\n  NestableAsyncEnd: 'e',\n  NestableAsyncInstant: 'n',\n  FlowBegin: 's',\n  FlowStep: 't',\n  FlowEnd: 'f',\n  Metadata: 'M',\n  Counter: 'C',\n  Sample: 'P',\n  CreateObject: 'N',\n  SnapshotObject: 'O',\n  DeleteObject: 'D'\n};\n\nexport const MetadataEvent = {\n  ProcessSortIndex: 'process_sort_index',\n  ProcessName: 'process_name',\n  ThreadSortIndex: 'thread_sort_index',\n  ThreadName: 'thread_name'\n};\n\n// TODO(alph): LegacyTopLevelEventCategory is not recorded since M74 and used for loading\n// legacy profiles. Drop at some point.\nexport const LegacyTopLevelEventCategory = 'toplevel';\n\nexport const DevToolsMetadataEventCategory = 'disabled-by-default-devtools.timeline';\nexport const DevToolsTimelineEventCategory = 'disabled-by-default-devtools.timeline';\n\n/**\n * @interface\n */\nexport class BackingStorage {\n  /**\n   * @param {string} string\n   */\n  appendString(string) {\n  }\n\n  /**\n   * @param {string} string\n   * @return {function():!Promise<?string>}\n   */\n  appendAccessibleString(string) {\n    throw new Error('Not implemented yet');\n  }\n\n  finishWriting() {\n  }\n\n  reset() {}\n}\n\n/** @typedef {*} */\nlet Args;  // eslint-disable-line no-unused-vars\n\nexport class Event {\n  /**\n   * @param {string|undefined} categories\n   * @param {string} name\n   * @param {!Phase} phase\n   * @param {number} startTime\n   * @param {!Thread} thread\n   */\n  constructor(categories, name, phase, startTime, thread) {\n    /** @type {string} */\n    this.categoriesString = categories || '';\n    /** @type {!Set<string>} */\n    this._parsedCategories = thread._model._parsedCategoriesForString(this.categoriesString);\n    /** @type {string} */\n    this.name = name;\n    /** @type {!Phase} */\n    this.phase = phase;\n    /** @type {number} */\n    this.startTime = startTime;\n    /** @type {!Thread} */\n    this.thread = thread;\n    /** @type {!Args} */\n    this.args = {};\n    /** @type {?string} */\n    this.id;\n    /** @type {?string} */\n    this.bind_id;\n    /** @type {number} */\n    this.ordinal = 0;\n\n    /** @type {number} */\n    this.selfTime = 0;\n  }\n\n  /**\n   * @this {null}\n   * @param {!EventPayload} payload\n   * @param {!Thread} thread\n   * @return {!Event}\n   */\n  static fromPayload(payload, thread) {\n    const event = new Event(payload.cat, payload.name, /** @type {!Phase} */ (payload.ph), payload.ts / 1000, thread);\n    if (payload.args) {\n      event.addArgs(payload.args);\n    }\n    if (typeof payload.dur === 'number') {\n      event.setEndTime((payload.ts + payload.dur) / 1000);\n    }\n    const id = TracingModel._extractId(payload);\n    if (typeof id !== 'undefined') {\n      event.id = id;\n    }\n    if (payload.bind_id) {\n      event.bind_id = payload.bind_id;\n    }\n\n    return event;\n  }\n\n  /**\n   * @param {?Event} a\n   * @param {?Event} b\n   * @return {number}\n   */\n  static compareStartTime(a, b) {\n    if (!a || !b) {\n      return 0;\n    }\n\n    return a.startTime - b.startTime;\n  }\n\n  /**\n   * @param {!Event} a\n   * @param {!Event} b\n   * @return {number}\n   */\n  static orderedCompareStartTime(a, b) {\n    // Array.mergeOrdered coalesces objects if comparator returns 0.\n    // To change this behavior this comparator return -1 in the case events\n    // startTime's are equal, so both events got placed into the result array.\n    return a.startTime - b.startTime || a.ordinal - b.ordinal || -1;\n  }\n\n  /**\n   * @param {string} categoryName\n   * @return {boolean}\n   */\n  hasCategory(categoryName) {\n    return this._parsedCategories.has(categoryName);\n  }\n\n  /**\n   * @param {number} endTime\n   */\n  setEndTime(endTime) {\n    if (endTime < this.startTime) {\n      console.assert(false, 'Event out of order: ' + this.name);\n      return;\n    }\n    this.endTime = endTime;\n    this.duration = endTime - this.startTime;\n  }\n\n  /**\n   * @param {!Args} args\n   */\n  addArgs(args) {\n    // Shallow copy args to avoid modifying original payload which may be saved to file.\n    for (const name in args) {\n      if (name in this.args) {\n        console.error('Same argument name (' + name + ') is used for begin and end phases of ' + this.name);\n      }\n      /** @typedef {Object<string, string|number|ObjectSnapshot>} */\n      let IgnoreListArgs;  // eslint-disable-line no-unused-vars\n      /** @type {!IgnoreListArgs} */ (this.args)[name] = /** @type {!IgnoreListArgs} */ (args)[name];\n    }\n  }\n\n  /**\n   * @param {!Event} endEvent\n   */\n  _complete(endEvent) {\n    if (endEvent.args) {\n      this.addArgs(endEvent.args);\n    } else {\n      console.error('Missing mandatory event argument \\'args\\' at ' + endEvent.startTime);\n    }\n    this.setEndTime(endEvent.startTime);\n  }\n\n  /**\n   * @param {?function():!Promise.<?string>} backingStorage\n   */\n  _setBackingStorage(backingStorage) {\n  }\n}\n\nexport class ObjectSnapshot extends Event {\n  /**\n   * @param {string|undefined} category\n   * @param {string} name\n   * @param {number} startTime\n   * @param {!Thread} thread\n   */\n  constructor(category, name, startTime, thread) {\n    super(category, name, Phase.SnapshotObject, startTime, thread);\n    /** @type {?function():!Promise<?string>} */\n    this._backingStorage = null;\n    /** @type {string} */\n    this.id;\n    /** @type {?Promise<?>} */\n    this._objectPromise = null;\n  }\n\n  /**\n   * @override\n   * @this {null}\n   * @param {!EventPayload} payload\n   * @param {!Thread} thread\n   * @return {!ObjectSnapshot}\n   */\n  static fromPayload(payload, thread) {\n    const snapshot = new ObjectSnapshot(payload.cat, payload.name, payload.ts / 1000, thread);\n    const id = TracingModel._extractId(payload);\n    if (typeof id !== 'undefined') {\n      snapshot.id = id;\n    }\n    if (!payload.args || !payload.args['snapshot']) {\n      console.error('Missing mandatory \\'snapshot\\' argument at ' + payload.ts / 1000);\n      return snapshot;\n    }\n    if (payload.args) {\n      snapshot.addArgs(payload.args);\n    }\n    return snapshot;\n  }\n\n  /**\n   * @param {function(?ObjectSnapshot):void} callback\n   */\n  requestObject(callback) {\n    const snapshot = this.args['snapshot'];\n    if (snapshot) {\n      callback(/** @type {!ObjectSnapshot} */ (snapshot));\n      return;\n    }\n    const storage = this._backingStorage;\n    if (storage) {\n      storage().then(onRead, callback.bind(null, null));\n    }\n\n    /**\n     * @param {?string} result\n     */\n    function onRead(result) {\n      if (!result) {\n        callback(null);\n        return;\n      }\n      try {\n        const payload = JSON.parse(result);\n        callback(payload['args']['snapshot']);\n      } catch (e) {\n        Common.Console.Console.instance().error('Malformed event data in backing storage');\n        callback(null);\n      }\n    }\n  }\n\n  /**\n   * @return {!Promise<*>}\n   */\n  objectPromise() {\n    if (!this._objectPromise) {\n      this._objectPromise = new Promise(this.requestObject.bind(this));\n    }\n    return this._objectPromise;\n  }\n\n  /**\n   * @override\n   * @param {?function():!Promise.<?>} backingStorage\n   */\n  _setBackingStorage(backingStorage) {\n    if (!backingStorage) {\n      return;\n    }\n    this._backingStorage = backingStorage;\n    this.args = {};\n  }\n}\n\nexport class AsyncEvent extends Event {\n  /**\n   * @param {!Event} startEvent\n   */\n  constructor(startEvent) {\n    super(startEvent.categoriesString, startEvent.name, startEvent.phase, startEvent.startTime, startEvent.thread);\n    this.addArgs(startEvent.args);\n    this.steps = [startEvent];\n    this.causedFrame = false;\n  }\n\n  /**\n   * @param {!Event} event\n   */\n  _addStep(event) {\n    this.steps.push(event);\n    if (event.phase === Phase.AsyncEnd || event.phase === Phase.NestableAsyncEnd) {\n      this.setEndTime(event.startTime);\n      // FIXME: ideally, we shouldn't do this, but this makes the logic of converting\n      // async console events to sync ones much simpler.\n      this.steps[0].setEndTime(event.startTime);\n    }\n  }\n}\n\n\nclass ProfileEventsGroup {\n  /**\n   * @param {!Event} event\n   */\n  constructor(event) {\n    /** @type {!Array<!Event>} */\n    this.children = [event];\n  }\n\n  /**\n   * @param {!Event} event\n   */\n  _addChild(event) {\n    this.children.push(event);\n  }\n}\n/**\n  @typedef {{\n    _sortIndex: number,\n    name: function():string,\n  }}\n */\nlet Sortable;  // eslint-disable-line no-unused-vars\n\nclass Sorter {\n  /**\n   * @template Item\n   * @param {!Array<!Item>} array\n   * @return {!Array<!Item>}\n   */\n  static sort(array) {\n    /**\n     * @param {!Sortable} a\n     * @param {!Sortable} b\n     */\n    function comparator(a, b) {\n      return a._sortIndex !== b._sortIndex ? a._sortIndex - b._sortIndex : a.name().localeCompare(b.name());\n    }\n    // TODO(crbug.com/1082064): In TS the definition would be `param {!Array<Item & Sortable>} array`.\n    // But Closure compiler does not support that, therefore, a cast is needed.\n    return (/** @type {?} */ (array)).sort(comparator);\n  }\n}\n\nclass NamedObject {\n  /**\n   * @param {!TracingModel} model\n   * @param {number} id\n   */\n  constructor(model, id) {\n    this._model = model;\n    this._id = id;\n    this._name = '';\n    this._sortIndex = 0;\n  }\n\n  /**\n   * @param {string} name\n   */\n  _setName(name) {\n    this._name = name;\n  }\n\n  /**\n   * @return {string}\n   */\n  name() {\n    return this._name;\n  }\n\n  /**\n   * @param {number} sortIndex\n   */\n  _setSortIndex(sortIndex) {\n    this._sortIndex = sortIndex;\n  }\n}\n\nexport class Process extends NamedObject {\n  /**\n   * @param {!TracingModel} model\n   * @param {number} id\n   */\n  constructor(model, id) {\n    super(model, id);\n    /** @type {!Map<number, !Thread>} */\n    this._threads = new Map();\n    this._threadByName = new Map();\n  }\n\n  /**\n   * @return {number}\n   */\n  id() {\n    return this._id;\n  }\n\n  /**\n   * @param {number} id\n   * @return {!Thread}\n   */\n  threadById(id) {\n    let thread = this._threads.get(id);\n    if (!thread) {\n      thread = new Thread(this, id);\n      this._threads.set(id, thread);\n    }\n    return thread;\n  }\n\n  /**\n   * @param {string} name\n   * @return {?Thread}\n   */\n  threadByName(name) {\n    return this._threadByName.get(name) || null;\n  }\n\n  /**\n   * @param {string} name\n   * @param {!Thread} thread\n   */\n  _setThreadByName(name, thread) {\n    this._threadByName.set(name, thread);\n  }\n\n  /**\n   * @param {!EventPayload} payload\n   * @return {?Event} event\n   */\n  _addEvent(payload) {\n    return this.threadById(payload.tid)._addEvent(payload);\n  }\n\n  /**\n   * @return {!Array<!Thread>}\n   */\n  sortedThreads() {\n    return Sorter.sort([...this._threads.values()]);\n  }\n}\n\nexport class Thread extends NamedObject {\n  /**\n   * @param {!Process} process\n   * @param {number} id\n   */\n  constructor(process, id) {\n    super(process._model, id);\n    this._process = process;\n\n    /**\n     * @type {!Array<!Event>};\n     */\n    this._events = [];\n    /**\n     * @type {!Array<!AsyncEvent>};\n     */\n    this._asyncEvents = [];\n    this._lastTopLevelEvent = null;\n  }\n\n  tracingComplete() {\n    this._asyncEvents.sort(Event.compareStartTime);\n    this._events.sort(Event.compareStartTime);\n    const phases = Phase;\n    const stack = [];\n    /** @type {!Set<number>} */\n    const toDelete = new Set();\n    for (let i = 0; i < this._events.length; ++i) {\n      const e = this._events[i];\n      e.ordinal = i;\n      switch (e.phase) {\n        case phases.End: {\n          toDelete.add(i);  // Mark for removal.\n          // Quietly ignore unbalanced close events, they're legit (we could have missed start one).\n          if (!stack.length) {\n            continue;\n          }\n          const top = stack.pop();\n          if (!top) {\n            continue;\n          }\n          if (top.name !== e.name || top.categoriesString !== e.categoriesString) {\n            console.error(\n                'B/E events mismatch at ' + top.startTime + ' (' + top.name + ') vs. ' + e.startTime + ' (' + e.name +\n                ')');\n          } else {\n            top._complete(e);\n          }\n          break;\n        }\n        case phases.Begin: {\n          stack.push(e);\n          break;\n        }\n      }\n    }\n    while (stack.length) {\n      const event = stack.pop();\n      if (event) {\n        event.setEndTime(this._model.maximumRecordTime());\n      }\n    }\n    this._events = this._events.filter((_, idx) => !toDelete.has(idx));\n  }\n\n  /**\n   * @param {!EventPayload} payload\n   * @return {?Event} event\n   */\n  _addEvent(payload) {\n    const event = payload.ph === Phase.SnapshotObject ? ObjectSnapshot.fromPayload(payload, this) :\n                                                        Event.fromPayload(payload, this);\n    if (TracingModel.isTopLevelEvent(event)) {\n      // Discard nested \"top-level\" events.\n      const lastTopLevelEvent = this._lastTopLevelEvent;\n      if (lastTopLevelEvent && (lastTopLevelEvent.endTime || 0) > event.startTime) {\n        return null;\n      }\n      this._lastTopLevelEvent = event;\n    }\n    this._events.push(event);\n    return event;\n  }\n\n  /**\n   * @param {!AsyncEvent} asyncEvent\n   */\n  _addAsyncEvent(asyncEvent) {\n    this._asyncEvents.push(asyncEvent);\n  }\n\n  /**\n   * @override\n   * @param {string} name\n   */\n  _setName(name) {\n    super._setName(name);\n    this._process._setThreadByName(name, this);\n  }\n\n  /**\n   * @return {number}\n   */\n  id() {\n    return this._id;\n  }\n\n  /**\n   * @return {!Process}\n   */\n  process() {\n    return this._process;\n  }\n\n  /**\n   * @return {!Array<!Event>}\n   */\n  events() {\n    return this._events;\n  }\n\n  /**\n   * @return {!Array<!AsyncEvent>}\n   */\n  asyncEvents() {\n    return this._asyncEvents;\n  }\n\n  /**\n   * @param {string} name\n   */\n  removeEventsByName(name) {\n    /**\n     * @type {!Array<!Event>}\n     */\n    const extracted = [];\n    this._events = this._events.filter(e => {\n      if (!e) {\n        return false;\n      }\n\n      if (e.name !== name) {\n        return true;\n      }\n\n      extracted.push(e);\n      return false;\n    });\n\n    return extracted;\n  }\n}\n"]}