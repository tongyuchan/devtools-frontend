{"version":3,"file":"SameSiteCookieIssue.js","sourceRoot":"","sources":["../../../../../front_end/sdk/SameSiteCookieIssue.js"],"names":[],"mappings":"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","sourcesContent":["\n// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../common/common.js';\nimport {ls} from '../platform/platform.js';\n\nimport {FrameManager} from './FrameManager.js';\nimport {Issue, IssueCategory, IssueDescription, IssueKind, MarkdownIssueDescription} from './Issue.js';  // eslint-disable-line no-unused-vars\nimport {IssuesModel} from './IssuesModel.js';                                  // eslint-disable-line no-unused-vars\nimport {ResourceTreeFrame} from './ResourceTreeModel.js';                      // eslint-disable-line no-unused-vars\n\nexport class SameSiteCookieIssue extends Issue {\n  /**\n   * @param {string} code\n   * @param {!Protocol.Audits.SameSiteCookieIssueDetails} issueDetails\n   * @param {!IssuesModel} issuesModel\n   */\n  constructor(code, issueDetails, issuesModel) {\n    super(code, issuesModel);\n    this._issueDetails = issueDetails;\n  }\n\n  /**\n   * @override\n   */\n  primaryKey() {\n    const {domain, path, name} = this._issueDetails.cookie;\n    const cookieId = `${domain};${path};${name}`;\n    const requestId = this._issueDetails.request ? this._issueDetails.request.requestId : 'no-request';\n    return `${this.code()}-(${cookieId})-(${requestId})`;\n  }\n\n  /**\n   * Returns an array of issues from a given SameSiteCookieIssueDetails.\n   *\n   * @param {!Protocol.Audits.SameSiteCookieIssueDetails} sameSiteDetails\n   * @param {!IssuesModel} issuesModel\n   * @return {!Array<!Issue>}\n   */\n  static createIssuesFromSameSiteDetails(sameSiteDetails, issuesModel) {\n    /** @type {!Array<!Issue>} */\n    const issues = [];\n\n    // Exclusion reasons have priority. It means a cookie was blocked. Create an issue\n    // for every exclusion reason but ignore warning reasons if the cookie was blocked.\n    // Some exclusion reasons are dependent on warning reasons existing in order to produce an issue.\n    if (sameSiteDetails.cookieExclusionReasons && sameSiteDetails.cookieExclusionReasons.length > 0) {\n      for (const exclusionReason of sameSiteDetails.cookieExclusionReasons) {\n        const code = SameSiteCookieIssue.codeForSameSiteDetails(\n            exclusionReason, sameSiteDetails.cookieWarningReasons, sameSiteDetails.operation,\n            sameSiteDetails.cookieUrl);\n        if (code) {\n          issues.push(new SameSiteCookieIssue(code, sameSiteDetails, issuesModel));\n        }\n      }\n      return issues;\n    }\n\n    if (sameSiteDetails.cookieWarningReasons) {\n      for (const warningReason of sameSiteDetails.cookieWarningReasons) {\n        // warningReasons should be an empty array here.\n        const code = SameSiteCookieIssue.codeForSameSiteDetails(\n            warningReason, [], sameSiteDetails.operation, sameSiteDetails.cookieUrl);\n        if (code) {\n          issues.push(new SameSiteCookieIssue(code, sameSiteDetails, issuesModel));\n        }\n      }\n    }\n    return issues;\n  }\n\n  /**\n   * Calculates an issue code from a reason, an operation, and an array of warningReasons. All these together\n   * can uniquely identify a specific SameSite cookie issue.\n   * warningReasons is only needed for some SameSiteCookieExclusionReason in order to determine if an issue should be raised.\n   * It is not required if reason is a SameSiteCookieWarningReason.\n   *\n   * @param {!Protocol.Audits.SameSiteCookieExclusionReason|!Protocol.Audits.SameSiteCookieWarningReason} reason\n   * @param {!Array<!Protocol.Audits.SameSiteCookieWarningReason>} warningReasons\n   * @param {!Protocol.Audits.SameSiteCookieOperation} operation\n   * @param {string|undefined} cookieUrl\n   * @returns {?string}\n   */\n  static codeForSameSiteDetails(reason, warningReasons, operation, cookieUrl) {\n    const isURLSecure = cookieUrl && (cookieUrl.startsWith('https://') || cookieUrl.startsWith('wss://'));\n    const secure = isURLSecure ? 'Secure' : 'Insecure';\n\n    if (reason === Protocol.Audits.SameSiteCookieExclusionReason.ExcludeSameSiteStrict ||\n        reason === Protocol.Audits.SameSiteCookieExclusionReason.ExcludeSameSiteLax ||\n        reason === Protocol.Audits.SameSiteCookieExclusionReason.ExcludeSameSiteUnspecifiedTreatedAsLax) {\n      if (warningReasons && warningReasons.length > 0) {\n        if (warningReasons.includes(Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictLaxDowngradeStrict)) {\n          return [\n            Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, 'ExcludeNavigationContextDowngrade', secure\n          ].join('::');\n        }\n\n        if (warningReasons.includes(\n                Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictCrossDowngradeStrict) ||\n            warningReasons.includes(Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictCrossDowngradeLax) ||\n            warningReasons.includes(Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteLaxCrossDowngradeStrict) ||\n            warningReasons.includes(Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteLaxCrossDowngradeLax)) {\n          return [\n            Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, 'ExcludeContextDowngrade', operation, secure\n          ].join('::');\n        }\n      }\n\n      // If we have ExcludeSameSiteUnspecifiedTreatedAsLax but no corresponding warnings, then add just\n      // the Issue code for ExcludeSameSiteUnspecifiedTreatedAsLax.\n      if (reason === Protocol.Audits.SameSiteCookieExclusionReason.ExcludeSameSiteUnspecifiedTreatedAsLax) {\n        return [Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, reason, operation].join('::');\n      }\n\n      // ExcludeSameSiteStrict and ExcludeSameSiteLax require being paired with an appropriate warning. We didn't\n      // find one of those warnings so return null to indicate there shouldn't be an issue created.\n      return null;\n    }\n\n    if (reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictLaxDowngradeStrict) {\n      return [Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, reason, secure].join('::');\n    }\n    // These have the same message.\n    if (reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictCrossDowngradeStrict ||\n        reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictCrossDowngradeLax ||\n        reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteLaxCrossDowngradeLax ||\n        reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteLaxCrossDowngradeStrict) {\n      return [Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, 'WarnCrossDowngrade', operation, secure].join(\n          '::');\n    }\n    return [Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, reason, operation].join('::');\n  }\n\n  /**\n   * @override\n   * @returns {!Iterable<!Protocol.Audits.AffectedCookie>}\n   */\n  cookies() {\n    return [this._issueDetails.cookie];\n  }\n\n  /**\n   * @override\n   * @returns {!Iterable<!Protocol.Audits.AffectedRequest>}\n   */\n  requests() {\n    if (this._issueDetails.request) {\n      return [this._issueDetails.request];\n    }\n    return [];\n  }\n\n  /**\n   * @override\n   * @return {!IssueCategory}\n   */\n  getCategory() {\n    return IssueCategory.SameSiteCookie;\n  }\n\n  /**\n   * @override\n   * @returns {?MarkdownIssueDescription}\n   */\n  getDescription() {\n    const description = issueDescriptions.get(this.code());\n    if (!description) {\n      return null;\n    }\n    return description;\n  }\n\n  /**\n   * @override\n   * @return {boolean}\n   */\n  isCausedByThirdParty() {\n    const topFrame = FrameManager.instance().getTopFrame();\n    return isCausedByThirdParty(topFrame, this._issueDetails.cookieUrl);\n  }\n}\n\n/**\n * @param {?ResourceTreeFrame} topFrame\n * @param {(string|undefined)} cookieUrl\n * @return {boolean}\n *\n * Exported for unit test.\n */\nexport function isCausedByThirdParty(topFrame, cookieUrl) {\n  if (!topFrame) {\n    // The top frame is not yet available. Consider this issue as a third-party issue\n    // until the top frame is available. This will prevent the issue from being visible\n    // for only just a split second.\n    return true;\n  }\n\n  // In the case of no domain and registry, we assume its an IP address or localhost\n  // during development, in this case we classify the issue as first-party.\n  if (!cookieUrl || topFrame.domainAndRegistry() === '') {\n    return false;\n  }\n\n  const parsedCookieUrl = Common.ParsedURL.ParsedURL.fromString(cookieUrl);\n  if (!parsedCookieUrl) {\n    return false;\n  }\n\n  // For both operation types we compare the cookieUrl's domain  with the top frames\n  // registered domain to determine first-party vs third-party. If they don't match\n  // then we consider this issue a third-party issue.\n  //\n  // For a Set operation: The Set-Cookie response is part of a request to a third-party.\n  //\n  // For a Read operation: The cookie was included in a request to a third-party\n  //     site. Only cookies that have their domain also set to this third-party\n  //     are included in the request. We assume that the cookie was set by the same\n  //     third-party at some point, so we treat this as a third-party issue.\n  //\n  // TODO(crbug.com/1080589): Use \"First-Party sets\" instead of the sites registered domain.\n  return !IsSubdomainOf(parsedCookieUrl.domain(), topFrame.domainAndRegistry());\n}\n\n/**\n * @param {string} subdomain\n * @param {string} superdomain\n * @return {boolean}\n */\nfunction IsSubdomainOf(subdomain, superdomain) {\n  // Subdomain must be identical or have strictly more labels than the\n  // superdomain.\n  if (subdomain.length <= superdomain.length) {\n    return subdomain === superdomain;\n  }\n\n  // Superdomain must be suffix of subdomain, and the last character not\n  // included in the matching substring must be a dot.\n  if (!subdomain.endsWith(superdomain)) {\n    return false;\n  }\n\n  const subdomainWithoutSuperdomian = subdomain.substr(0, subdomain.length - superdomain.length);\n  return subdomainWithoutSuperdomian.endsWith('.');\n}\n\nconst sameSiteUnspecifiedErrorRead = {\n  file: 'issues/descriptions/SameSiteUnspecifiedTreatedAsLaxRead.md',\n  substitutions: undefined,\n  issueKind: IssueKind.BreakingChange,\n  links: [{link: 'https://web.dev/samesite-cookies-explained/', linkTitle: ls`SameSite cookies explained`}],\n};\n\nconst sameSiteUnspecifiedErrorSet = {\n  file: 'issues/descriptions/SameSiteUnspecifiedTreatedAsLaxSet.md',\n  substitutions: undefined,\n  issueKind: IssueKind.BreakingChange,\n  links: [{link: 'https://web.dev/samesite-cookies-explained/', linkTitle: ls`SameSite cookies explained`}],\n};\n\nconst sameSiteUnspecifiedWarnRead = {\n  file: 'issues/descriptions/SameSiteUnspecifiedLaxAllowUnsafeRead.md',\n  substitutions: undefined,\n  issueKind: IssueKind.BreakingChange,\n  links: [{link: 'https://web.dev/samesite-cookies-explained/', linkTitle: ls`SameSite cookies explained`}],\n};\n\nconst sameSiteUnspecifiedWarnSet = {\n  file: 'issues/descriptions/SameSiteUnspecifiedLaxAllowUnsafeSet.md',\n  substitutions: undefined,\n  issueKind: IssueKind.BreakingChange,\n  links: [{link: 'https://web.dev/samesite-cookies-explained/', linkTitle: ls`SameSite cookies explained`}],\n};\n\nconst sameSiteNoneInsecureErrorRead = {\n  file: 'issues/descriptions/SameSiteNoneInsecureErrorRead.md',\n  substitutions: undefined,\n  issueKind: IssueKind.BreakingChange,\n  links: [{link: 'https://web.dev/samesite-cookies-explained/', linkTitle: ls`SameSite cookies explained`}],\n};\n\nconst sameSiteNoneInsecureErrorSet = {\n  file: 'issues/descriptions/SameSiteNoneInsecureErrorSet.md',\n  substitutions: undefined,\n  issueKind: IssueKind.BreakingChange,\n  links: [{link: 'https://web.dev/samesite-cookies-explained/', linkTitle: ls`SameSite cookies explained`}],\n};\n\nconst sameSiteNoneInsecureWarnRead = {\n  file: 'issues/descriptions/SameSiteNoneInsecureWarnRead.md',\n  substitutions: undefined,\n  issueKind: IssueKind.BreakingChange,\n  links: [{link: 'https://web.dev/samesite-cookies-explained/', linkTitle: ls`SameSite cookies explained`}],\n};\n\nconst sameSiteNoneInsecureWarnSet = {\n  file: 'issues/descriptions/SameSiteNoneInsecureWarnSet.md',\n  substitutions: undefined,\n  issueKind: IssueKind.BreakingChange,\n  links: [{link: 'https://web.dev/samesite-cookies-explained/', linkTitle: ls`SameSite cookies explained`}],\n};\n\n/**\n * @type {!Array<!{link: string, linkTitle: string}>}\n */\nconst schemefulSameSiteArticles =\n    [{link: 'https://web.dev/schemeful-samesite/', linkTitle: ls`How Schemeful Same-Site Works`}];\n\n/**\n * @param {boolean} isSecure\n */\nfunction sameSiteWarnStrictLaxDowngradeStrict(isSecure) {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? ls`a secure` : ls`an insecure`],\n    ['PLACEHOLDER_origin', !isSecure ? ls`a secure` : ls`an insecure`],\n  ]);\n  return {\n    file: 'issues/descriptions/SameSiteWarnStrictLaxDowngradeStrict.md',\n    substitutions,\n    issueKind: IssueKind.BreakingChange,\n    links: schemefulSameSiteArticles,\n  };\n}\n\n/**\n * @param {boolean} isSecure\n */\nfunction sameSiteExcludeNavigationContextDowngrade(isSecure) {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? ls`a secure` : ls`an insecure`],\n    ['PLACEHOLDER_origin', !isSecure ? ls`a secure` : ls`an insecure`],\n  ]);\n  return {\n    file: 'issues/descriptions/SameSiteExcludeNavigationContextDowngrade.md',\n    substitutions,\n    issueKind: IssueKind.BreakingChange,\n    links: schemefulSameSiteArticles,\n  };\n}\n\n/**\n * @param {boolean} isSecure\n */\nfunction sameSiteWarnCrossDowngradeRead(isSecure) {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? ls`a secure` : ls`an insecure`],\n    ['PLACEHOLDER_origin', !isSecure ? ls`a secure` : ls`an insecure`],\n  ]);\n  return {\n    file: 'issues/descriptions/SameSiteWarnCrossDowngradeRead.md',\n    substitutions,\n    issueKind: IssueKind.BreakingChange,\n    links: schemefulSameSiteArticles,\n  };\n}\n\n/**\n * @param {boolean} isSecure\n */\nfunction sameSiteExcludeContextDowngradeRead(isSecure) {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? ls`a secure` : ls`an insecure`],\n    ['PLACEHOLDER_origin', !isSecure ? ls`a secure` : ls`an insecure`],\n  ]);\n  return {\n    file: 'issues/descriptions/SameSiteExcludeContextDowngradeRead.md',\n    substitutions,\n    issueKind: IssueKind.BreakingChange,\n    links: schemefulSameSiteArticles,\n  };\n}\n\n/**\n * @param {boolean} isSecure\n */\nfunction sameSiteWarnCrossDowngradeSet(isSecure) {\n  const substitutions = new Map([\n    ['PLACEHOLDER_ORIGIN', isSecure ? ls`a secure` : ls`an insecure`],\n    ['PLACEHOLDER_DESTINATION', !isSecure ? ls`a secure` : ls`an insecure`],\n  ]);\n  return {\n    file: 'issues/descriptions/SameSiteWarnCrossDowngradeSet.md',\n    substitutions,\n    issueKind: IssueKind.BreakingChange,\n    links: schemefulSameSiteArticles,\n  };\n}\n\n/**\n * @param {boolean} isSecure\n * @return {!MarkdownIssueDescription}\n */\nfunction sameSiteExcludeContextDowngradeSet(isSecure) {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? ls`a secure` : ls`an insecure`],\n    ['PLACEHOLDER_origin', !isSecure ? ls`a secure` : ls`an insecure`],\n  ]);\n  return {\n    file: 'issues/descriptions/SameSiteExcludeContextDowngradeSet.md',\n    substitutions,\n    issueKind: IssueKind.BreakingChange,\n    links: schemefulSameSiteArticles,\n  };\n}\n\n/** @type {!Map<string, !MarkdownIssueDescription>} */\nconst issueDescriptions = new Map([\n  ['SameSiteCookieIssue::ExcludeSameSiteUnspecifiedTreatedAsLax::ReadCookie', sameSiteUnspecifiedErrorRead],\n  ['SameSiteCookieIssue::ExcludeSameSiteUnspecifiedTreatedAsLax::SetCookie', sameSiteUnspecifiedErrorSet],\n  // These two don't have a deprecation date yet, but they need to be fixed eventually.\n  ['SameSiteCookieIssue::WarnSameSiteUnspecifiedLaxAllowUnsafe::ReadCookie', sameSiteUnspecifiedWarnRead],\n  ['SameSiteCookieIssue::WarnSameSiteUnspecifiedLaxAllowUnsafe::SetCookie', sameSiteUnspecifiedWarnSet],\n  ['SameSiteCookieIssue::WarnSameSiteUnspecifiedCrossSiteContext::ReadCookie', sameSiteUnspecifiedWarnRead],\n  ['SameSiteCookieIssue::WarnSameSiteUnspecifiedCrossSiteContext::SetCookie', sameSiteUnspecifiedWarnSet],\n  ['SameSiteCookieIssue::ExcludeSameSiteNoneInsecure::ReadCookie', sameSiteNoneInsecureErrorRead],\n  ['SameSiteCookieIssue::ExcludeSameSiteNoneInsecure::SetCookie', sameSiteNoneInsecureErrorSet],\n  ['SameSiteCookieIssue::WarnSameSiteNoneInsecure::ReadCookie', sameSiteNoneInsecureWarnRead],\n  ['SameSiteCookieIssue::WarnSameSiteNoneInsecure::SetCookie', sameSiteNoneInsecureWarnSet],\n  ['SameSiteCookieIssue::WarnSameSiteStrictLaxDowngradeStrict::Secure', sameSiteWarnStrictLaxDowngradeStrict(true)],\n  ['SameSiteCookieIssue::WarnSameSiteStrictLaxDowngradeStrict::Insecure', sameSiteWarnStrictLaxDowngradeStrict(false)],\n  ['SameSiteCookieIssue::WarnCrossDowngrade::ReadCookie::Secure', sameSiteWarnCrossDowngradeRead(true)],\n  ['SameSiteCookieIssue::WarnCrossDowngrade::ReadCookie::Insecure', sameSiteWarnCrossDowngradeRead(false)],\n  ['SameSiteCookieIssue::WarnCrossDowngrade::SetCookie::Secure', sameSiteWarnCrossDowngradeSet(true)],\n  ['SameSiteCookieIssue::WarnCrossDowngrade::SetCookie::Insecure', sameSiteWarnCrossDowngradeSet(false)],\n  ['SameSiteCookieIssue::ExcludeNavigationContextDowngrade::Secure', sameSiteExcludeNavigationContextDowngrade(true)],\n  [\n    'SameSiteCookieIssue::ExcludeNavigationContextDowngrade::Insecure', sameSiteExcludeNavigationContextDowngrade(false)\n  ],\n  ['SameSiteCookieIssue::ExcludeContextDowngrade::ReadCookie::Secure', sameSiteExcludeContextDowngradeRead(true)],\n  ['SameSiteCookieIssue::ExcludeContextDowngrade::ReadCookie::Insecure', sameSiteExcludeContextDowngradeRead(false)],\n  ['SameSiteCookieIssue::ExcludeContextDowngrade::SetCookie::Secure', sameSiteExcludeContextDowngradeSet(true)],\n  ['SameSiteCookieIssue::ExcludeContextDowngrade::SetCookie::Insecure', sameSiteExcludeContextDowngradeSet(false)],\n]);\n"]}