{"version":3,"file":"ChangesView.js","sourceRoot":"","sources":["../../../../../front_end/changes/ChangesView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2017 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/* eslint-disable rulesdir/no_underscored_properties */\nimport * as Common from '../common/common.js';\nimport * as Diff from '../diff/diff.js';\nimport * as i18n from '../i18n/i18n.js';\nimport * as UI from '../ui/ui.js';\nimport * as Workspace from '../workspace/workspace.js';  // eslint-disable-line no-unused-vars\nimport * as WorkspaceDiff from '../workspace_diff/workspace_diff.js';\n\nimport {ChangesSidebar, Events} from './ChangesSidebar.js';\nimport {ChangesTextEditor} from './ChangesTextEditor.js';\n\nexport const UIStrings = {\n  /**\n  *@description Screen-reader accessible name for the code editor in the Changes tool showing the user's changes.\n  */\n  changesDiffViewer: 'Changes diff viewer',\n  /**\n  *@description Screen reader/tooltip label for a button in the Changes tool that reverts all changes to the currently open file.\n  */\n  revertAllChangesToCurrentFile: 'Revert all changes to current file',\n  /**\n  *@description Text in Changes View of the Changes tab\n  */\n  noChanges: 'No changes',\n  /**\n  *@description Text in Changes View of the Changes tab\n  */\n  binaryData: 'Binary data',\n  /**\n  *@description Insertion text in Changes View of the Changes tab\n  *@example {1} PH1\n  */\n  sInsertion: '{PH1} insertion (+),',\n  /**\n  *@description Insertion text in Changes View of the Changes tab\n  *@example {2} PH1\n  */\n  sInsertions: '{PH1} insertions (+),',\n  /**\n  *@description Deletion text in Changes View of the Changes tab\n  *@example {1} PH1\n  */\n  sDeletion: '{PH1} deletion (-)',\n  /**\n  *@description Deletion text in Changes View of the Changes tab\n  *@example {2} PH1\n  */\n  sDeletions: '{PH1} deletions (-)',\n  /**\n  *@description Text in Changes View of the Changes tab\n  *@example {2} PH1\n  */\n  SkippingDMatchingLines: '( … Skipping {PH1} matching lines … )',\n};\nconst str_ = i18n.i18n.registerUIStrings('changes/ChangesView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nlet changesViewInstance: ChangesView;\n\nexport class ChangesView extends UI.Widget.VBox {\n  _emptyWidget: UI.EmptyWidget.EmptyWidget;\n  _workspaceDiff: WorkspaceDiff.WorkspaceDiff.WorkspaceDiffImpl;\n  _changesSidebar: ChangesSidebar;\n  _selectedUISourceCode: Workspace.UISourceCode.UISourceCode|null;\n  _diffRows: Row[];\n  _maxLineDigits: number;\n  _editor: ChangesTextEditor;\n  _toolbar: UI.Toolbar.Toolbar;\n  _diffStats: UI.Toolbar.ToolbarText;\n\n  private constructor() {\n    super(true);\n    this.registerRequiredCSS('changes/changesView.css', {enableLegacyPatching: true});\n    const splitWidget = new UI.SplitWidget.SplitWidget(true /* vertical */, false /* sidebar on left */);\n    const mainWidget = new UI.Widget.Widget();\n    splitWidget.setMainWidget(mainWidget);\n    splitWidget.show(this.contentElement);\n\n    this._emptyWidget = new UI.EmptyWidget.EmptyWidget('');\n    this._emptyWidget.show(mainWidget.element);\n\n    this._workspaceDiff = WorkspaceDiff.WorkspaceDiff.workspaceDiff();\n    this._changesSidebar = new ChangesSidebar(this._workspaceDiff);\n    this._changesSidebar.addEventListener(Events.SelectedUISourceCodeChanged, this._selectedUISourceCodeChanged, this);\n    splitWidget.setSidebarWidget(this._changesSidebar);\n\n    this._selectedUISourceCode = null;\n\n    this._diffRows = [];\n\n    this._maxLineDigits = 1;\n\n    this._editor = new ChangesTextEditor({\n      bracketMatchingSetting: undefined,\n      devtoolsAccessibleName: i18nString(UIStrings.changesDiffViewer),\n      lineNumbers: true,\n      lineWrapping: false,\n      mimeType: undefined,\n      autoHeight: undefined,\n      padBottom: undefined,\n      maxHighlightLength: Infinity,  // Avoid CodeMirror bailing out of highlighting big diffs.\n      placeholder: undefined,\n      lineWiseCopyCut: undefined,\n      inputStyle: undefined,\n    });\n    this._editor.setReadOnly(true);\n    const editorContainer = mainWidget.element.createChild('div', 'editor-container');\n    UI.ARIAUtils.markAsTabpanel(editorContainer);\n    this._editor.show(editorContainer);\n    this._editor.hideWidget();\n\n    self.onInvokeElement(this._editor.element, this._click.bind(this));\n\n    this._toolbar = new UI.Toolbar.Toolbar('changes-toolbar', mainWidget.element);\n    const revertButton =\n        new UI.Toolbar.ToolbarButton(i18nString(UIStrings.revertAllChangesToCurrentFile), 'largeicon-undo');\n    revertButton.addEventListener(UI.Toolbar.ToolbarButton.Events.Click, this._revert.bind(this));\n    this._toolbar.appendToolbarItem(revertButton);\n    this._diffStats = new UI.Toolbar.ToolbarText('');\n    this._toolbar.appendToolbarItem(this._diffStats);\n    this._toolbar.setEnabled(false);\n\n    this._hideDiff(i18nString(UIStrings.noChanges));\n    this._selectedUISourceCodeChanged();\n  }\n\n  static instance(opts: {forceNew: boolean|null;} = {forceNew: null}): ChangesView {\n    const {forceNew} = opts;\n    if (!changesViewInstance || forceNew) {\n      changesViewInstance = new ChangesView();\n    }\n\n    return changesViewInstance;\n  }\n\n  _selectedUISourceCodeChanged(): void {\n    this._revealUISourceCode(this._changesSidebar.selectedUISourceCode());\n  }\n\n  _revert(): void {\n    const uiSourceCode = this._selectedUISourceCode;\n    if (!uiSourceCode) {\n      return;\n    }\n    this._workspaceDiff.revertToOriginal(uiSourceCode);\n  }\n\n  _click(event: Event): void {\n    const selection = this._editor.selection();\n    if (!selection.isEmpty() || !this._selectedUISourceCode) {\n      return;\n    }\n    const row = this._diffRows[selection.startLine];\n    Common.Revealer.reveal(\n        this._selectedUISourceCode.uiLocation(row.currentLineNumber - 1, selection.startColumn), false);\n    event.consume(true);\n  }\n\n  _revealUISourceCode(uiSourceCode: Workspace.UISourceCode.UISourceCode|null): void {\n    if (this._selectedUISourceCode === uiSourceCode) {\n      return;\n    }\n\n    if (this._selectedUISourceCode) {\n      this._workspaceDiff.unsubscribeFromDiffChange(this._selectedUISourceCode, this._refreshDiff, this);\n    }\n    if (uiSourceCode && this.isShowing()) {\n      this._workspaceDiff.subscribeToDiffChange(uiSourceCode, this._refreshDiff, this);\n    }\n\n    this._selectedUISourceCode = uiSourceCode;\n    this._refreshDiff();\n  }\n\n  wasShown(): void {\n    this._refreshDiff();\n  }\n\n  _refreshDiff(): void {\n    if (!this.isShowing()) {\n      return;\n    }\n\n    if (!this._selectedUISourceCode) {\n      this._renderDiffRows(null);\n      return;\n    }\n    const uiSourceCode = this._selectedUISourceCode;\n    if (!uiSourceCode.contentType().isTextType()) {\n      this._hideDiff(i18nString(UIStrings.binaryData));\n      return;\n    }\n    this._workspaceDiff.requestDiff(uiSourceCode).then((diff: Diff.Diff.DiffArray|null): void => {\n      if (this._selectedUISourceCode !== uiSourceCode) {\n        return;\n      }\n      this._renderDiffRows(diff);\n    });\n  }\n\n  _hideDiff(message: string): void {\n    this._diffStats.setText('');\n    this._toolbar.setEnabled(false);\n    this._editor.hideWidget();\n    this._emptyWidget.text = message;\n    this._emptyWidget.showWidget();\n  }\n\n  _renderDiffRows(diff: Diff.Diff.DiffArray|null): void {\n    this._diffRows = [];\n\n    if (!diff || (diff.length === 1 && diff[0][0] === Diff.Diff.Operation.Equal)) {\n      this._hideDiff(i18nString(UIStrings.noChanges));\n      return;\n    }\n\n    let insertions = 0;\n    let deletions = 0;\n    let currentLineNumber = 0;\n    let baselineLineNumber = 0;\n    const paddingLines = 3;\n\n    const originalLines: string[] = [];\n    const currentLines: string[] = [];\n\n    for (let i = 0; i < diff.length; ++i) {\n      const token = diff[i];\n      switch (token[0]) {\n        case Diff.Diff.Operation.Equal:\n          this._diffRows.push(...createEqualRows(token[1], i === 0, i === diff.length - 1));\n          originalLines.push(...token[1]);\n          currentLines.push(...token[1]);\n          break;\n        case Diff.Diff.Operation.Insert:\n          for (const line of token[1]) {\n            this._diffRows.push(createRow(line, RowType.Addition));\n          }\n          insertions += token[1].length;\n          currentLines.push(...token[1]);\n          break;\n        case Diff.Diff.Operation.Delete:\n          deletions += token[1].length;\n          originalLines.push(...token[1]);\n          if (diff[i + 1] && diff[i + 1][0] === Diff.Diff.Operation.Insert) {\n            i++;\n            this._diffRows.push(...createModifyRows(token[1].join('\\n'), diff[i][1].join('\\n')));\n            insertions += diff[i][1].length;\n            currentLines.push(...diff[i][1]);\n          } else {\n            for (const line of token[1]) {\n              this._diffRows.push(createRow(line, RowType.Deletion));\n            }\n          }\n          break;\n      }\n    }\n\n    this._maxLineDigits = Math.ceil(Math.log10(Math.max(currentLineNumber, baselineLineNumber)));\n\n    let insertionText: Common.UIString.LocalizedString|'' = '';\n    if (insertions === 1) {\n      insertionText = i18nString(UIStrings.sInsertion, {PH1: insertions});\n    } else {\n      insertionText = i18nString(UIStrings.sInsertions, {PH1: insertions});\n    }\n\n    let deletionText: Common.UIString.LocalizedString|'' = '';\n    if (deletions === 1) {\n      deletionText = i18nString(UIStrings.sDeletion, {PH1: deletions});\n    } else {\n      deletionText = i18nString(UIStrings.sDeletions, {PH1: deletions});\n    }\n\n    this._diffStats.setText(`${insertionText} ${deletionText}`);\n    this._toolbar.setEnabled(true);\n    this._emptyWidget.hideWidget();\n\n    this._editor.operation((): void => {\n      this._editor.showWidget();\n      this._editor.setHighlightMode({\n        name: 'devtools-diff',\n        diffRows: this._diffRows,\n        mimeType: /** @type {!Workspace.UISourceCode.UISourceCode} */ (\n                      this._selectedUISourceCode as Workspace.UISourceCode.UISourceCode)\n                      .mimeType(),\n        baselineLines: originalLines,\n        currentLines: currentLines,\n      });\n      this._editor.setText(\n          this._diffRows\n              .map(\n                  (row: Row): string =>\n                      row.tokens.map((t: {text: string; className: string;}): string => t.text).join(''))\n              .join('\\n'));\n      this._editor.setLineNumberFormatter(this._lineFormatter.bind(this));\n      this._editor.updateDiffGutter(this._diffRows);\n    });\n\n    function createEqualRows(lines: string[], atStart: boolean, atEnd: boolean): Row[] {\n      const equalRows = [];\n      if (!atStart) {\n        for (let i = 0; i < paddingLines && i < lines.length; i++) {\n          equalRows.push(createRow(lines[i], RowType.Equal));\n        }\n        if (lines.length > paddingLines * 2 + 1 && !atEnd) {\n          equalRows.push(createRow(\n              i18nString(UIStrings.SkippingDMatchingLines, {PH1: (lines.length - paddingLines * 2)}), RowType.Spacer));\n        }\n      }\n      if (!atEnd) {\n        const start = Math.max(lines.length - paddingLines - 1, atStart ? 0 : paddingLines);\n        let skip = lines.length - paddingLines - 1;\n        if (!atStart) {\n          skip -= paddingLines;\n        }\n        if (skip > 0) {\n          baselineLineNumber += skip;\n          currentLineNumber += skip;\n        }\n\n        for (let i = start; i < lines.length; i++) {\n          equalRows.push(createRow(lines[i], RowType.Equal));\n        }\n      }\n      return equalRows;\n    }\n\n    function createModifyRows(before: string, after: string): Row[] {\n      const internalDiff = Diff.Diff.DiffWrapper.charDiff(before, after, true /* cleanup diff */);\n      const deletionRows = [createRow('', RowType.Deletion)];\n      const insertionRows = [createRow('', RowType.Addition)];\n\n      for (const token of internalDiff) {\n        const text = token[1];\n        const type = token[0];\n        const className = type === Diff.Diff.Operation.Equal ? '' : 'inner-diff';\n        const lines = text.split('\\n');\n        for (let i = 0; i < lines.length; i++) {\n          if (i > 0 && type !== Diff.Diff.Operation.Insert) {\n            deletionRows.push(createRow('', RowType.Deletion));\n          }\n          if (i > 0 && type !== Diff.Diff.Operation.Delete) {\n            insertionRows.push(createRow('', RowType.Addition));\n          }\n          if (!lines[i]) {\n            continue;\n          }\n          if (type !== Diff.Diff.Operation.Insert) {\n            deletionRows[deletionRows.length - 1].tokens.push({text: lines[i], className});\n          }\n          if (type !== Diff.Diff.Operation.Delete) {\n            insertionRows[insertionRows.length - 1].tokens.push({text: lines[i], className});\n          }\n        }\n      }\n      return deletionRows.concat(insertionRows);\n    }\n\n    function createRow(text: string, type: RowType): Row {\n      if (type === RowType.Addition) {\n        currentLineNumber++;\n      }\n      if (type === RowType.Deletion) {\n        baselineLineNumber++;\n      }\n      if (type === RowType.Equal) {\n        baselineLineNumber++;\n        currentLineNumber++;\n      }\n\n      return {baselineLineNumber, currentLineNumber, tokens: text ? [{text, className: 'inner-diff'}] : [], type};\n    }\n  }\n\n  _lineFormatter(lineNumber: number): string {\n    const row = this._diffRows[lineNumber - 1];\n    let showBaseNumber = row.type === RowType.Deletion;\n    let showCurrentNumber = row.type === RowType.Addition;\n    if (row.type === RowType.Equal) {\n      showBaseNumber = true;\n      showCurrentNumber = true;\n    }\n    const baseText = showBaseNumber ? String(row.baselineLineNumber) : '';\n    const base = baseText.padStart(this._maxLineDigits, '\\xA0');\n    const currentText = showCurrentNumber ? String(row.currentLineNumber) : '';\n    const current = currentText.padStart(this._maxLineDigits, '\\xA0');\n    return base + '\\xA0' + current;\n  }\n}\n\nexport const enum RowType {\n  Deletion = 'deletion',\n  Addition = 'addition',\n  Equal = 'equal',\n  Spacer = 'spacer'\n}\n\nexport class DiffUILocationRevealer implements Common.Revealer.Revealer {\n  async reveal(diffUILocation: Object, omitFocus?: boolean|undefined): Promise<void> {\n    if (!(diffUILocation instanceof WorkspaceDiff.WorkspaceDiff.DiffUILocation)) {\n      throw new Error('Internal error: not a diff ui location');\n    }\n    await UI.ViewManager.ViewManager.instance().showView('changes.changes');\n    ChangesView.instance()._changesSidebar.selectUISourceCode(diffUILocation.uiSourceCode, omitFocus);\n  }\n}\n\nexport interface Token {\n  text: string;\n  className: string;\n}\nexport interface Row {\n  baselineLineNumber: number;\n  currentLineNumber: number;\n  tokens: Token[];\n  type: RowType;\n}\n"]}