{"version":3,"file":"NetworkItemView.js","sourceRoot":"","sources":["../../../../../front_end/network/NetworkItemView.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2010 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as Common from '../common/common.js';\nimport {ls} from '../platform/platform.js';\nimport * as SDK from '../sdk/sdk.js';\nimport * as UI from '../ui/ui.js';\n\nimport {EventSourceMessagesView} from './EventSourceMessagesView.js';\nimport {NetworkTimeCalculator} from './NetworkTimeCalculator.js';  // eslint-disable-line no-unused-vars\nimport {RequestCookiesView} from './RequestCookiesView.js';\nimport {RequestHeadersView} from './RequestHeadersView.js';\nimport {RequestInitiatorView} from './RequestInitiatorView.js';\nimport {RequestPreviewView} from './RequestPreviewView.js';\nimport {RequestResponseView} from './RequestResponseView.js';\nimport {RequestTimingView} from './RequestTimingView.js';\nimport {RequestTrustTokensView, statusConsideredSuccess} from './RequestTrustTokensView.js';\nimport {ResourceWebSocketFrameView} from './ResourceWebSocketFrameView.js';\n\nexport class NetworkItemView extends UI.TabbedPane.TabbedPane {\n  /**\n   * @param {!SDK.NetworkRequest.NetworkRequest} request\n   * @param {!NetworkTimeCalculator} calculator\n   * @param {!Tabs=} initialTab If specified, will open `initalTab` when the view shows. Otherwise the tab that\n   *                            was last shown is opened. Note that specifying `initalTab` won't override the\n   *                            setting that stores the 'last opened tab' (similar to how revealers work).\n   */\n  constructor(request, calculator, initialTab) {\n    super();\n    this._request = request;\n    this.element.classList.add('network-item-view');\n\n    this._resourceViewTabSetting = Common.Settings.Settings.instance().createSetting('resourceViewTab', 'preview');\n\n    this._headersView = new RequestHeadersView(request);\n    this.appendTab(\n        Tabs.Headers, Common.UIString.UIString('Headers'), this._headersView,\n        Common.UIString.UIString('Headers and request body'));\n\n    this.addEventListener(UI.TabbedPane.Events.TabSelected, this._tabSelected, this);\n\n    if (request.resourceType() === Common.ResourceType.resourceTypes.WebSocket) {\n      const frameView = new ResourceWebSocketFrameView(request);\n      this.appendTab(\n          Tabs.WsFrames, Common.UIString.UIString('Messages'), frameView,\n          Common.UIString.UIString('WebSocket messages'));\n    } else if (request.mimeType === 'text/event-stream') {\n      this.appendTab(Tabs.EventSource, Common.UIString.UIString('EventStream'), new EventSourceMessagesView(request));\n    } else {\n      this._responseView = new RequestResponseView(request);\n      const previewView = new RequestPreviewView(request);\n      this.appendTab(\n          Tabs.Preview, Common.UIString.UIString('Preview'), previewView, Common.UIString.UIString('Response preview'));\n      const signedExchangeInfo = request.signedExchangeInfo();\n      if (signedExchangeInfo && signedExchangeInfo.errors && signedExchangeInfo.errors.length) {\n        const icon = UI.Icon.Icon.create('smallicon-error');\n        UI.Tooltip.Tooltip.install(icon, Common.UIString.UIString('SignedExchange error'));\n        this.setTabIcon(Tabs.Preview, icon);\n      }\n      this.appendTab(\n          Tabs.Response, Common.UIString.UIString('Response'), this._responseView,\n          Common.UIString.UIString('Raw response data'));\n    }\n\n    this.appendTab(Tabs.Initiator, ls`Initiator`, new RequestInitiatorView(request), ls`Request initiator call stack`);\n\n    this.appendTab(\n        Tabs.Timing, Common.UIString.UIString('Timing'), new RequestTimingView(request, calculator),\n        Common.UIString.UIString('Request and response timeline'));\n\n    if (request.trustTokenParams()) {\n      this.appendTab(\n          Tabs.TrustTokens, ls`Trust Tokens`, new RequestTrustTokensView(request), ls`Trust Token operation details`);\n    }\n\n    /** @type {?RequestCookiesView} */\n    this._cookiesView = null;\n\n    /** @type {!Tabs} */\n    this._initialTab = initialTab || this._resourceViewTabSetting.get();\n  }\n\n  /**\n   * @override\n   */\n  wasShown() {\n    super.wasShown();\n    this._request.addEventListener(\n        SDK.NetworkRequest.Events.RequestHeadersChanged, this._maybeAppendCookiesPanel, this);\n    this._request.addEventListener(\n        SDK.NetworkRequest.Events.ResponseHeadersChanged, this._maybeAppendCookiesPanel, this);\n    this._request.addEventListener(\n        SDK.NetworkRequest.Events.TrustTokenResultAdded, this._maybeShowErrorIconInTrustTokenTabHeader, this);\n    this._maybeAppendCookiesPanel();\n    this._maybeShowErrorIconInTrustTokenTabHeader();\n    this._selectTab(this._initialTab);\n  }\n\n  /**\n   * @override\n   */\n  willHide() {\n    this._request.removeEventListener(\n        SDK.NetworkRequest.Events.RequestHeadersChanged, this._maybeAppendCookiesPanel, this);\n    this._request.removeEventListener(\n        SDK.NetworkRequest.Events.ResponseHeadersChanged, this._maybeAppendCookiesPanel, this);\n    this._request.removeEventListener(\n        SDK.NetworkRequest.Events.TrustTokenResultAdded, this._maybeShowErrorIconInTrustTokenTabHeader, this);\n  }\n\n  _maybeAppendCookiesPanel() {\n    const cookiesPresent = this._request.hasRequestCookies() || this._request.responseCookies.length > 0;\n    console.assert(cookiesPresent || !this._cookiesView, 'Cookies were introduced in headers and then removed!');\n    if (cookiesPresent && !this._cookiesView) {\n      this._cookiesView = new RequestCookiesView(this._request);\n      this.appendTab(\n          Tabs.Cookies, Common.UIString.UIString('Cookies'), this._cookiesView,\n          Common.UIString.UIString('Request and response cookies'));\n    }\n  }\n\n  _maybeShowErrorIconInTrustTokenTabHeader() {\n    const trustTokenResult = this._request.trustTokenOperationDoneEvent();\n    if (trustTokenResult && !statusConsideredSuccess(trustTokenResult.status)) {\n      this.setTabIcon(Tabs.TrustTokens, UI.Icon.Icon.create('smallicon-error'));\n    }\n  }\n\n  /**\n   * @param {string} tabId\n   */\n  _selectTab(tabId) {\n    if (!this.selectTab(tabId)) {\n      this.selectTab('headers');\n    }\n  }\n\n  /** @param {!{data: *}} event */\n  _tabSelected(event) {\n    if (!event.data.isUserGesture) {\n      return;\n    }\n    this._resourceViewTabSetting.set(event.data.tabId);\n  }\n\n  /**\n   * @return {!SDK.NetworkRequest.NetworkRequest}\n   */\n  request() {\n    return this._request;\n  }\n\n  /**\n   * @param {number=} line\n   * @return {!Promise<void>}\n   */\n  async revealResponseBody(line) {\n    this._selectTab(Tabs.Response);\n    if (this._responseView && typeof line === 'number') {\n      await this._responseView.revealLine(/** @type {number} */ (line));\n    }\n  }\n\n  /**\n   * @param {string} header\n   */\n  revealRequestHeader(header) {\n    this._selectTab(Tabs.Headers);\n    this._headersView.revealRequestHeader(header);\n  }\n\n  /**\n   * @param {string} header\n   */\n  revealResponseHeader(header) {\n    this._selectTab(Tabs.Headers);\n    this._headersView.revealResponseHeader(header);\n  }\n}\n\n/**\n * @enum {string}\n */\nexport const Tabs = {\n  Cookies: 'cookies',\n  EventSource: 'eventSource',\n  Headers: 'headers',\n  Initiator: 'initiator',\n  Preview: 'preview',\n  Response: 'response',\n  Timing: 'timing',\n  TrustTokens: 'trustTokens',\n  WsFrames: 'webSocketFrames'\n};\n"]}