{"version":3,"file":"NetworkManageCustomHeadersView.js","sourceRoot":"","sources":["../../../../../front_end/network/NetworkManageCustomHeadersView.js"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../common/common.js';\nimport * as UI from '../ui/ui.js';\n\n/**\n * @implements {UI.ListWidget.Delegate<!{header: string}>}\n */\nexport class NetworkManageCustomHeadersView extends UI.Widget.VBox {\n  /**\n   * @param {!Array.<!{title: string, editable: boolean}>} columnData\n   * @param {function(string) : boolean} addHeaderColumnCallback\n   * @param {function(string, string) : boolean} changeHeaderColumnCallback\n   * @param {function(string) : boolean} removeHeaderColumnCallback\n   */\n  constructor(columnData, addHeaderColumnCallback, changeHeaderColumnCallback, removeHeaderColumnCallback) {\n    super(true);\n    this.registerRequiredCSS('network/networkManageCustomHeadersView.css', {enableLegacyPatching: false});\n\n    this.contentElement.classList.add('custom-headers-wrapper');\n    this.contentElement.createChild('div', 'header').textContent = Common.UIString.UIString('Manage Header Columns');\n\n    /** @type {!UI.ListWidget.ListWidget<!{header: string}>} */\n    this._list = new UI.ListWidget.ListWidget(this);\n    this._list.element.classList.add('custom-headers-list');\n    this._list.registerRequiredCSS('network/networkManageCustomHeadersView.css', {enableLegacyPatching: false});\n\n    const placeholder = document.createElement('div');\n    placeholder.classList.add('custom-headers-list-list-empty');\n    placeholder.textContent = Common.UIString.UIString('No custom headers');\n    this._list.setEmptyPlaceholder(placeholder);\n    this._list.show(this.contentElement);\n    this.contentElement.appendChild(UI.UIUtils.createTextButton(\n        Common.UIString.UIString('Add custom headerâ€¦'), this._addButtonClicked.bind(this), 'add-button'));\n\n    /** @type {!Map.<string, !{title: string, editable: boolean}>} */\n    this._columnConfigs = new Map();\n    columnData.forEach(columnData => this._columnConfigs.set(columnData.title.toLowerCase(), columnData));\n\n    this._addHeaderColumnCallback = addHeaderColumnCallback;\n    this._changeHeaderColumnCallback = changeHeaderColumnCallback;\n    this._removeHeaderColumnCallback = removeHeaderColumnCallback;\n\n    this.contentElement.tabIndex = 0;\n  }\n\n  /**\n   * @override\n   */\n  wasShown() {\n    this._headersUpdated();\n  }\n\n  _headersUpdated() {\n    this._list.clear();\n    this._columnConfigs.forEach(headerData => this._list.appendItem({header: headerData.title}, headerData.editable));\n  }\n\n  _addButtonClicked() {\n    this._list.addNewItem(this._columnConfigs.size, {header: ''});\n  }\n\n  /**\n   * @override\n   * @param {!{header:string}} item\n   * @param {boolean} editable\n   * @return {!Element}\n   */\n  renderItem(item, editable) {\n    const element = document.createElement('div');\n    element.classList.add('custom-headers-list-item');\n    const header = element.createChild('div', 'custom-header-name');\n    header.textContent = item.header;\n    UI.Tooltip.Tooltip.install(header, item.header);\n    return element;\n  }\n\n  /**\n   * @override\n   * @param {!{header:string}} item\n   * @param {number} index\n   */\n  removeItemRequested(item, index) {\n    this._removeHeaderColumnCallback(item.header);\n    this._columnConfigs.delete(item.header.toLowerCase());\n    this._headersUpdated();\n  }\n\n  /**\n   * @override\n   * @param {!{header:string}} item\n   * @param {!UI.ListWidget.Editor<?>} editor\n   * @param {boolean} isNew\n   */\n  commitEdit(item, editor, isNew) {\n    const headerId = editor.control('header').value.trim();\n    let success;\n    if (isNew) {\n      success = this._addHeaderColumnCallback(headerId);\n    } else {\n      success = this._changeHeaderColumnCallback(item.header, headerId);\n    }\n\n    if (success && !isNew) {\n      this._columnConfigs.delete(item.header.toLowerCase());\n    }\n    if (success) {\n      this._columnConfigs.set(headerId.toLowerCase(), {title: headerId, editable: true});\n    }\n\n    this._headersUpdated();\n  }\n\n  /**\n   * @override\n   * @param {!{header:string}} item\n   * @return {!UI.ListWidget.Editor<?>}\n   */\n  beginEdit(item) {\n    const editor = this._createEditor();\n    editor.control('header').value = item.header;\n    return editor;\n  }\n\n  /**\n   * @return {!UI.ListWidget.Editor<?>}\n   */\n  _createEditor() {\n    if (this._editor) {\n      return this._editor;\n    }\n\n    const editor = new UI.ListWidget.Editor();\n    this._editor = editor;\n    const content = editor.contentElement();\n\n    const titles = content.createChild('div', 'custom-headers-edit-row');\n    titles.createChild('div', 'custom-headers-header').textContent = Common.UIString.UIString('Header Name');\n\n    const fields = content.createChild('div', 'custom-headers-edit-row');\n    fields.createChild('div', 'custom-headers-header')\n        .appendChild(editor.createInput('header', 'text', 'x-custom-header', validateHeader.bind(this)));\n\n    return editor;\n\n    /**\n     * @param {!{header:string}} item\n     * @param {number} index\n     * @param {!HTMLInputElement|!HTMLSelectElement} input\n     * @this {NetworkManageCustomHeadersView}\n     * @return {!UI.ListWidget.ValidatorResult}\n     */\n    function validateHeader(item, index, input) {\n      let valid = true;\n      const headerId = editor.control('header').value.trim().toLowerCase();\n      if (this._columnConfigs.has(headerId) && item.header !== headerId) {\n        valid = false;\n      }\n      return {valid, errorMessage: undefined};\n    }\n  }\n}\n"]}