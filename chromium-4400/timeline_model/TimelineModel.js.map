{"version":3,"file":"TimelineModel.js","sourceRoot":"","sources":["../../../../../front_end/timeline_model/TimelineModel.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2012 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as Common from '../common/common.js';\nimport * as Platform from '../platform/platform.js';\nimport {ls} from '../platform/platform.js';\nimport * as Root from '../root/root.js';\nimport * as SDK from '../sdk/sdk.js';\n\nimport {TimelineJSProfileProcessor} from './TimelineJSProfile.js';\n\nexport class TimelineModelImpl {\n  constructor() {\n    // The following fields are set by a call to _reset().\n    /** @type {boolean} */\n    this._isGenericTrace;\n    /** @type {!Array<!Track>} */\n    this._tracks;\n    /** @type {!Map<!TrackType, !Track>} */\n    this._namedTracks;\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    this._inspectedTargetEvents;\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    this._timeMarkerEvents;\n    /** @type {?string} */\n    this._sessionId;\n    /** @type {?number} */\n    this._mainFrameNodeId;\n    /** @type {!Map<string, !PageFrame>} */\n    this._pageFrames;\n    /** @type {!Array<!SDK.CPUProfileDataModel.CPUProfileDataModel>} */\n    this._cpuProfiles;\n    /** @type WeakMap<SDK.TracingModel.Thread, string> */\n    this._workerIdByThread;\n    /** @type {!Map<string, !SDK.TracingModel.Event>} */\n    this._requestsFromBrowser;\n    /** @type {!PageFrame} */\n    this._mainFrame;\n\n    this._minimumRecordTime = 0;\n    this._maximumRecordTime = 0;\n    this._totalBlockingTime = 0;\n    this._estimatedTotalBlockingTime = 0;\n\n    // The following are set by a call to resetProcessingState().\n    /** @type {!TimelineAsyncEventTracker} */\n    this._asyncEventTracker;\n    /** @type {!InvalidationTracker} */\n    this._invalidationTracker;\n    /** @type {!Object.<string, ?SDK.TracingModel.Event>} */\n    this._layoutInvalidate;\n    /** @type {!Object.<string, !SDK.TracingModel.Event>} */\n    this._lastScheduleStyleRecalculation;\n    /** @type {!Object.<string, !SDK.TracingModel.Event>} */\n    this._paintImageEventByPixelRefId;\n    /** @type {!Object.<string, !SDK.TracingModel.Event>} */\n    this._lastPaintForLayer;\n    /** @type {?SDK.TracingModel.Event} */\n    this._lastRecalculateStylesEvent;\n    /** @type {?SDK.TracingModel.Event} */\n    this._currentScriptEvent;\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    this._eventStack;\n    /** @type {!Set<string>} */\n    this._knownInputEvents;\n    /** @type {boolean} */\n    this._browserFrameTracking;\n    /** @type {boolean} */\n    this._persistentIds;\n    /** @type {*} */\n    this._legacyCurrentPage;\n\n    this._reset();\n    this._resetProcessingState();\n\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    this._currentTaskLayoutAndRecalcEvents = [];\n    /** @type {?SDK.TracingModel.TracingModel} */\n    this._tracingModel = null;\n  }\n\n  /**\n   * @param {!Array<!SDK.TracingModel.Event>} events\n   * @param {function(!SDK.TracingModel.Event): void} onStartEvent\n   * @param {function(!SDK.TracingModel.Event): void} onEndEvent\n   * @param {function(!SDK.TracingModel.Event,?SDK.TracingModel.Event)|undefined=} onInstantEvent\n   * @param {number=} startTime\n   * @param {number=} endTime\n   * @param {function(!SDK.TracingModel.Event):boolean=} filter\n   */\n  static forEachEvent(events, onStartEvent, onEndEvent, onInstantEvent, startTime, endTime, filter) {\n    startTime = startTime || 0;\n    endTime = endTime || Infinity;\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    const stack = [];\n    const startEvent = TimelineModelImpl._topLevelEventEndingAfter(events, startTime);\n    for (let i = startEvent; i < events.length; ++i) {\n      const e = events[i];\n      if ((e.endTime || e.startTime) < startTime) {\n        continue;\n      }\n      if (e.startTime >= endTime) {\n        break;\n      }\n      if (SDK.TracingModel.TracingModel.isAsyncPhase(e.phase) || SDK.TracingModel.TracingModel.isFlowPhase(e.phase)) {\n        continue;\n      }\n      let last = stack[stack.length - 1];\n      while (last && last.endTime !== undefined && last.endTime <= e.startTime) {\n        stack.pop();\n        onEndEvent(last);\n        last = stack[stack.length - 1];\n      }\n      if (filter && !filter(e)) {\n        continue;\n      }\n      if (e.duration) {\n        onStartEvent(e);\n        stack.push(e);\n      } else {\n        onInstantEvent && onInstantEvent(e, stack[stack.length - 1] || null);\n      }\n    }\n    while (stack.length) {\n      const last = stack.pop();\n      if (last) {\n        onEndEvent(last);\n      }\n    }\n  }\n\n  /**\n   * @param {!Array<!SDK.TracingModel.Event>} events\n   * @param {number} time\n   */\n  static _topLevelEventEndingAfter(events, time) {\n    let index = Platform.ArrayUtilities.upperBound(events, time, (time, event) => time - event.startTime) - 1;\n    while (index > 0 && !SDK.TracingModel.TracingModel.isTopLevelEvent(events[index])) {\n      index--;\n    }\n    return Math.max(index, 0);\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isMarkerEvent(event) {\n    const recordTypes = RecordType;\n    switch (event.name) {\n      case recordTypes.TimeStamp:\n        return true;\n      case recordTypes.MarkFirstPaint:\n      case recordTypes.MarkFCP:\n        return Boolean(this._mainFrame) && event.args.frame === this._mainFrame.frameId && Boolean(event.args.data);\n      case recordTypes.MarkDOMContent:\n      case recordTypes.MarkLoad:\n      case recordTypes.MarkLCPCandidate:\n      case recordTypes.MarkLCPInvalidate:\n        return Boolean(event.args['data']['isMainFrame']);\n      default:\n        return false;\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isInteractiveTimeEvent(event) {\n    return event.name === RecordType.InteractiveTime;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isLayoutShiftEvent(event) {\n    return event.name === RecordType.LayoutShift;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isUserTimingEvent(event) {\n    return event.categoriesString === TimelineModelImpl.Category.UserTiming;\n  }\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isParseHTMLEvent(event) {\n    return event.name === RecordType.ParseHTML;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isLCPCandidateEvent(event) {\n    return event.name === RecordType.MarkLCPCandidate && Boolean(event.args['data']['isMainFrame']);\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isLCPInvalidateEvent(event) {\n    return event.name === RecordType.MarkLCPInvalidate && Boolean(event.args['data']['isMainFrame']);\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isFCPEvent(event) {\n    return event.name === RecordType.MarkFCP && Boolean(this._mainFrame) &&\n        event.args['frame'] === this._mainFrame.frameId;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isLongRunningTask(event) {\n    return event.name === RecordType.Task &&\n        TimelineData.forEvent(event).warning === TimelineModelImpl.WarningType.LongTask;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isNavigationStartEvent(event) {\n    return event.name === RecordType.NavigationStart;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  isMainFrameNavigationStartEvent(event) {\n    return this.isNavigationStartEvent(event) && event.args['data']['isLoadingMainFrame'] &&\n        event.args['data']['documentLoaderURL'];\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @param {string} field\n   * @return {string}\n   */\n  static globalEventId(event, field) {\n    const data = event.args['data'] || event.args['beginData'];\n    const id = data && data[field];\n    if (!id) {\n      return '';\n    }\n    return `${event.thread.process().id()}.${id}`;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {string}\n   */\n  static eventFrameId(event) {\n    const data = event.args['data'] || event.args['beginData'];\n    return data && data['frame'] || '';\n  }\n\n  /**\n   * @return {!Array<!SDK.CPUProfileDataModel.CPUProfileDataModel>}\n   */\n  cpuProfiles() {\n    return this._cpuProfiles;\n  }\n\n  /**\n   * @return {{time: number, estimated: boolean}}\n   */\n  totalBlockingTime() {\n    if (this._totalBlockingTime === -1) {\n      return {time: this._estimatedTotalBlockingTime, estimated: true};\n    }\n\n    return {time: this._totalBlockingTime, estimated: false};\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {?SDK.SDKModel.Target}\n   */\n  targetByEvent(event) {\n    // FIXME: Consider returning null for loaded traces.\n    const workerId = this._workerIdByThread.get(event.thread);\n    const mainTarget = SDK.SDKModel.TargetManager.instance().mainTarget();\n    return workerId ? SDK.SDKModel.TargetManager.instance().targetById(workerId) : mainTarget;\n  }\n\n  /**\n   * @return {!Map<string, !SDK.TracingModel.Event>}\n   */\n  navStartTimes() {\n    if (!this._tracingModel) {\n      return new Map();\n    }\n\n    return this._tracingModel.navStartTimes();\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   */\n  setEvents(tracingModel) {\n    this._reset();\n    this._resetProcessingState();\n    this._tracingModel = tracingModel;\n\n    this._minimumRecordTime = tracingModel.minimumRecordTime();\n    this._maximumRecordTime = tracingModel.maximumRecordTime();\n\n    // Remove LayoutShift events from the main thread list of events because they are\n    // represented in the experience track. This is done prior to the main thread being processed for its own events.\n    const layoutShiftEvents = [];\n    for (const process of tracingModel.sortedProcesses()) {\n      if (process.name() !== 'Renderer') {\n        continue;\n      }\n\n      for (const thread of process.sortedThreads()) {\n        const shifts = thread.removeEventsByName(RecordType.LayoutShift);\n        layoutShiftEvents.push(...shifts);\n      }\n    }\n\n    this._processSyncBrowserEvents(tracingModel);\n    if (this._browserFrameTracking) {\n      this._processThreadsForBrowserFrames(tracingModel);\n    } else {\n      // The next line is for loading legacy traces recorded before M67.\n      // TODO(alph): Drop the support at some point.\n      const metadataEvents = this._processMetadataEvents(tracingModel);\n      this._isGenericTrace = !metadataEvents;\n      if (metadataEvents) {\n        this._processMetadataAndThreads(tracingModel, metadataEvents);\n      } else {\n        this._processGenericTrace(tracingModel);\n      }\n    }\n    this._inspectedTargetEvents.sort(SDK.TracingModel.Event.compareStartTime);\n    this._processAsyncBrowserEvents(tracingModel);\n    this._buildGPUEvents(tracingModel);\n    this._buildLoadingEvents(tracingModel, layoutShiftEvents);\n    this._resetProcessingState();\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   */\n  _processGenericTrace(tracingModel) {\n    let browserMainThread = SDK.TracingModel.TracingModel.browserMainThread(tracingModel);\n    if (!browserMainThread && tracingModel.sortedProcesses().length) {\n      browserMainThread = tracingModel.sortedProcesses()[0].sortedThreads()[0];\n    }\n    for (const process of tracingModel.sortedProcesses()) {\n      for (const thread of process.sortedThreads()) {\n        this._processThreadEvents(\n            tracingModel, [{from: 0, to: Infinity}], thread, thread === browserMainThread, false, true, null);\n      }\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   * @param {!MetadataEvents} metadataEvents\n   */\n  _processMetadataAndThreads(tracingModel, metadataEvents) {\n    let startTime = 0;\n    for (let i = 0, length = metadataEvents.page.length; i < length; i++) {\n      const metaEvent = metadataEvents.page[i];\n      const process = metaEvent.thread.process();\n      const endTime = i + 1 < length ? metadataEvents.page[i + 1].startTime : Infinity;\n      if (startTime === endTime) {\n        continue;\n      }\n      this._legacyCurrentPage = metaEvent.args['data'] && metaEvent.args['data']['page'];\n      for (const thread of process.sortedThreads()) {\n        let workerUrl = null;\n        if (thread.name() === TimelineModelImpl.WorkerThreadName ||\n            thread.name() === TimelineModelImpl.WorkerThreadNameLegacy) {\n          const workerMetaEvent = metadataEvents.workers.find(e => {\n            if (e.args['data']['workerThreadId'] !== thread.id()) {\n              return false;\n            }\n            // This is to support old traces.\n            if (e.args['data']['sessionId'] === this._sessionId) {\n              return true;\n            }\n            return Boolean(this._pageFrames.get(TimelineModelImpl.eventFrameId(e)));\n          });\n          if (!workerMetaEvent) {\n            continue;\n          }\n          const workerId = workerMetaEvent.args['data']['workerId'];\n          if (workerId) {\n            this._workerIdByThread.set(thread, workerId);\n          }\n          workerUrl = workerMetaEvent.args['data']['url'] || '';\n        }\n        this._processThreadEvents(\n            tracingModel, [{from: startTime, to: endTime}], thread, thread === metaEvent.thread, Boolean(workerUrl),\n            true, workerUrl);\n      }\n      startTime = endTime;\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   */\n  _processThreadsForBrowserFrames(tracingModel) {\n    /** @type {!Map<number, !Array<{from: number, to: number, main: boolean, url: string}>>} */\n    const processData = new Map();\n    for (const frame of this._pageFrames.values()) {\n      for (let i = 0; i < frame.processes.length; i++) {\n        const pid = frame.processes[i].processId;\n        let data = processData.get(pid);\n        if (!data) {\n          data = [];\n          processData.set(pid, data);\n        }\n        const to = i === frame.processes.length - 1 ? (frame.deletedTime || Infinity) : frame.processes[i + 1].time;\n        data.push({from: frame.processes[i].time, to: to, main: !frame.parent, url: frame.processes[i].url});\n      }\n    }\n    const allMetadataEvents = tracingModel.devToolsMetadataEvents();\n    for (const process of tracingModel.sortedProcesses()) {\n      const data = processData.get(process.id());\n      if (!data) {\n        continue;\n      }\n      data.sort((a, b) => a.from - b.from || a.to - b.to);\n      const ranges = [];\n      let lastUrl = null;\n      let lastMainUrl = null;\n      let hasMain = false;\n      for (const item of data) {\n        const last = ranges[ranges.length - 1];\n        if (!last || item.from > last.to) {\n          ranges.push({from: item.from, to: item.to});\n        } else {\n          last.to = item.to;\n        }\n        if (item.main) {\n          hasMain = true;\n        }\n        if (item.url) {\n          if (item.main) {\n            lastMainUrl = item.url;\n          }\n          lastUrl = item.url;\n        }\n      }\n\n      for (const thread of process.sortedThreads()) {\n        if (thread.name() === TimelineModelImpl.RendererMainThreadName) {\n          this._processThreadEvents(\n              tracingModel, ranges, thread, true /* isMainThread */, false /* isWorker */, hasMain,\n              hasMain ? lastMainUrl : lastUrl);\n        } else if (\n            thread.name() === TimelineModelImpl.WorkerThreadName ||\n            thread.name() === TimelineModelImpl.WorkerThreadNameLegacy) {\n          const workerMetaEvent = allMetadataEvents.find(e => {\n            if (e.name !== TimelineModelImpl.DevToolsMetadataEvent.TracingSessionIdForWorker) {\n              return false;\n            }\n            if (e.thread.process() !== process) {\n              return false;\n            }\n            if (e.args['data']['workerThreadId'] !== thread.id()) {\n              return false;\n            }\n            return Boolean(this._pageFrames.get(TimelineModelImpl.eventFrameId(e)));\n          });\n          if (!workerMetaEvent) {\n            continue;\n          }\n          this._workerIdByThread.set(thread, workerMetaEvent.args['data']['workerId'] || '');\n          this._processThreadEvents(\n              tracingModel, ranges, thread, false /* isMainThread */, true /* isWorker */, false /* forMainFrame */,\n              workerMetaEvent.args['data']['url'] || '');\n        } else {\n          this._processThreadEvents(\n              tracingModel, ranges, thread, false /* isMainThread */, false /* isWorker */, false /* forMainFrame */,\n              null);\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   * @return {?MetadataEvents}\n   */\n  _processMetadataEvents(tracingModel) {\n    const metadataEvents = tracingModel.devToolsMetadataEvents();\n\n    const pageDevToolsMetadataEvents = [];\n    const workersDevToolsMetadataEvents = [];\n    for (const event of metadataEvents) {\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.TracingStartedInPage) {\n        pageDevToolsMetadataEvents.push(event);\n        if (event.args['data'] && event.args['data']['persistentIds']) {\n          this._persistentIds = true;\n        }\n        /** @type {!Array<!PageFrame>} */\n        const frames = ((event.args['data'] && event.args['data']['frames']) || []);\n        frames.forEach(payload => this._addPageFrame(event, payload));\n        this._mainFrame = this.rootFrames()[0];\n      } else if (event.name === TimelineModelImpl.DevToolsMetadataEvent.TracingSessionIdForWorker) {\n        workersDevToolsMetadataEvents.push(event);\n      } else if (event.name === TimelineModelImpl.DevToolsMetadataEvent.TracingStartedInBrowser) {\n        console.assert(!this._mainFrameNodeId, 'Multiple sessions in trace');\n        this._mainFrameNodeId = event.args['frameTreeNodeId'];\n      }\n    }\n    if (!pageDevToolsMetadataEvents.length) {\n      return null;\n    }\n\n    const sessionId =\n        pageDevToolsMetadataEvents[0].args['sessionId'] || pageDevToolsMetadataEvents[0].args['data']['sessionId'];\n    this._sessionId = sessionId;\n\n    const mismatchingIds = new Set();\n    /**\n     * @param {!SDK.TracingModel.Event} event\n     * @return {boolean}\n     */\n    function checkSessionId(event) {\n      let args = event.args;\n      // FIXME: put sessionId into args[\"data\"] for TracingStartedInPage event.\n      if (args['data']) {\n        args = args['data'];\n      }\n      const id = args['sessionId'];\n      if (id === sessionId) {\n        return true;\n      }\n      mismatchingIds.add(id);\n      return false;\n    }\n    const result = {\n      page: pageDevToolsMetadataEvents.filter(checkSessionId).sort(SDK.TracingModel.Event.compareStartTime),\n      workers: workersDevToolsMetadataEvents.sort(SDK.TracingModel.Event.compareStartTime)\n    };\n    if (mismatchingIds.size) {\n      Common.Console.Console.instance().error(\n          'Timeline recording was started in more than one page simultaneously. Session id mismatch: ' +\n          this._sessionId + ' and ' + [...mismatchingIds] + '.');\n    }\n    return result;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   */\n  _processSyncBrowserEvents(tracingModel) {\n    const browserMain = SDK.TracingModel.TracingModel.browserMainThread(tracingModel);\n    if (browserMain) {\n      browserMain.events().forEach(this._processBrowserEvent, this);\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   */\n  _processAsyncBrowserEvents(tracingModel) {\n    const browserMain = SDK.TracingModel.TracingModel.browserMainThread(tracingModel);\n    if (browserMain) {\n      this._processAsyncEvents(browserMain, [{from: 0, to: Infinity}]);\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   */\n  _buildGPUEvents(tracingModel) {\n    const thread = tracingModel.threadByName('GPU Process', 'CrGpuMain');\n    if (!thread) {\n      return;\n    }\n    const gpuEventName = RecordType.GPUTask;\n    const track = this._ensureNamedTrack(TrackType.GPU);\n    track.thread = thread;\n    track.events = thread.events().filter(event => event.name === gpuEventName);\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   * @param {!Array<!SDK.TracingModel.Event>} events\n   */\n  _buildLoadingEvents(tracingModel, events) {\n    const thread = tracingModel.threadByName('Renderer', 'CrRendererMain');\n    if (!thread) {\n      return;\n    }\n    const experienceCategory = 'experience';\n    const track = this._ensureNamedTrack(TrackType.Experience);\n    track.thread = thread;\n    track.events = events;\n\n    // Even though the event comes from 'loading', in order to color it differently we\n    // rename its category.\n    for (const trackEvent of track.events) {\n      trackEvent.categoriesString = experienceCategory;\n      if (trackEvent.name === RecordType.LayoutShift) {\n        const eventData = trackEvent.args['data'] || trackEvent.args['beginData'] || {};\n        const timelineData = TimelineData.forEvent(trackEvent);\n        timelineData.backendNodeId = eventData['impacted_nodes'] && eventData['impacted_nodes'].length > 0 ?\n            eventData['impacted_nodes'][0]['node_id'] :\n            0;\n      }\n    }\n  }\n\n  _resetProcessingState() {\n    this._asyncEventTracker = new TimelineAsyncEventTracker();\n    this._invalidationTracker = new InvalidationTracker();\n    this._layoutInvalidate = {};\n    this._lastScheduleStyleRecalculation = {};\n    this._paintImageEventByPixelRefId = {};\n    this._lastPaintForLayer = {};\n    this._lastRecalculateStylesEvent = null;\n    this._currentScriptEvent = null;\n    this._eventStack = [];\n    this._knownInputEvents = new Set();\n    this._browserFrameTracking = false;\n    this._persistentIds = false;\n    this._legacyCurrentPage = null;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   * @param {!SDK.TracingModel.Thread} thread\n   * @return {?SDK.CPUProfileDataModel.CPUProfileDataModel}\n   */\n  _extractCpuProfile(tracingModel, thread) {\n    const events = thread.events();\n    let cpuProfile;\n    let target = null;\n\n    // Check for legacy CpuProfile event format first.\n    /** @type {(SDK.TracingModel.Event|undefined)} */\n    let cpuProfileEvent = events[events.length - 1];\n    if (cpuProfileEvent && cpuProfileEvent.name === RecordType.CpuProfile) {\n      const eventData = cpuProfileEvent.args['data'];\n      cpuProfile = /** @type {?Protocol.Profiler.Profile} */ (eventData && eventData['cpuProfile']);\n      target = this.targetByEvent(cpuProfileEvent);\n    }\n\n    if (!cpuProfile) {\n      cpuProfileEvent = events.find(e => e.name === RecordType.Profile);\n      if (!cpuProfileEvent) {\n        return null;\n      }\n      target = this.targetByEvent(cpuProfileEvent);\n      const profileGroup = tracingModel.profileGroup(cpuProfileEvent);\n      if (!profileGroup) {\n        Common.Console.Console.instance().error('Invalid CPU profile format.');\n        return null;\n      }\n      // This overlaps with the Protocol.Profiler.Profile type, but adds\n      // the lines array.\n      cpuProfile = /** @type {*} */ ({\n        // Do not use |cpuProfileEvent.args['data']['startTime']| as it is in\n        // CLOCK_MONOTONIC domain, but use |profileEvent.startTime|\n        // (|ts| in the trace event) which has been translated to\n        // Perfetto's clock domain.\n        //\n        // |cpuProfileEvent.startTime| has been converted to milliseconds\n        // when the Event was loaded but |cpuProfile.timeDeltas| are\n        // expressed in microseconds.\n        startTime: cpuProfileEvent.startTime * 1000,\n        endTime: 0,\n        nodes: [],\n        samples: [],\n        timeDeltas: [],\n        lines: []\n      });\n      for (const profileEvent of profileGroup.children) {\n        const eventData = profileEvent.args['data'];\n        if ('startTime' in eventData) {\n          // Do not use |eventData['startTime']| as it is in CLOCK_MONOTONIC domain,\n          // but use |profileEvent.startTime| (|ts| in the trace event) which has\n          // been translated to Perfetto's clock domain.\n          //\n          // Also convert from ms to us.\n          cpuProfile.startTime = profileEvent.startTime * 1000;\n        }\n        if ('endTime' in eventData) {\n          // Do not use |eventData['endTime']| as it is in CLOCK_MONOTONIC domain,\n          // but use |profileEvent.startTime| (|ts| in the trace event) which has\n          // been translated to Perfetto's clock domain.\n          //\n          // Despite its name, |profileEvent.startTime| was recorded right after\n          // |eventData['endTime']| within v8 and is a reasonable substitute.\n          //\n          // Also convert from ms to us.\n          cpuProfile.endTime = profileEvent.startTime * 1000;\n        }\n        const nodesAndSamples = eventData['cpuProfile'] || {};\n        const samples = nodesAndSamples['samples'] || [];\n        const lines = eventData['lines'] || Array(samples.length).fill(0);\n        cpuProfile.nodes.push(...(nodesAndSamples['nodes'] || []));\n        cpuProfile.lines.push(...lines);\n        if (cpuProfile.samples) {\n          cpuProfile.samples.push(...samples);\n        }\n        if (cpuProfile.timeDeltas) {\n          cpuProfile.timeDeltas.push(...(eventData['timeDeltas'] || []));\n        }\n        if (cpuProfile.samples && cpuProfile.timeDeltas && cpuProfile.samples.length !== cpuProfile.timeDeltas.length) {\n          Common.Console.Console.instance().error('Failed to parse CPU profile.');\n          return null;\n        }\n      }\n      if (!cpuProfile.endTime && cpuProfile.timeDeltas) {\n        /** @type {!Array<number>} */\n        const timeDeltas = cpuProfile.timeDeltas;\n        cpuProfile.endTime = timeDeltas.reduce((x, y) => x + y, cpuProfile.startTime);\n      }\n    }\n\n    try {\n      const profile = /** @type {!Protocol.Profiler.Profile} */ (cpuProfile);\n      const jsProfileModel = new SDK.CPUProfileDataModel.CPUProfileDataModel(profile, target);\n      this._cpuProfiles.push(jsProfileModel);\n      return jsProfileModel;\n    } catch (e) {\n      Common.Console.Console.instance().error('Failed to parse CPU profile.');\n    }\n    return null;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   * @param {!SDK.TracingModel.Thread} thread\n   * @return {!Array<!SDK.TracingModel.Event>}\n   */\n  _injectJSFrameEvents(tracingModel, thread) {\n    const jsProfileModel = this._extractCpuProfile(tracingModel, thread);\n    let events = thread.events();\n    const jsSamples =\n        jsProfileModel ? TimelineJSProfileProcessor.generateTracingEventsFromCpuProfile(jsProfileModel, thread) : null;\n    if (jsSamples && jsSamples.length) {\n      events = Platform.ArrayUtilities.mergeOrdered(events, jsSamples, SDK.TracingModel.Event.orderedCompareStartTime);\n    }\n    if (jsSamples || events.some(e => e.name === RecordType.JSSample)) {\n      const jsFrameEvents = TimelineJSProfileProcessor.generateJSFrameEvents(events, {\n        showAllEvents: Root.Runtime.experiments.isEnabled('timelineShowAllEvents'),\n        showRuntimeCallStats: Root.Runtime.experiments.isEnabled('timelineV8RuntimeCallStats'),\n        showNativeFunctions: Common.Settings.Settings.instance().moduleSetting('showNativeFunctionsInJSProfile').get(),\n      });\n      if (jsFrameEvents && jsFrameEvents.length) {\n        events =\n            Platform.ArrayUtilities.mergeOrdered(jsFrameEvents, events, SDK.TracingModel.Event.orderedCompareStartTime);\n      }\n    }\n    return events;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.TracingModel} tracingModel\n   * @param {!Array<!{from: number, to: number}>} ranges\n   * @param {!SDK.TracingModel.Thread} thread\n   * @param {boolean} isMainThread\n   * @param {boolean} isWorker\n   * @param {boolean} forMainFrame\n   * @param {?string} url\n   */\n  _processThreadEvents(tracingModel, ranges, thread, isMainThread, isWorker, forMainFrame, url) {\n    const track = new Track();\n    track.name = thread.name() || ls`Thread ${thread.id()}`;\n    track.type = TrackType.Other;\n    track.thread = thread;\n    if (isMainThread) {\n      track.type = TrackType.MainThread;\n      track.url = url || '';\n      track.forMainFrame = forMainFrame;\n    } else if (isWorker) {\n      track.type = TrackType.Worker;\n      track.url = url || '';\n      track.name = track.url ? ls`Worker  ${track.url}` : ls`Dedicated Worker`;\n    } else if (thread.name().startsWith('CompositorTileWorker')) {\n      track.type = TrackType.Raster;\n    }\n    this._tracks.push(track);\n\n    const events = this._injectJSFrameEvents(tracingModel, thread);\n    this._eventStack = [];\n    const eventStack = this._eventStack;\n\n    // Get the worker name from the target.\n    if (isWorker) {\n      const cpuProfileEvent = events.find(event => event.name === RecordType.Profile);\n      if (cpuProfileEvent) {\n        const target = this.targetByEvent(cpuProfileEvent);\n        if (target) {\n          track.name = ls`Worker: ${target.name()}  ${track.url}`;\n        }\n      }\n    }\n\n    for (const range of ranges) {\n      let i = Platform.ArrayUtilities.lowerBound(events, range.from, (time, event) => time - event.startTime);\n      for (; i < events.length; i++) {\n        const event = events[i];\n        if (event.startTime >= range.to) {\n          break;\n        }\n\n        // There may be several TTI events, only take the first one.\n        if (this.isInteractiveTimeEvent(event) && this._totalBlockingTime === -1) {\n          this._totalBlockingTime = event.args['args']['total_blocking_time_ms'];\n        }\n\n        const isLongRunningTask = event.name === RecordType.Task && event.duration && event.duration > 50;\n        if (isMainThread && isLongRunningTask && event.duration) {\n          // We only track main thread events that are over 50ms, and the amount of time in the\n          // event (over 50ms) is what constitutes the blocking time. An event of 70ms, therefore,\n          // contributes 20ms to TBT.\n          this._estimatedTotalBlockingTime += event.duration - 50;\n        }\n\n        let last = eventStack[eventStack.length - 1];\n        while (last && last.endTime !== undefined && last.endTime <= event.startTime) {\n          eventStack.pop();\n          last = eventStack[eventStack.length - 1];\n        }\n        if (!this._processEvent(event)) {\n          continue;\n        }\n        if (!SDK.TracingModel.TracingModel.isAsyncPhase(event.phase) && event.duration) {\n          if (eventStack.length) {\n            const parent = eventStack[eventStack.length - 1];\n            if (parent) {\n              parent.selfTime -= event.duration;\n              if (parent.selfTime < 0) {\n                this._fixNegativeDuration(parent, event);\n              }\n            }\n          }\n          event.selfTime = event.duration;\n          if (!eventStack.length) {\n            track.tasks.push(event);\n          }\n          eventStack.push(event);\n        }\n        if (this.isMarkerEvent(event)) {\n          this._timeMarkerEvents.push(event);\n        }\n\n        track.events.push(event);\n        this._inspectedTargetEvents.push(event);\n      }\n    }\n    this._processAsyncEvents(thread, ranges);\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @param {!SDK.TracingModel.Event} child\n   */\n  _fixNegativeDuration(event, child) {\n    const epsilon = 1e-3;\n    if (event.selfTime < -epsilon) {\n      console.error(\n          `Children are longer than parent at ${event.startTime} ` +\n          `(${(child.startTime - this.minimumRecordTime()).toFixed(3)} by ${(-event.selfTime).toFixed(3)}`);\n    }\n    event.selfTime = 0;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Thread} thread\n   * @param {!Array<!{from: number, to: number}>} ranges\n   */\n  _processAsyncEvents(thread, ranges) {\n    const asyncEvents = thread.asyncEvents();\n    const groups = new Map();\n\n    /**\n     * @param {!TrackType} type\n     * @return {!Array<!SDK.TracingModel.AsyncEvent>}\n     */\n    function group(type) {\n      if (!groups.has(type)) {\n        groups.set(type, []);\n      }\n      return groups.get(type);\n    }\n\n    for (const range of ranges) {\n      let i = Platform.ArrayUtilities.lowerBound(asyncEvents, range.from, function(time, asyncEvent) {\n        return time - asyncEvent.startTime;\n      });\n\n      for (; i < asyncEvents.length; ++i) {\n        const asyncEvent = asyncEvents[i];\n        if (asyncEvent.startTime >= range.to) {\n          break;\n        }\n\n        if (asyncEvent.hasCategory(TimelineModelImpl.Category.Console)) {\n          group(TrackType.Console).push(asyncEvent);\n          continue;\n        }\n\n        if (asyncEvent.hasCategory(TimelineModelImpl.Category.UserTiming)) {\n          group(TrackType.Timings).push(asyncEvent);\n          continue;\n        }\n\n        if (asyncEvent.name === RecordType.Animation) {\n          group(TrackType.Animation).push(asyncEvent);\n          continue;\n        }\n\n        if (asyncEvent.hasCategory(TimelineModelImpl.Category.LatencyInfo) ||\n            asyncEvent.name === RecordType.ImplSideFling) {\n          const lastStep = asyncEvent.steps[asyncEvent.steps.length - 1];\n          if (!lastStep) {\n            throw new Error('AsyncEvent.steps access is out of bounds.');\n          }\n          // FIXME: fix event termination on the back-end instead.\n          if (lastStep.phase !== SDK.TracingModel.Phase.AsyncEnd) {\n            continue;\n          }\n          const data = lastStep.args['data'];\n          asyncEvent.causedFrame = Boolean(data && data['INPUT_EVENT_LATENCY_RENDERER_SWAP_COMPONENT']);\n          if (asyncEvent.hasCategory(TimelineModelImpl.Category.LatencyInfo)) {\n            if (lastStep.id && !this._knownInputEvents.has(lastStep.id)) {\n              continue;\n            }\n            if (asyncEvent.name === RecordType.InputLatencyMouseMove && !asyncEvent.causedFrame) {\n              continue;\n            }\n            // Coalesced events are not really been processed, no need to track them.\n            if (data['is_coalesced']) {\n              continue;\n            }\n            const rendererMain = data['INPUT_EVENT_LATENCY_RENDERER_MAIN_COMPONENT'];\n            if (rendererMain) {\n              const time = rendererMain['time'] / 1000;\n              TimelineData.forEvent(asyncEvent.steps[0]).timeWaitingForMainThread =\n                  time - asyncEvent.steps[0].startTime;\n            }\n          }\n          group(TrackType.Input).push(asyncEvent);\n          continue;\n        }\n      }\n    }\n\n    for (const [type, events] of groups) {\n      const track = this._ensureNamedTrack(type);\n      track.thread = thread;\n      track.asyncEvents =\n          Platform.ArrayUtilities.mergeOrdered(track.asyncEvents, events, SDK.TracingModel.Event.compareStartTime);\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {boolean}\n   */\n  _processEvent(event) {\n    const recordTypes = RecordType;\n    const eventStack = this._eventStack;\n\n    if (!eventStack.length) {\n      if (this._currentTaskLayoutAndRecalcEvents && this._currentTaskLayoutAndRecalcEvents.length) {\n        const totalTime = this._currentTaskLayoutAndRecalcEvents.reduce((time, event) => {\n          return event.duration === undefined ? time : time + event.duration;\n        }, 0);\n        if (totalTime > TimelineModelImpl.Thresholds.ForcedLayout) {\n          for (const e of this._currentTaskLayoutAndRecalcEvents) {\n            const timelineData = TimelineData.forEvent(e);\n            timelineData.warning = e.name === recordTypes.Layout ? TimelineModelImpl.WarningType.ForcedLayout :\n                                                                   TimelineModelImpl.WarningType.ForcedStyle;\n          }\n        }\n      }\n      this._currentTaskLayoutAndRecalcEvents = [];\n    }\n\n    if (this._currentScriptEvent) {\n      if (this._currentScriptEvent.endTime !== undefined && event.startTime > this._currentScriptEvent.endTime) {\n        this._currentScriptEvent = null;\n      }\n    }\n\n    const eventData = event.args['data'] || event.args['beginData'] || {};\n    const timelineData = TimelineData.forEvent(event);\n    if (eventData['stackTrace']) {\n      timelineData.stackTrace = eventData['stackTrace'];\n    }\n    if (timelineData.stackTrace && event.name !== recordTypes.JSSample) {\n      // TraceEvents come with 1-based line & column numbers. The frontend code\n      // requires 0-based ones. Adjust the values.\n      for (let i = 0; i < timelineData.stackTrace.length; ++i) {\n        --timelineData.stackTrace[i].lineNumber;\n        --timelineData.stackTrace[i].columnNumber;\n      }\n    }\n    let pageFrameId = TimelineModelImpl.eventFrameId(event);\n    const last = eventStack[eventStack.length - 1];\n    if (!pageFrameId && last) {\n      pageFrameId = TimelineData.forEvent(last).frameId;\n    }\n    timelineData.frameId = pageFrameId || (this._mainFrame && this._mainFrame.frameId) || '';\n    this._asyncEventTracker.processEvent(event);\n\n    if (this.isMarkerEvent(event)) {\n      this._ensureNamedTrack(TrackType.Timings);\n    }\n\n    switch (event.name) {\n      case recordTypes.ResourceSendRequest:\n      case recordTypes.WebSocketCreate: {\n        timelineData.setInitiator(eventStack[eventStack.length - 1] || null);\n        timelineData.url = eventData['url'];\n        break;\n      }\n\n      case recordTypes.ScheduleStyleRecalculation: {\n        this._lastScheduleStyleRecalculation[eventData['frame']] = event;\n        break;\n      }\n\n      case recordTypes.UpdateLayoutTree:\n      case recordTypes.RecalculateStyles: {\n        this._invalidationTracker.didRecalcStyle(event);\n        if (event.args['beginData']) {\n          timelineData.setInitiator(this._lastScheduleStyleRecalculation[event.args['beginData']['frame']]);\n        }\n        this._lastRecalculateStylesEvent = event;\n        if (this._currentScriptEvent) {\n          this._currentTaskLayoutAndRecalcEvents.push(event);\n        }\n        break;\n      }\n\n      case recordTypes.ScheduleStyleInvalidationTracking:\n      case recordTypes.StyleRecalcInvalidationTracking:\n      case recordTypes.StyleInvalidatorInvalidationTracking:\n      case recordTypes.LayoutInvalidationTracking: {\n        this._invalidationTracker.addInvalidation(new InvalidationTrackingEvent(event));\n        break;\n      }\n\n      case recordTypes.InvalidateLayout: {\n        // Consider style recalculation as a reason for layout invalidation,\n        // but only if we had no earlier layout invalidation records.\n        /** @type {?SDK.TracingModel.Event} */\n        let layoutInitator = event;\n        const frameId = eventData['frame'];\n        if (!this._layoutInvalidate[frameId] && this._lastRecalculateStylesEvent &&\n            this._lastRecalculateStylesEvent.endTime !== undefined &&\n            this._lastRecalculateStylesEvent.endTime > event.startTime) {\n          layoutInitator = TimelineData.forEvent(this._lastRecalculateStylesEvent).initiator();\n        }\n        this._layoutInvalidate[frameId] = layoutInitator;\n        break;\n      }\n\n      case recordTypes.Layout: {\n        this._invalidationTracker.didLayout(event);\n        const frameId = event.args['beginData']['frame'];\n        timelineData.setInitiator(this._layoutInvalidate[frameId]);\n        // In case we have no closing Layout event, endData is not available.\n        if (event.args['endData']) {\n          timelineData.backendNodeId = event.args['endData']['rootNode'];\n        }\n        this._layoutInvalidate[frameId] = null;\n        if (this._currentScriptEvent) {\n          this._currentTaskLayoutAndRecalcEvents.push(event);\n        }\n        break;\n      }\n\n      case recordTypes.Task: {\n        if (event.duration !== undefined && event.duration > TimelineModelImpl.Thresholds.LongTask) {\n          timelineData.warning = TimelineModelImpl.WarningType.LongTask;\n        }\n        break;\n      }\n\n      case recordTypes.EventDispatch: {\n        if (event.duration !== undefined && event.duration > TimelineModelImpl.Thresholds.RecurringHandler) {\n          timelineData.warning = TimelineModelImpl.WarningType.LongHandler;\n        }\n        break;\n      }\n\n      case recordTypes.TimerFire:\n      case recordTypes.FireAnimationFrame: {\n        if (event.duration !== undefined && event.duration > TimelineModelImpl.Thresholds.RecurringHandler) {\n          timelineData.warning = TimelineModelImpl.WarningType.LongRecurringHandler;\n        }\n        break;\n      }\n      // @ts-ignore fallthrough intended.\n      case recordTypes.FunctionCall: {\n        // Compatibility with old format.\n        if (typeof eventData['scriptName'] === 'string') {\n          eventData['url'] = eventData['scriptName'];\n        }\n        if (typeof eventData['scriptLine'] === 'number') {\n          eventData['lineNumber'] = eventData['scriptLine'];\n        }\n      }\n\n      case recordTypes.EvaluateScript:\n      // @ts-ignore fallthrough intended.\n      case recordTypes.CompileScript: {\n        if (typeof eventData['lineNumber'] === 'number') {\n          --eventData['lineNumber'];\n        }\n        if (typeof eventData['columnNumber'] === 'number') {\n          --eventData['columnNumber'];\n        }\n      }\n\n      case recordTypes.RunMicrotasks: {\n        // Microtasks technically are not necessarily scripts, but for purpose of\n        // forced sync style recalc or layout detection they are.\n        if (!this._currentScriptEvent) {\n          this._currentScriptEvent = event;\n        }\n        break;\n      }\n\n      case recordTypes.SetLayerTreeId: {\n        // This is to support old traces.\n        if (this._sessionId && eventData['sessionId'] && this._sessionId === eventData['sessionId']) {\n          this._mainFrameLayerTreeId = eventData['layerTreeId'];\n          break;\n        }\n\n        // We currently only show layer tree for the main frame.\n        const frameId = TimelineModelImpl.eventFrameId(event);\n        const pageFrame = this._pageFrames.get(frameId);\n        if (!pageFrame || pageFrame.parent) {\n          return false;\n        }\n        this._mainFrameLayerTreeId = eventData['layerTreeId'];\n        break;\n      }\n\n      case recordTypes.Paint: {\n        this._invalidationTracker.didPaint(event);\n        timelineData.backendNodeId = eventData['nodeId'];\n        // Only keep layer paint events, skip paints for subframes that get painted to the same layer as parent.\n        if (!eventData['layerId']) {\n          break;\n        }\n        const layerId = eventData['layerId'];\n        this._lastPaintForLayer[layerId] = event;\n        break;\n      }\n\n      case recordTypes.DisplayItemListSnapshot:\n      case recordTypes.PictureSnapshot: {\n        const layerUpdateEvent = this._findAncestorEvent(recordTypes.UpdateLayer);\n        if (!layerUpdateEvent || layerUpdateEvent.args['layerTreeId'] !== this._mainFrameLayerTreeId) {\n          break;\n        }\n        const paintEvent = this._lastPaintForLayer[layerUpdateEvent.args['layerId']];\n        if (paintEvent) {\n          TimelineData.forEvent(paintEvent).picture =\n              /** @type {!SDK.TracingModel.ObjectSnapshot} */ (event);\n        }\n        break;\n      }\n\n      case recordTypes.ScrollLayer: {\n        timelineData.backendNodeId = eventData['nodeId'];\n        break;\n      }\n\n      case recordTypes.PaintImage: {\n        timelineData.backendNodeId = eventData['nodeId'];\n        timelineData.url = eventData['url'];\n        break;\n      }\n\n      case recordTypes.DecodeImage:\n      case recordTypes.ResizeImage: {\n        let paintImageEvent = this._findAncestorEvent(recordTypes.PaintImage);\n        if (!paintImageEvent) {\n          const decodeLazyPixelRefEvent = this._findAncestorEvent(recordTypes.DecodeLazyPixelRef);\n          paintImageEvent = decodeLazyPixelRefEvent &&\n              this._paintImageEventByPixelRefId[decodeLazyPixelRefEvent.args['LazyPixelRef']];\n        }\n        if (!paintImageEvent) {\n          break;\n        }\n        const paintImageData = TimelineData.forEvent(paintImageEvent);\n        timelineData.backendNodeId = paintImageData.backendNodeId;\n        timelineData.url = paintImageData.url;\n        break;\n      }\n\n      case recordTypes.DrawLazyPixelRef: {\n        const paintImageEvent = this._findAncestorEvent(recordTypes.PaintImage);\n        if (!paintImageEvent) {\n          break;\n        }\n        this._paintImageEventByPixelRefId[event.args['LazyPixelRef']] = paintImageEvent;\n        const paintImageData = TimelineData.forEvent(paintImageEvent);\n        timelineData.backendNodeId = paintImageData.backendNodeId;\n        timelineData.url = paintImageData.url;\n        break;\n      }\n\n      case recordTypes.FrameStartedLoading: {\n        if (timelineData.frameId !== event.args['frame']) {\n          return false;\n        }\n        break;\n      }\n\n      case recordTypes.MarkLCPCandidate: {\n        timelineData.backendNodeId = eventData['nodeId'];\n        break;\n      }\n\n      case recordTypes.MarkDOMContent:\n      case recordTypes.MarkLoad: {\n        const frameId = TimelineModelImpl.eventFrameId(event);\n        if (!this._pageFrames.has(frameId)) {\n          return false;\n        }\n        break;\n      }\n\n      case recordTypes.CommitLoad: {\n        if (this._browserFrameTracking) {\n          break;\n        }\n        const frameId = TimelineModelImpl.eventFrameId(event);\n        const isMainFrame = Boolean(eventData['isMainFrame']);\n        const pageFrame = this._pageFrames.get(frameId);\n        if (pageFrame) {\n          pageFrame.update(event.startTime, eventData);\n        } else {\n          // We should only have one main frame which has persistent id,\n          // unless it's an old trace without 'persistentIds' flag.\n          if (!this._persistentIds) {\n            if (eventData['page'] && eventData['page'] !== this._legacyCurrentPage) {\n              return false;\n            }\n          } else if (isMainFrame) {\n            return false;\n          } else if (!this._addPageFrame(event, eventData)) {\n            return false;\n          }\n        }\n        if (isMainFrame) {\n          const frame = this._pageFrames.get(frameId);\n          if (frame) {\n            this._mainFrame = frame;\n          }\n        }\n        break;\n      }\n\n      case recordTypes.FireIdleCallback: {\n        if (event.duration !== undefined &&\n            event.duration > eventData['allottedMilliseconds'] + TimelineModelImpl.Thresholds.IdleCallbackAddon) {\n          timelineData.warning = TimelineModelImpl.WarningType.IdleDeadlineExceeded;\n        }\n        break;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   */\n  _processBrowserEvent(event) {\n    if (event.name === RecordType.LatencyInfoFlow) {\n      const frameId = event.args['frameTreeNodeId'];\n      if (typeof frameId === 'number' && frameId === this._mainFrameNodeId && event.bind_id) {\n        this._knownInputEvents.add(event.bind_id);\n      }\n      return;\n    }\n\n    if (event.name === RecordType.ResourceWillSendRequest) {\n      const requestId = event.args['data']['requestId'];\n      if (typeof requestId === 'string') {\n        this._requestsFromBrowser.set(requestId, event);\n      }\n      return;\n    }\n\n    if (event.hasCategory(SDK.TracingModel.DevToolsMetadataEventCategory) && event.args['data']) {\n      const data = event.args['data'];\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.TracingStartedInBrowser) {\n        if (!data['persistentIds']) {\n          return;\n        }\n        this._browserFrameTracking = true;\n        this._mainFrameNodeId = data['frameTreeNodeId'];\n        /** @type{!Array<*>} */\n        const frames = data['frames'] || [];\n        frames.forEach(payload => {\n          const parent = payload['parent'] && this._pageFrames.get(payload['parent']);\n          if (payload['parent'] && !parent) {\n            return;\n          }\n          let frame = this._pageFrames.get(payload['frame']);\n          if (!frame) {\n            frame = new PageFrame(payload);\n            this._pageFrames.set(frame.frameId, frame);\n            if (parent) {\n              parent.addChild(frame);\n            } else {\n              this._mainFrame = frame;\n            }\n          }\n          // TODO(dgozman): this should use event.startTime, but due to races between tracing start\n          // in different processes we cannot do this yet.\n          frame.update(this._minimumRecordTime, payload);\n        });\n        return;\n      }\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.FrameCommittedInBrowser &&\n          this._browserFrameTracking) {\n        let frame = this._pageFrames.get(data['frame']);\n        if (!frame) {\n          const parent = data['parent'] && this._pageFrames.get(data['parent']);\n          if (!parent) {\n            return;\n          }\n          frame = new PageFrame(data);\n          this._pageFrames.set(frame.frameId, frame);\n          parent.addChild(frame);\n        }\n        frame.update(event.startTime, data);\n        return;\n      }\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.ProcessReadyInBrowser && this._browserFrameTracking) {\n        const frame = this._pageFrames.get(data['frame']);\n        if (frame) {\n          frame.processReady(data['processPseudoId'], data['processId']);\n        }\n        return;\n      }\n      if (event.name === TimelineModelImpl.DevToolsMetadataEvent.FrameDeletedInBrowser && this._browserFrameTracking) {\n        const frame = this._pageFrames.get(data['frame']);\n        if (frame) {\n          frame.deletedTime = event.startTime;\n        }\n        return;\n      }\n    }\n  }\n\n  /**\n   * @param {!TrackType} type\n   * @return {!Track}\n   */\n  _ensureNamedTrack(type) {\n    let track = this._namedTracks.get(type);\n    if (track) {\n      return track;\n    }\n\n    track = new Track();\n    track.type = type;\n    this._tracks.push(track);\n    this._namedTracks.set(type, track);\n    return track;\n  }\n\n  /**\n   * @param {string} name\n   * @return {?SDK.TracingModel.Event}\n   */\n  _findAncestorEvent(name) {\n    for (let i = this._eventStack.length - 1; i >= 0; --i) {\n      const event = this._eventStack[i];\n      if (event.name === name) {\n        return event;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @param {*} payload\n   * @return {boolean}\n   */\n  _addPageFrame(event, payload) {\n    const parent = payload['parent'] && this._pageFrames.get(payload['parent']);\n    if (payload['parent'] && !parent) {\n      return false;\n    }\n    const pageFrame = new PageFrame(payload);\n    this._pageFrames.set(pageFrame.frameId, pageFrame);\n    pageFrame.update(event.startTime, payload);\n    if (parent) {\n      parent.addChild(pageFrame);\n    }\n    return true;\n  }\n\n  _reset() {\n    this._isGenericTrace = false;\n    this._tracks = [];\n    this._namedTracks = new Map();\n    this._inspectedTargetEvents = [];\n    this._timeMarkerEvents = [];\n    this._sessionId = null;\n    this._mainFrameNodeId = null;\n    this._cpuProfiles = [];\n    this._workerIdByThread = new WeakMap();\n    this._pageFrames = new Map();\n    this._requestsFromBrowser = new Map();\n\n    this._minimumRecordTime = 0;\n    this._maximumRecordTime = 0;\n\n    this._totalBlockingTime = -1;\n    this._estimatedTotalBlockingTime = 0;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isGenericTrace() {\n    return this._isGenericTrace;\n  }\n\n  /**\n   * @return {?SDK.TracingModel.TracingModel}\n   */\n  tracingModel() {\n    return this._tracingModel;\n  }\n\n  /**\n   * @return {number}\n   */\n  minimumRecordTime() {\n    return this._minimumRecordTime;\n  }\n\n  /**\n   * @return {number}\n   */\n  maximumRecordTime() {\n    return this._maximumRecordTime;\n  }\n\n  /**\n   * @return {!Array<!SDK.TracingModel.Event>}\n   */\n  inspectedTargetEvents() {\n    return this._inspectedTargetEvents;\n  }\n\n  /**\n   * @return {!Array<!Track>}\n   */\n  tracks() {\n    return this._tracks;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isEmpty() {\n    return this.minimumRecordTime() === 0 && this.maximumRecordTime() === 0;\n  }\n\n  /**\n   * @return {!Array<!SDK.TracingModel.Event>}\n   */\n  timeMarkerEvents() {\n    return this._timeMarkerEvents;\n  }\n\n  /**\n   * @return {!Array<!PageFrame>}\n   */\n  rootFrames() {\n    return Array.from(this._pageFrames.values()).filter(frame => !frame.parent);\n  }\n\n  /**\n   * @return {string}\n   */\n  pageURL() {\n    return this._mainFrame && this._mainFrame.url || '';\n  }\n\n  /**\n   * @param {string} frameId\n   * @return {?PageFrame}\n   */\n  pageFrameById(frameId) {\n    return frameId ? this._pageFrames.get(frameId) || null : null;\n  }\n\n  /**\n   * @return {!Array<!NetworkRequest>}\n   */\n  networkRequests() {\n    if (this.isGenericTrace()) {\n      return [];\n    }\n    /** @type {!Map<string,!NetworkRequest>} */\n    const requests = new Map();\n    /** @type {!Array<!NetworkRequest>} */\n    const requestsList = [];\n    /** @type {!Array<!NetworkRequest>} */\n    const zeroStartRequestsList = [];\n    const types = RecordType;\n    const resourceTypes = new Set([\n      types.ResourceWillSendRequest, types.ResourceSendRequest, types.ResourceReceiveResponse,\n      types.ResourceReceivedData, types.ResourceFinish, types.ResourceMarkAsCached\n    ]);\n    const events = this.inspectedTargetEvents();\n    for (let i = 0; i < events.length; ++i) {\n      const e = events[i];\n      if (!resourceTypes.has(e.name)) {\n        continue;\n      }\n      const id = TimelineModelImpl.globalEventId(e, 'requestId');\n      if (e.name === types.ResourceSendRequest && this._requestsFromBrowser.has(e.args.data.requestId)) {\n        const requestId = e.args.data.requestId;\n        const event = this._requestsFromBrowser.get(requestId);\n        if (event) {\n          addRequest(event, id);\n        }\n      }\n      addRequest(e, id);\n    }\n    /**\n     *\n     * @param {!SDK.TracingModel.Event} e\n     * @param {string} id\n     */\n    function addRequest(e, id) {\n      let request = requests.get(id);\n      if (request) {\n        request.addEvent(e);\n      } else {\n        request = new NetworkRequest(e);\n        requests.set(id, request);\n        if (request.startTime) {\n          requestsList.push(request);\n        } else {\n          zeroStartRequestsList.push(request);\n        }\n      }\n    }\n    return zeroStartRequestsList.concat(requestsList);\n  }\n}\n\n/**\n * @enum {string}\n */\nexport const RecordType = {\n  Task: 'RunTask',\n  Program: 'Program',\n  EventDispatch: 'EventDispatch',\n\n  GPUTask: 'GPUTask',\n\n  Animation: 'Animation',\n  RequestMainThreadFrame: 'RequestMainThreadFrame',\n  BeginFrame: 'BeginFrame',\n  NeedsBeginFrameChanged: 'NeedsBeginFrameChanged',\n  BeginMainThreadFrame: 'BeginMainThreadFrame',\n  ActivateLayerTree: 'ActivateLayerTree',\n  DrawFrame: 'DrawFrame',\n  DroppedFrame: 'DroppedFrame',\n  HitTest: 'HitTest',\n  ScheduleStyleRecalculation: 'ScheduleStyleRecalculation',\n  RecalculateStyles: 'RecalculateStyles',  // For backwards compatibility only, now replaced by UpdateLayoutTree.\n  UpdateLayoutTree: 'UpdateLayoutTree',\n  InvalidateLayout: 'InvalidateLayout',\n  Layout: 'Layout',\n  LayoutShift: 'LayoutShift',\n  UpdateLayer: 'UpdateLayer',\n  UpdateLayerTree: 'UpdateLayerTree',\n  PaintSetup: 'PaintSetup',\n  Paint: 'Paint',\n  PaintImage: 'PaintImage',\n  Rasterize: 'Rasterize',\n  RasterTask: 'RasterTask',\n  ScrollLayer: 'ScrollLayer',\n  CompositeLayers: 'CompositeLayers',\n  InteractiveTime: 'InteractiveTime',\n\n  ScheduleStyleInvalidationTracking: 'ScheduleStyleInvalidationTracking',\n  StyleRecalcInvalidationTracking: 'StyleRecalcInvalidationTracking',\n  StyleInvalidatorInvalidationTracking: 'StyleInvalidatorInvalidationTracking',\n  LayoutInvalidationTracking: 'LayoutInvalidationTracking',\n\n  ParseHTML: 'ParseHTML',\n  ParseAuthorStyleSheet: 'ParseAuthorStyleSheet',\n\n  TimerInstall: 'TimerInstall',\n  TimerRemove: 'TimerRemove',\n  TimerFire: 'TimerFire',\n\n  XHRReadyStateChange: 'XHRReadyStateChange',\n  XHRLoad: 'XHRLoad',\n  CompileScript: 'v8.compile',\n  EvaluateScript: 'EvaluateScript',\n  CompileModule: 'v8.compileModule',\n  EvaluateModule: 'v8.evaluateModule',\n  WasmStreamFromResponseCallback: 'v8.wasm.streamFromResponseCallback',\n  WasmCompiledModule: 'v8.wasm.compiledModule',\n  WasmCachedModule: 'v8.wasm.cachedModule',\n  WasmModuleCacheHit: 'v8.wasm.moduleCacheHit',\n  WasmModuleCacheInvalid: 'v8.wasm.moduleCacheInvalid',\n\n  FrameStartedLoading: 'FrameStartedLoading',\n  CommitLoad: 'CommitLoad',\n  MarkLoad: 'MarkLoad',\n  MarkDOMContent: 'MarkDOMContent',\n  MarkFirstPaint: 'firstPaint',\n  MarkFCP: 'firstContentfulPaint',\n  MarkLCPCandidate: 'largestContentfulPaint::Candidate',\n  MarkLCPInvalidate: 'largestContentfulPaint::Invalidate',\n  NavigationStart: 'navigationStart',\n\n  TimeStamp: 'TimeStamp',\n  ConsoleTime: 'ConsoleTime',\n  UserTiming: 'UserTiming',\n\n  ResourceWillSendRequest: 'ResourceWillSendRequest',\n  ResourceSendRequest: 'ResourceSendRequest',\n  ResourceReceiveResponse: 'ResourceReceiveResponse',\n  ResourceReceivedData: 'ResourceReceivedData',\n  ResourceFinish: 'ResourceFinish',\n  ResourceMarkAsCached: 'ResourceMarkAsCached',\n\n  RunMicrotasks: 'RunMicrotasks',\n  FunctionCall: 'FunctionCall',\n  GCEvent: 'GCEvent',  // For backwards compatibility only, now replaced by MinorGC/MajorGC.\n  MajorGC: 'MajorGC',\n  MinorGC: 'MinorGC',\n  JSFrame: 'JSFrame',\n  JSSample: 'JSSample',\n  // V8Sample events are coming from tracing and contain raw stacks with function addresses.\n  // After being processed with help of JitCodeAdded and JitCodeMoved events they\n  // get translated into function infos and stored as stacks in JSSample events.\n  V8Sample: 'V8Sample',\n  JitCodeAdded: 'JitCodeAdded',\n  JitCodeMoved: 'JitCodeMoved',\n  StreamingCompileScript: 'v8.parseOnBackground',\n  StreamingCompileScriptWaiting: 'v8.parseOnBackgroundWaiting',\n  StreamingCompileScriptParsing: 'v8.parseOnBackgroundParsing',\n  V8Execute: 'V8.Execute',\n\n  UpdateCounters: 'UpdateCounters',\n\n  RequestAnimationFrame: 'RequestAnimationFrame',\n  CancelAnimationFrame: 'CancelAnimationFrame',\n  FireAnimationFrame: 'FireAnimationFrame',\n\n  RequestIdleCallback: 'RequestIdleCallback',\n  CancelIdleCallback: 'CancelIdleCallback',\n  FireIdleCallback: 'FireIdleCallback',\n\n  WebSocketCreate: 'WebSocketCreate',\n  WebSocketSendHandshakeRequest: 'WebSocketSendHandshakeRequest',\n  WebSocketReceiveHandshakeResponse: 'WebSocketReceiveHandshakeResponse',\n  WebSocketDestroy: 'WebSocketDestroy',\n\n  EmbedderCallback: 'EmbedderCallback',\n\n  SetLayerTreeId: 'SetLayerTreeId',\n  TracingStartedInPage: 'TracingStartedInPage',\n  TracingSessionIdForWorker: 'TracingSessionIdForWorker',\n\n  DecodeImage: 'Decode Image',\n  ResizeImage: 'Resize Image',\n  DrawLazyPixelRef: 'Draw LazyPixelRef',\n  DecodeLazyPixelRef: 'Decode LazyPixelRef',\n\n  LazyPixelRef: 'LazyPixelRef',\n  LayerTreeHostImplSnapshot: 'cc::LayerTreeHostImpl',\n  PictureSnapshot: 'cc::Picture',\n  DisplayItemListSnapshot: 'cc::DisplayItemList',\n  LatencyInfo: 'LatencyInfo',\n  LatencyInfoFlow: 'LatencyInfo.Flow',\n  InputLatencyMouseMove: 'InputLatency::MouseMove',\n  InputLatencyMouseWheel: 'InputLatency::MouseWheel',\n  ImplSideFling: 'InputHandlerProxy::HandleGestureFling::started',\n  GCCollectGarbage: 'BlinkGC.AtomicPhase',\n\n  CryptoDoEncrypt: 'DoEncrypt',\n  CryptoDoEncryptReply: 'DoEncryptReply',\n  CryptoDoDecrypt: 'DoDecrypt',\n  CryptoDoDecryptReply: 'DoDecryptReply',\n  CryptoDoDigest: 'DoDigest',\n  CryptoDoDigestReply: 'DoDigestReply',\n  CryptoDoSign: 'DoSign',\n  CryptoDoSignReply: 'DoSignReply',\n  CryptoDoVerify: 'DoVerify',\n  CryptoDoVerifyReply: 'DoVerifyReply',\n\n  // CpuProfile is a virtual event created on frontend to support\n  // serialization of CPU Profiles within tracing timeline data.\n  CpuProfile: 'CpuProfile',\n  Profile: 'Profile',\n\n  AsyncTask: 'AsyncTask',\n};\n\nTimelineModelImpl.Category = {\n  Console: 'blink.console',\n  UserTiming: 'blink.user_timing',\n  LatencyInfo: 'latencyInfo',\n  Loading: 'loading',\n};\n\n/**\n * @enum {string}\n */\nTimelineModelImpl.WarningType = {\n  LongTask: 'LongTask',\n  ForcedStyle: 'ForcedStyle',\n  ForcedLayout: 'ForcedLayout',\n  IdleDeadlineExceeded: 'IdleDeadlineExceeded',\n  LongHandler: 'LongHandler',\n  LongRecurringHandler: 'LongRecurringHandler',\n  V8Deopt: 'V8Deopt'\n};\n\nTimelineModelImpl.WorkerThreadName = 'DedicatedWorker thread';\nTimelineModelImpl.WorkerThreadNameLegacy = 'DedicatedWorker Thread';\nTimelineModelImpl.RendererMainThreadName = 'CrRendererMain';\nTimelineModelImpl.BrowserMainThreadName = 'CrBrowserMain';\n\nTimelineModelImpl.DevToolsMetadataEvent = {\n  TracingStartedInBrowser: 'TracingStartedInBrowser',\n  TracingStartedInPage: 'TracingStartedInPage',\n  TracingSessionIdForWorker: 'TracingSessionIdForWorker',\n  FrameCommittedInBrowser: 'FrameCommittedInBrowser',\n  ProcessReadyInBrowser: 'ProcessReadyInBrowser',\n  FrameDeletedInBrowser: 'FrameDeletedInBrowser',\n};\n\nTimelineModelImpl.Thresholds = {\n  LongTask: 50,\n  Handler: 150,\n  RecurringHandler: 50,\n  ForcedLayout: 30,\n  IdleCallbackAddon: 5\n};\n\nexport class Track {\n  constructor() {\n    this.name = '';\n    this.type = TrackType.Other;\n    // TODO(dgozman): replace forMainFrame with a list of frames, urls and time ranges.\n    this.forMainFrame = false;\n    this.url = '';\n    // TODO(dgozman): do not distinguish between sync and async events.\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    this.events = [];\n    /** @type {!Array<!SDK.TracingModel.AsyncEvent>} */\n    this.asyncEvents = [];\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    this.tasks = [];\n    /** @type {?Array<!SDK.TracingModel.Event>} */\n    this._syncEvents = null;\n    /** @type {?SDK.TracingModel.Thread} */\n    this.thread = null;\n  }\n\n  /**\n   * @return {!Array<!SDK.TracingModel.Event>}\n   */\n  syncEvents() {\n    if (this.events.length) {\n      return this.events;\n    }\n\n    if (this._syncEvents) {\n      return this._syncEvents;\n    }\n\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    const stack = [];\n\n    /**\n     * @return {number}\n     */\n    function peekLastEndTime() {\n      const last = stack[stack.length - 1];\n      if (last !== undefined) {\n        const endTime = last.endTime;\n        if (endTime !== undefined) {\n          return endTime;\n        }\n      }\n      throw new Error('End time does not exist on event.');\n    }\n\n    this._syncEvents = [];\n    for (const event of this.asyncEvents) {\n      const startTime = event.startTime;\n      let endTime = event.endTime;\n      if (endTime === undefined) {\n        endTime = startTime;\n      }\n      while (stack.length && startTime >= peekLastEndTime()) {\n        stack.pop();\n      }\n      if (stack.length && endTime > peekLastEndTime()) {\n        this._syncEvents = [];\n        break;\n      }\n      const syncEvent = new SDK.TracingModel.Event(\n          event.categoriesString, event.name, SDK.TracingModel.Phase.Complete, startTime, event.thread);\n      syncEvent.setEndTime(endTime);\n      syncEvent.addArgs(event.args);\n      this._syncEvents.push(syncEvent);\n      stack.push(syncEvent);\n    }\n    return this._syncEvents;\n  }\n}\n\n/**\n * @enum {symbol}\n */\nexport const TrackType = {\n  MainThread: Symbol('MainThread'),\n  Worker: Symbol('Worker'),\n  Input: Symbol('Input'),\n  Animation: Symbol('Animation'),\n  Timings: Symbol('Timings'),\n  Console: Symbol('Console'),\n  Raster: Symbol('Raster'),\n  GPU: Symbol('GPU'),\n  Experience: Symbol('Experience'),\n  Other: Symbol('Other'),\n};\n\nexport class PageFrame {\n  /**\n   * @param {*} payload\n   */\n  constructor(payload) {\n    this.frameId = payload['frame'];\n    this.url = payload['url'] || '';\n    this.name = payload['name'];\n    /** @type {!Array<!PageFrame>} */\n    this.children = [];\n    /** @type {?PageFrame} */\n    this.parent = null;\n    /** @type {!Array<!{time: number, processId: number, processPseudoId: ?string, url: string}>} */\n    this.processes = [];\n    /** @type {?number} */\n    this.deletedTime = null;\n    // TODO(dgozman): figure this out.\n    // this.ownerNode = target && payload['nodeId'] ? new SDK.DOMModel.DeferredDOMNode(target, payload['nodeId']) : null;\n    /** @type {?SDK.DOMModel.DeferredDOMNode} */\n    this.ownerNode = null;\n  }\n\n  /**\n   * @param {number} time\n   * @param {*} payload\n   */\n  update(time, payload) {\n    this.url = payload['url'] || '';\n    this.name = payload['name'];\n    if (payload['processId']) {\n      this.processes.push(\n          {time: time, processId: payload['processId'], processPseudoId: '', url: payload['url'] || ''});\n    } else {\n      this.processes.push(\n          {time: time, processId: -1, processPseudoId: payload['processPseudoId'], url: payload['url'] || ''});\n    }\n  }\n\n  /**\n   * @param {string} processPseudoId\n   * @param {number} processId\n   */\n  processReady(processPseudoId, processId) {\n    for (const process of this.processes) {\n      if (process.processPseudoId === processPseudoId) {\n        process.processPseudoId = '';\n        process.processId = processId;\n      }\n    }\n  }\n\n  /**\n   * @param {!PageFrame} child\n   */\n  addChild(child) {\n    this.children.push(child);\n    child.parent = this;\n  }\n}\n\nexport class NetworkRequest {\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   */\n  constructor(event) {\n    const recordType = RecordType;\n    const isInitial =\n        event.name === recordType.ResourceSendRequest || event.name === recordType.ResourceWillSendRequest;\n    this.startTime = isInitial ? event.startTime : 0;\n    this.endTime = Infinity;\n    this.encodedDataLength = 0;\n    this.decodedBodyLength = 0;\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    this.children = [];\n    /** @type {{pushStart: number, requestTime: number, sendStart: number, receiveHeadersEnd: number}} */\n    this.timing;\n    /** @type {string} */\n    this.mimeType;\n    /** @type {string} */\n    this.url;\n    /** @type {string} */\n    this.requestMethod;\n    /** @type {number} */\n    this._transferSize = 0;\n    /** @type {boolean} */\n    this._maybeDiskCached = false;\n    /** @type {boolean} */\n    this._memoryCached = false;\n    this.addEvent(event);\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   */\n  addEvent(event) {\n    this.children.push(event);\n    const recordType = RecordType;\n    // This Math.min is likely because of BUG(chromium:865066).\n    this.startTime = Math.min(this.startTime, event.startTime);\n    const eventData = event.args['data'];\n    if (eventData['mimeType']) {\n      this.mimeType = eventData['mimeType'];\n    }\n    if ('priority' in eventData) {\n      this.priority = eventData['priority'];\n    }\n    if (event.name === recordType.ResourceFinish) {\n      this.endTime = event.startTime;\n    }\n    if (eventData['finishTime']) {\n      this.finishTime = eventData['finishTime'] * 1000;\n    }\n    if (!this.responseTime &&\n        (event.name === recordType.ResourceReceiveResponse || event.name === recordType.ResourceReceivedData)) {\n      this.responseTime = event.startTime;\n    }\n    const encodedDataLength = eventData['encodedDataLength'] || 0;\n    if (event.name === recordType.ResourceMarkAsCached) {\n      // This is a reliable signal for memory caching.\n      this._memoryCached = true;\n    }\n    if (event.name === recordType.ResourceReceiveResponse) {\n      if (eventData['fromCache']) {\n        // See BUG(chromium:998397): back-end over-approximates caching.\n        this._maybeDiskCached = true;\n      }\n      if (eventData['fromServiceWorker']) {\n        this.fromServiceWorker = true;\n      }\n      if (eventData['hasCachedResource']) {\n        this.hasCachedResource = true;\n      }\n      this.encodedDataLength = encodedDataLength;\n    }\n    if (event.name === recordType.ResourceReceivedData) {\n      this.encodedDataLength += encodedDataLength;\n    }\n    if (event.name === recordType.ResourceFinish && encodedDataLength) {\n      this.encodedDataLength = encodedDataLength;\n      // If a ResourceFinish event with an encoded data length is received,\n      // then the resource was not cached; it was fetched before it was\n      // requested, e.g. because it was pushed in this navigation.\n      this._transferSize = encodedDataLength;\n    }\n    const decodedBodyLength = eventData['decodedBodyLength'];\n    if (event.name === recordType.ResourceFinish && decodedBodyLength) {\n      this.decodedBodyLength = decodedBodyLength;\n    }\n    if (!this.url) {\n      this.url = eventData['url'];\n    }\n    if (!this.requestMethod) {\n      this.requestMethod = eventData['requestMethod'];\n    }\n    if (!this.timing) {\n      this.timing = eventData['timing'];\n    }\n    if (eventData['fromServiceWorker']) {\n      this.fromServiceWorker = true;\n    }\n  }\n\n  /**\n   * Return whether this request was cached. This works around BUG(chromium:998397),\n   * which reports pushed resources, and resources serverd by a service worker as\n   * disk cached. Pushed resources that were not disk cached, however, have a non-zero\n   * `_transferSize`.\n   * @return {boolean}\n   */\n  cached() {\n    return Boolean(this._memoryCached) ||\n        (Boolean(this._maybeDiskCached) && !this._transferSize && !this.fromServiceWorker);\n  }\n\n  /**\n   * Return whether this request was served from a memory cache.\n   * @return {boolean}\n   */\n  memoryCached() {\n    return this._memoryCached;\n  }\n\n  /**\n   * Get the timing information for this request. If the request was cached,\n   * the timing refers to the original (uncached) load, and should not be used.\n   * @return {!{sendStartTime: number, headersEndTime: number}}\n   */\n  getSendReceiveTiming() {\n    if (this.cached() || !this.timing) {\n      // If the request is served from cache, the timing refers to the original\n      // resource load, and should not be used.\n      return {sendStartTime: this.startTime, headersEndTime: this.startTime};\n    }\n    const requestTime = this.timing.requestTime * 1000;\n    const sendStartTime = requestTime + this.timing.sendStart;\n    const headersEndTime = requestTime + this.timing.receiveHeadersEnd;\n    return {sendStartTime, headersEndTime};\n  }\n\n  /**\n   * Get the start time of this request, i.e. the time when the browser or\n   * renderer queued this request. There are two cases where request time is\n   * earlier than `startTime`: (1) if the request is served from cache, because\n   * it refers to the original load of the resource. (2) if the request was\n   * initiated by the browser instead of the renderer. Only in case (2) the\n   * the request time must be used instead of the start time to work around\n   * BUG(chromium:865066).\n   * @return {number}\n   */\n  getStartTime() {\n    return Math.min(this.startTime, !this.cached() && this.timing && this.timing.requestTime * 1000 || Infinity);\n  }\n\n  /**\n   * Returns the time where the earliest event belonging to this request starts.\n   * This differs from `getStartTime()` if a previous HTTP/2 request pushed the\n   * resource proactively: Then `beginTime()` refers to the time the push was received.\n   * @return {number}\n   */\n  beginTime() {\n    // `pushStart` is referring to the original push if the request was cached (i.e. in\n    // general not the most recent push), and should hence only be used for requests that were not cached.\n    return Math.min(this.getStartTime(), !this.cached() && this.timing && this.timing.pushStart * 1000 || Infinity);\n  }\n}\n\nexport class InvalidationTrackingEvent {\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   */\n  constructor(event) {\n    /** @type {string} */\n    this.type = event.name;\n    /** @type {number} */\n    this.startTime = event.startTime;\n    /** @type {!SDK.TracingModel.Event} */\n    this._tracingEvent = event;\n\n    const eventData = event.args['data'];\n\n    /** @type {number} */\n    this.frame = eventData['frame'];\n    /** @type {?number} */\n    this.nodeId = eventData['nodeId'];\n    /** @type {?string} */\n    this.nodeName = eventData['nodeName'];\n    /** @type {?number} */\n    this.invalidationSet = eventData['invalidationSet'];\n    /** @type {?string} */\n    this.invalidatedSelectorId = eventData['invalidatedSelectorId'];\n    /** @type {?string} */\n    this.changedId = eventData['changedId'];\n    /** @type {?string} */\n    this.changedClass = eventData['changedClass'];\n    /** @type {?string} */\n    this.changedAttribute = eventData['changedAttribute'];\n    /** @type {?string} */\n    this.changedPseudo = eventData['changedPseudo'];\n    /** @type {?string} */\n    this.selectorPart = eventData['selectorPart'];\n    /** @type {?string} */\n    this.extraData = eventData['extraData'];\n    /** @type {?Array.<!Object.<string, number>>} */\n    this.invalidationList = eventData['invalidationList'];\n    /** @type {!InvalidationCause} */\n    this.cause = {reason: eventData['reason'], stackTrace: eventData['stackTrace']};\n    /** @type {boolean} */\n    this.linkedRecalcStyleEvent = false;\n    /** @type {boolean} */\n    this.linkedLayoutEvent = false;\n\n    // FIXME: Move this to TimelineUIUtils.js.\n    if (!this.cause.reason && this.cause.stackTrace && this.type === RecordType.LayoutInvalidationTracking) {\n      this.cause.reason = 'Layout forced';\n    }\n  }\n}\n\nexport class InvalidationTracker {\n  constructor() {\n    /** @type {?SDK.TracingModel.Event} */\n    this._lastRecalcStyle = null;\n    /** @type {?SDK.TracingModel.Event} */\n    this._lastPaintWithLayer = null;\n    this._didPaint = false;\n    this._initializePerFrameState();\n    /** @type {!Object.<string, !Array.<!InvalidationTrackingEvent>>} */\n    this._invalidations = {};\n    /** @type {!Object.<number, !Array.<!InvalidationTrackingEvent>>} */\n    this._invalidationsByNodeId = {};\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {?Array<!InvalidationTrackingEvent>}\n   */\n  static invalidationEventsFor(event) {\n    return eventToInvalidation.get(event) || null;\n  }\n\n  /**\n   * @param {!InvalidationTrackingEvent} invalidation\n   */\n  addInvalidation(invalidation) {\n    this._startNewFrameIfNeeded();\n\n    if (!invalidation.nodeId) {\n      console.error('Invalidation lacks node information.');\n      console.error(invalidation);\n      return;\n    }\n\n    const recordTypes = RecordType;\n\n    // Suppress StyleInvalidator StyleRecalcInvalidationTracking invalidations because they\n    // will be handled by StyleInvalidatorInvalidationTracking.\n    // FIXME: Investigate if we can remove StyleInvalidator invalidations entirely.\n    if (invalidation.type === recordTypes.StyleRecalcInvalidationTracking &&\n        invalidation.cause.reason === 'StyleInvalidator') {\n      return;\n    }\n\n    // Style invalidation events can occur before and during recalc style. didRecalcStyle\n    // handles style invalidations that occur before the recalc style event but we need to\n    // handle style recalc invalidations during recalc style here.\n    const styleRecalcInvalidation =\n        (invalidation.type === recordTypes.ScheduleStyleInvalidationTracking ||\n         invalidation.type === recordTypes.StyleInvalidatorInvalidationTracking ||\n         invalidation.type === recordTypes.StyleRecalcInvalidationTracking);\n    if (styleRecalcInvalidation) {\n      const duringRecalcStyle = invalidation.startTime && this._lastRecalcStyle &&\n          this._lastRecalcStyle.endTime !== undefined && invalidation.startTime >= this._lastRecalcStyle.startTime &&\n          invalidation.startTime <= this._lastRecalcStyle.endTime;\n      if (duringRecalcStyle) {\n        this._associateWithLastRecalcStyleEvent(invalidation);\n      }\n    }\n\n    // Record the invalidation so later events can look it up.\n    if (this._invalidations[invalidation.type]) {\n      this._invalidations[invalidation.type].push(invalidation);\n    } else {\n      this._invalidations[invalidation.type] = [invalidation];\n    }\n    if (invalidation.nodeId) {\n      if (this._invalidationsByNodeId[invalidation.nodeId]) {\n        this._invalidationsByNodeId[invalidation.nodeId].push(invalidation);\n      } else {\n        this._invalidationsByNodeId[invalidation.nodeId] = [invalidation];\n      }\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} recalcStyleEvent\n   */\n  didRecalcStyle(recalcStyleEvent) {\n    this._lastRecalcStyle = recalcStyleEvent;\n    const types = [\n      RecordType.ScheduleStyleInvalidationTracking, RecordType.StyleInvalidatorInvalidationTracking,\n      RecordType.StyleRecalcInvalidationTracking\n    ];\n    for (const invalidation of this._invalidationsOfTypes(types)) {\n      this._associateWithLastRecalcStyleEvent(invalidation);\n    }\n  }\n\n  /**\n   * @param {!InvalidationTrackingEvent} invalidation\n   */\n  _associateWithLastRecalcStyleEvent(invalidation) {\n    if (invalidation.linkedRecalcStyleEvent) {\n      return;\n    }\n\n    const recordTypes = RecordType;\n    if (!this._lastRecalcStyle) {\n      throw new Error('Last recalculate style event not set.');\n    }\n    const recalcStyleFrameId = this._lastRecalcStyle.args['beginData']['frame'];\n    if (invalidation.type === recordTypes.StyleInvalidatorInvalidationTracking) {\n      // Instead of calling _addInvalidationToEvent directly, we create synthetic\n      // StyleRecalcInvalidationTracking events which will be added in _addInvalidationToEvent.\n      this._addSyntheticStyleRecalcInvalidations(this._lastRecalcStyle, recalcStyleFrameId, invalidation);\n    } else if (invalidation.type === recordTypes.ScheduleStyleInvalidationTracking) {\n      // ScheduleStyleInvalidationTracking events are only used for adding information to\n      // StyleInvalidatorInvalidationTracking events. See: _addSyntheticStyleRecalcInvalidations.\n    } else {\n      this._addInvalidationToEvent(this._lastRecalcStyle, recalcStyleFrameId, invalidation);\n    }\n\n    invalidation.linkedRecalcStyleEvent = true;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @param {number} frameId\n   * @param {!InvalidationTrackingEvent} styleInvalidatorInvalidation\n   */\n  _addSyntheticStyleRecalcInvalidations(event, frameId, styleInvalidatorInvalidation) {\n    if (!styleInvalidatorInvalidation.invalidationList) {\n      this._addSyntheticStyleRecalcInvalidation(\n          styleInvalidatorInvalidation._tracingEvent, styleInvalidatorInvalidation);\n      return;\n    }\n    if (!styleInvalidatorInvalidation.nodeId) {\n      console.error('Invalidation lacks node information.');\n      console.error(styleInvalidatorInvalidation);\n      return;\n    }\n    for (let i = 0; i < styleInvalidatorInvalidation.invalidationList.length; i++) {\n      const setId = styleInvalidatorInvalidation.invalidationList[i]['id'];\n      let lastScheduleStyleRecalculation;\n      const nodeInvalidations = this._invalidationsByNodeId[styleInvalidatorInvalidation.nodeId] || [];\n      for (let j = 0; j < nodeInvalidations.length; j++) {\n        const invalidation = nodeInvalidations[j];\n        if (invalidation.frame !== frameId || invalidation.invalidationSet !== setId ||\n            invalidation.type !== RecordType.ScheduleStyleInvalidationTracking) {\n          continue;\n        }\n        lastScheduleStyleRecalculation = invalidation;\n      }\n      if (!lastScheduleStyleRecalculation) {\n        console.error('Failed to lookup the event that scheduled a style invalidator invalidation.');\n        continue;\n      }\n      this._addSyntheticStyleRecalcInvalidation(\n          lastScheduleStyleRecalculation._tracingEvent, styleInvalidatorInvalidation);\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} baseEvent\n   * @param {!InvalidationTrackingEvent} styleInvalidatorInvalidation\n   */\n  _addSyntheticStyleRecalcInvalidation(baseEvent, styleInvalidatorInvalidation) {\n    const invalidation = new InvalidationTrackingEvent(baseEvent);\n    invalidation.type = RecordType.StyleRecalcInvalidationTracking;\n    if (styleInvalidatorInvalidation.cause.reason) {\n      invalidation.cause.reason = styleInvalidatorInvalidation.cause.reason;\n    }\n    if (styleInvalidatorInvalidation.selectorPart) {\n      invalidation.selectorPart = styleInvalidatorInvalidation.selectorPart;\n    }\n\n    this.addInvalidation(invalidation);\n    if (!invalidation.linkedRecalcStyleEvent) {\n      this._associateWithLastRecalcStyleEvent(invalidation);\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} layoutEvent\n   */\n  didLayout(layoutEvent) {\n    const layoutFrameId = layoutEvent.args['beginData']['frame'];\n    for (const invalidation of this._invalidationsOfTypes([RecordType.LayoutInvalidationTracking])) {\n      if (invalidation.linkedLayoutEvent) {\n        continue;\n      }\n      this._addInvalidationToEvent(layoutEvent, layoutFrameId, invalidation);\n      invalidation.linkedLayoutEvent = true;\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} paintEvent\n   */\n  didPaint(paintEvent) {\n    this._didPaint = true;\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @param {number} eventFrameId\n   * @param {!InvalidationTrackingEvent} invalidation\n   */\n  _addInvalidationToEvent(event, eventFrameId, invalidation) {\n    if (eventFrameId !== invalidation.frame) {\n      return;\n    }\n    const invalidations = eventToInvalidation.get(event);\n    if (!invalidations) {\n      eventToInvalidation.set(event, [invalidation]);\n    } else {\n      invalidations.push(invalidation);\n    }\n  }\n\n  /**\n   * @param {!Array.<string>=} types\n   * @return {!Generator<!InvalidationTrackingEvent>}\n   */\n  _invalidationsOfTypes(types) {\n    const invalidations = this._invalidations;\n    if (!types) {\n      types = Object.keys(invalidations);\n    }\n    function* generator() {\n      if (!types) {\n        return;\n      }\n      for (let i = 0; i < types.length; ++i) {\n        const invalidationList = invalidations[types[i]] || [];\n        for (let j = 0; j < invalidationList.length; ++j) {\n          yield invalidationList[j];\n        }\n      }\n    }\n    return generator();\n  }\n\n  _startNewFrameIfNeeded() {\n    if (!this._didPaint) {\n      return;\n    }\n\n    this._initializePerFrameState();\n  }\n\n  _initializePerFrameState() {\n    this._invalidations = {};\n    this._invalidationsByNodeId = {};\n\n    this._lastRecalcStyle = null;\n    this._lastPaintWithLayer = null;\n    this._didPaint = false;\n  }\n}\n\nexport class TimelineAsyncEventTracker {\n  constructor() {\n    TimelineAsyncEventTracker._initialize();\n    /** @type {!Map<!RecordType, !Map<!RecordType, !SDK.TracingModel.Event>>} */\n    this._initiatorByType = new Map();\n    if (TimelineAsyncEventTracker._asyncEvents) {\n      for (const initiator of TimelineAsyncEventTracker._asyncEvents.keys()) {\n        this._initiatorByType.set(initiator, new Map());\n      }\n    }\n  }\n\n  static _initialize() {\n    if (TimelineAsyncEventTracker._asyncEvents) {\n      return;\n    }\n\n    /** @type {!Map<!RecordType, !{causes: !Array<!RecordType>, joinBy: string}>} */\n    const events = new Map();\n    const type = RecordType;\n\n    events.set(type.TimerInstall, {causes: [type.TimerFire], joinBy: 'timerId'});\n    events.set(type.ResourceSendRequest, {\n      causes: [type.ResourceMarkAsCached, type.ResourceReceiveResponse, type.ResourceReceivedData, type.ResourceFinish],\n      joinBy: 'requestId'\n    });\n    events.set(type.RequestAnimationFrame, {causes: [type.FireAnimationFrame], joinBy: 'id'});\n    events.set(type.RequestIdleCallback, {causes: [type.FireIdleCallback], joinBy: 'id'});\n    events.set(type.WebSocketCreate, {\n      causes: [type.WebSocketSendHandshakeRequest, type.WebSocketReceiveHandshakeResponse, type.WebSocketDestroy],\n      joinBy: 'identifier'\n    });\n\n    TimelineAsyncEventTracker._asyncEvents = events;\n    TimelineAsyncEventTracker._typeToInitiator = new Map();\n    for (const entry of events) {\n      const types = entry[1].causes;\n      for (const currentType of types) {\n        TimelineAsyncEventTracker._typeToInitiator.set(currentType, entry[0]);\n      }\n    }\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   */\n  processEvent(event) {\n    if (!TimelineAsyncEventTracker._typeToInitiator || !TimelineAsyncEventTracker._asyncEvents) {\n      return;\n    }\n    /** @type {!RecordType|undefined} */\n    let initiatorType = TimelineAsyncEventTracker._typeToInitiator.get(/** @type {!RecordType} */\n                                                                       (event.name));\n    const isInitiator = !initiatorType;\n    if (!initiatorType) {\n      initiatorType = /** @type {!RecordType}} */ (event.name);\n    }\n    const initiatorInfo = TimelineAsyncEventTracker._asyncEvents.get(initiatorType);\n    if (!initiatorInfo) {\n      return;\n    }\n    const id = /** @type {!RecordType} */ (TimelineModelImpl.globalEventId(event, initiatorInfo.joinBy));\n    if (!id) {\n      return;\n    }\n    /** @type {!Map<!RecordType, !SDK.TracingModel.Event>|undefined} */\n    const initiatorMap = this._initiatorByType.get(initiatorType);\n    if (initiatorMap) {\n      if (isInitiator) {\n        initiatorMap.set(id, event);\n        return;\n      }\n      const initiator = initiatorMap.get(id);\n      const timelineData = TimelineData.forEvent(event);\n      timelineData.setInitiator(initiator ? initiator : null);\n      if (!timelineData.frameId && initiator) {\n        timelineData.frameId = TimelineModelImpl.eventFrameId(initiator);\n      }\n    }\n  }\n}\n/** @type {?Map<!RecordType, !{causes: !Array<!RecordType>, joinBy: string}>} */\nTimelineAsyncEventTracker._asyncEvents = null;\n\n/** @type {?Map<!RecordType, !RecordType>} */\nTimelineAsyncEventTracker._typeToInitiator = null;\n\nexport class TimelineData {\n  constructor() {\n    /** @type {?string} */\n    this.warning = null;\n    /** @type {?Element} */\n    this.previewElement = null;\n    /** @type {?string} */\n    this.url = null;\n    /** @type {number} */\n    this.backendNodeId = 0;\n    /** @type {?Array<!Protocol.Runtime.CallFrame>} */\n    this.stackTrace = null;\n    /** @type {?SDK.TracingModel.ObjectSnapshot} */\n    this.picture = null;\n    /** @type {?SDK.TracingModel.Event} */\n    this._initiator = null;\n    this.frameId = '';\n    /** @type {number|undefined} */\n    this.timeWaitingForMainThread;\n  }\n\n  /**\n   * @param {?SDK.TracingModel.Event} initiator\n   */\n  setInitiator(initiator) {\n    this._initiator = initiator;\n    if (!initiator || this.url) {\n      return;\n    }\n    const initiatorURL = TimelineData.forEvent(initiator).url;\n    if (initiatorURL) {\n      this.url = initiatorURL;\n    }\n  }\n\n  /**\n   * @return {?SDK.TracingModel.Event}\n   */\n  initiator() {\n    return this._initiator;\n  }\n\n  /**\n   * @return {?Protocol.Runtime.CallFrame}\n   */\n  topFrame() {\n    const stackTrace = this.stackTraceForSelfOrInitiator();\n    return stackTrace && stackTrace[0] || null;\n  }\n\n  /**\n   * @return {?Array<!Protocol.Runtime.CallFrame>}\n   */\n  stackTraceForSelfOrInitiator() {\n    return this.stackTrace || (this._initiator && TimelineData.forEvent(this._initiator).stackTrace);\n  }\n\n  /**\n   * @param {!SDK.TracingModel.Event} event\n   * @return {!TimelineData}\n   */\n  static forEvent(event) {\n    let data = eventToData.get(event);\n    if (!data) {\n      data = new TimelineData();\n      eventToData.set(event, data);\n    }\n    return data;\n  }\n}\n\nconst eventToData = new WeakMap();\nconst eventToInvalidation = new WeakMap();\n\n/** @typedef {{reason: string, stackTrace: ?Array<!Protocol.Runtime.CallFrame>}} */\n// @ts-ignore typedef\nexport let InvalidationCause;\n\n/** @typedef {!{page: !Array<!SDK.TracingModel.Event>, workers: !Array<!SDK.TracingModel.Event>}} */\n// @ts-ignore typedef\nexport let MetadataEvents;\n"]}