{"version":3,"file":"TimelineProfileTree.js","sourceRoot":"","sources":["../../../../../front_end/timeline_model/TimelineProfileTree.js"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as SDK from '../sdk/sdk.js';  // eslint-disable-line no-unused-vars\n\nimport {TimelineJSProfileProcessor} from './TimelineJSProfile.js';\nimport {RecordType, TimelineData, TimelineModelImpl} from './TimelineModel.js';\nimport {TimelineModelFilter} from './TimelineModelFilter.js';  // eslint-disable-line no-unused-vars\n\nexport class Node {\n  /**\n   * @param {string|symbol} id\n   * @param {?SDK.TracingModel.Event} event\n   */\n  constructor(id, event) {\n    /** @type {number} */\n    this.totalTime = 0;\n    /** @type {number} */\n    this.selfTime = 0;\n    /** @type {string|symbol} */\n    this.id = id;\n    /** @type {?SDK.TracingModel.Event} */\n    this.event = event;\n    /** @type {?Node} */\n    this.parent;\n\n    /** @type {string} */\n    this._groupId = '';\n    this._isGroupNode = false;\n    this._depth = 0;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isGroupNode() {\n    return this._isGroupNode;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  hasChildren() {\n    throw 'Not implemented';\n  }\n\n  /**\n   * @param {boolean} value\n   */\n  setHasChildren(value) {\n    throw 'Not implemented';\n  }\n\n  /**\n   * @return {!ChildrenCache}\n   */\n  children() {\n    throw 'Not implemented';\n  }\n\n  /**\n   * @param {function(!SDK.TracingModel.Event):boolean} matchFunction\n   * @param {!Array<!Node>=} results\n   * @return {!Array<!Node>}\n   */\n  searchTree(matchFunction, results) {\n    results = results || [];\n    if (this.event && matchFunction(this.event)) {\n      results.push(this);\n    }\n    for (const child of this.children().values()) {\n      child.searchTree(matchFunction, results);\n    }\n    return results;\n  }\n}\n\nexport class TopDownNode extends Node {\n  /**\n   * @param {string|symbol} id\n   * @param {?SDK.TracingModel.Event} event\n   * @param {?TopDownNode} parent\n   */\n  constructor(id, event, parent) {\n    super(id, event);\n    /** @type {?TopDownRootNode} */\n    this._root = parent && parent._root;\n    this._hasChildren = false;\n    this._children = null;\n    this.parent = parent;\n  }\n\n  /**\n   * @override\n   * @return {boolean}\n   */\n  hasChildren() {\n    return this._hasChildren;\n  }\n\n  /**\n   * @override\n   * @param {boolean} value\n   */\n  setHasChildren(value) {\n    this._hasChildren = value;\n  }\n\n  /**\n   * @override\n   * @return {!ChildrenCache}\n   */\n  children() {\n    return this._children || this._buildChildren();\n  }\n\n  /**\n   * @return {!ChildrenCache}\n   */\n  _buildChildren() {\n    /** @type {!Array<!TopDownNode>} */\n    const path = [];\n    for (let node = /** @type {!TopDownNode} */ (this); node.parent && !node._isGroupNode; node = node.parent) {\n      path.push(/** @type {!TopDownNode} */ (node));\n    }\n    path.reverse();\n    /** @type {!ChildrenCache} */\n    const children = new Map();\n    const self = this;\n    const root = this._root;\n    if (!root) {\n      this._children = children;\n      return this._children;\n    }\n    const startTime = root._startTime;\n    const endTime = root._endTime;\n    const instantEventCallback = root._doNotAggregate ? onInstantEvent : undefined;\n    const eventIdCallback = root._doNotAggregate ? undefined : _eventId;\n    const eventGroupIdCallback = root._eventGroupIdCallback;\n    let depth = 0;\n    let matchedDepth = 0;\n    /**\n     * @type {?Node}\n     */\n    let currentDirectChild = null;\n    TimelineModelImpl.forEachEvent(\n        root._events, onStartEvent, onEndEvent, instantEventCallback, startTime, endTime, root._filter);\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    function onStartEvent(e) {\n      ++depth;\n      if (depth > path.length + 2) {\n        return;\n      }\n      if (!matchPath(e)) {\n        return;\n      }\n      const actualEndTime = e.endTime !== undefined ? Math.min(e.endTime, endTime) : endTime;\n      const duration = actualEndTime - Math.max(startTime, e.startTime);\n      if (duration < 0) {\n        console.error('Negative event duration');\n      }\n      processEvent(e, duration);\n    }\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    function onInstantEvent(e) {\n      ++depth;\n      if (matchedDepth === path.length && depth <= path.length + 2) {\n        processEvent(e, 0);\n      }\n      --depth;\n    }\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     * @param {number} duration\n     */\n    function processEvent(e, duration) {\n      if (depth === path.length + 2) {\n        if (!currentDirectChild) {\n          return;\n        }\n        currentDirectChild.setHasChildren(true);\n        currentDirectChild.selfTime -= duration;\n        return;\n      }\n      let id;\n      let groupId = '';\n      if (!eventIdCallback) {\n        id = Symbol('uniqueId');\n      } else {\n        id = eventIdCallback(e);\n        groupId = eventGroupIdCallback ? eventGroupIdCallback(e) : '';\n        if (groupId) {\n          id += '/' + groupId;\n        }\n      }\n      let node = children.get(id);\n      if (!node) {\n        node = new TopDownNode(id, e, self);\n        node._groupId = groupId;\n        children.set(id, node);\n      }\n      node.selfTime += duration;\n      node.totalTime += duration;\n      currentDirectChild = node;\n    }\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     * @return {boolean}\n     */\n    function matchPath(e) {\n      if (matchedDepth === path.length) {\n        return true;\n      }\n      if (matchedDepth !== depth - 1) {\n        return false;\n      }\n      if (!e.endTime) {\n        return false;\n      }\n      if (!eventIdCallback) {\n        if (e === path[matchedDepth].event) {\n          ++matchedDepth;\n        }\n        return false;\n      }\n      let id = eventIdCallback(e);\n      const groupId = eventGroupIdCallback ? eventGroupIdCallback(e) : '';\n      if (groupId) {\n        id += '/' + groupId;\n      }\n      if (id === path[matchedDepth].id) {\n        ++matchedDepth;\n      }\n      return false;\n    }\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    function onEndEvent(e) {\n      --depth;\n      if (matchedDepth > depth) {\n        matchedDepth = depth;\n      }\n    }\n\n    this._children = children;\n    return children;\n  }\n}\n\nexport class TopDownRootNode extends TopDownNode {\n  /**\n   * @param {!Array<!SDK.TracingModel.Event>} events\n   * @param {!Array<!TimelineModelFilter>} filters\n   * @param {number} startTime\n   * @param {number} endTime\n   * @param {boolean=} doNotAggregate\n   * @param {?function(!SDK.TracingModel.Event):string=} eventGroupIdCallback\n   */\n  constructor(events, filters, startTime, endTime, doNotAggregate, eventGroupIdCallback) {\n    super('', null, null);\n    this._root = this;\n    this._events = events;\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    this._filter = e => filters.every(f => f.accept(e));\n    this._startTime = startTime;\n    this._endTime = endTime;\n    this._eventGroupIdCallback = eventGroupIdCallback;\n    this._doNotAggregate = doNotAggregate;\n    this.totalTime = endTime - startTime;\n    this.selfTime = this.totalTime;\n  }\n\n  /**\n   * @override\n   * @return {!ChildrenCache}\n   */\n  children() {\n    return this._children || this._grouppedTopNodes();\n  }\n\n  /**\n   * @return {!ChildrenCache}\n   */\n  _grouppedTopNodes() {\n    const flatNodes = super.children();\n    for (const node of flatNodes.values()) {\n      this.selfTime -= node.totalTime;\n    }\n    if (!this._eventGroupIdCallback) {\n      return flatNodes;\n    }\n    const groupNodes = new Map();\n    for (const node of flatNodes.values()) {\n      const groupId = this._eventGroupIdCallback(/** @type {!SDK.TracingModel.Event} */ (node.event));\n      let groupNode = groupNodes.get(groupId);\n      if (!groupNode) {\n        groupNode = new GroupNode(groupId, this, /** @type {!SDK.TracingModel.Event} */ (node.event));\n        groupNodes.set(groupId, groupNode);\n      }\n      groupNode.addChild(node, node.selfTime, node.totalTime);\n    }\n    this._children = groupNodes;\n    return groupNodes;\n  }\n}\n\nexport class BottomUpRootNode extends Node {\n  /**\n   * @param {!Array<!SDK.TracingModel.Event>} events\n   * @param {!TimelineModelFilter} textFilter\n   * @param {!Array<!TimelineModelFilter>} filters\n   * @param {number} startTime\n   * @param {number} endTime\n   * @param {?function(!SDK.TracingModel.Event):string} eventGroupIdCallback\n   */\n  constructor(events, textFilter, filters, startTime, endTime, eventGroupIdCallback) {\n    super('', null);\n    /** @type {?ChildrenCache} */\n    this._children = null;\n    this._events = events;\n    this._textFilter = textFilter;\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    this._filter = e => filters.every(f => f.accept(e));\n    this._startTime = startTime;\n    this._endTime = endTime;\n    this._eventGroupIdCallback = eventGroupIdCallback;\n    this.totalTime = endTime - startTime;\n  }\n\n  /**\n   * @override\n   * @return {boolean}\n   */\n  hasChildren() {\n    return true;\n  }\n\n  /**\n   * @param {!ChildrenCache} children\n   * @return {!ChildrenCache}\n   */\n  _filterChildren(children) {\n    for (const [id, child] of children) {\n      if (child.event && !this._textFilter.accept(child.event)) {\n        children.delete(/** @type {string|symbol} */ (id));\n      }\n    }\n    return children;\n  }\n\n  /**\n   * @override\n   * @return {!ChildrenCache}\n   */\n  children() {\n    if (!this._children) {\n      this._children = this._filterChildren(this._grouppedTopNodes());\n    }\n    return this._children;\n  }\n\n  /**\n   * @return {!ChildrenCache}\n   */\n  _ungrouppedTopNodes() {\n    const root = this;\n    const startTime = this._startTime;\n    const endTime = this._endTime;\n    /** @type {!ChildrenCache} */\n    const nodeById = new Map();\n    /** @type {!Array<number>} */\n    const selfTimeStack = [endTime - startTime];\n    /** @type {!Array<boolean>} */\n    const firstNodeStack = [];\n    /** @type {!Map<string, number>} */\n    const totalTimeById = new Map();\n    TimelineModelImpl.forEachEvent(this._events, onStartEvent, onEndEvent, undefined, startTime, endTime, this._filter);\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    function onStartEvent(e) {\n      const actualEndTime = e.endTime !== undefined ? Math.min(e.endTime, endTime) : endTime;\n      const duration = actualEndTime - Math.max(e.startTime, startTime);\n      selfTimeStack[selfTimeStack.length - 1] -= duration;\n      selfTimeStack.push(duration);\n      const id = _eventId(e);\n      const noNodeOnStack = !totalTimeById.has(id);\n      if (noNodeOnStack) {\n        totalTimeById.set(id, duration);\n      }\n      firstNodeStack.push(noNodeOnStack);\n    }\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    function onEndEvent(e) {\n      const id = _eventId(e);\n      let node = nodeById.get(id);\n      if (!node) {\n        node = new BottomUpNode(root, id, e, false, root);\n        nodeById.set(id, node);\n      }\n      node.selfTime += selfTimeStack.pop() || 0;\n      if (firstNodeStack.pop()) {\n        node.totalTime += totalTimeById.get(id) || 0;\n        totalTimeById.delete(id);\n      }\n      if (firstNodeStack.length) {\n        node.setHasChildren(true);\n      }\n    }\n\n    this.selfTime = selfTimeStack.pop() || 0;\n    for (const pair of nodeById) {\n      if (pair[1].selfTime <= 0) {\n        nodeById.delete(/** @type {string} */ (pair[0]));\n      }\n    }\n    return nodeById;\n  }\n\n  /**\n   * @return {!ChildrenCache}\n   */\n  _grouppedTopNodes() {\n    const flatNodes = this._ungrouppedTopNodes();\n    if (!this._eventGroupIdCallback) {\n      return flatNodes;\n    }\n    const groupNodes = new Map();\n    for (const node of flatNodes.values()) {\n      const groupId = this._eventGroupIdCallback(/** @type {!SDK.TracingModel.Event} */ (node.event));\n      let groupNode = groupNodes.get(groupId);\n      if (!groupNode) {\n        groupNode = new GroupNode(groupId, this, /** @type {!SDK.TracingModel.Event} */ (node.event));\n        groupNodes.set(groupId, groupNode);\n      }\n      groupNode.addChild(node, node.selfTime, node.selfTime);\n    }\n    return groupNodes;\n  }\n}\n\nexport class GroupNode extends Node {\n  /**\n   * @param {string} id\n   * @param {!BottomUpRootNode|!TopDownRootNode} parent\n   * @param {!SDK.TracingModel.Event} event\n   */\n  constructor(id, parent, event) {\n    super(id, event);\n    this._children = new Map();\n    this.parent = parent;\n    this._isGroupNode = true;\n  }\n\n  /**\n   * @param {!BottomUpNode} child\n   * @param {number} selfTime\n   * @param {number} totalTime\n   */\n  addChild(child, selfTime, totalTime) {\n    this._children.set(child.id, child);\n    this.selfTime += selfTime;\n    this.totalTime += totalTime;\n    child.parent = this;\n  }\n\n  /**\n   * @override\n   * @return {boolean}\n   */\n  hasChildren() {\n    return true;\n  }\n\n  /**\n   * @override\n   * @return {!ChildrenCache}\n   */\n  children() {\n    return this._children;\n  }\n}\n\nexport class BottomUpNode extends Node {\n  /**\n   * @param {!BottomUpRootNode} root\n   * @param {string} id\n   * @param {!SDK.TracingModel.Event} event\n   * @param {boolean} hasChildren\n   * @param {!Node} parent\n   */\n  constructor(root, id, event, hasChildren, parent) {\n    super(id, event);\n    this.parent = parent;\n    this._root = root;\n    this._depth = (parent._depth || 0) + 1;\n    /** @type {?ChildrenCache} */\n    this._cachedChildren = null;\n    this._hasChildren = hasChildren;\n  }\n\n  /**\n   * @override\n   * @return {boolean}\n   */\n  hasChildren() {\n    return this._hasChildren;\n  }\n\n  /**\n   * @override\n   * @param {boolean} value\n   */\n  setHasChildren(value) {\n    this._hasChildren = value;\n  }\n\n  /**\n   * @override\n   * @return {!ChildrenCache}\n   */\n  children() {\n    if (this._cachedChildren) {\n      return this._cachedChildren;\n    }\n    /** @type {!Array<number>} */\n    const selfTimeStack = [0];\n    /** @type {!Array<string>} */\n    const eventIdStack = [];\n    /** @type {!Array<!SDK.TracingModel.Event>} */\n    const eventStack = [];\n    /** @type {!ChildrenCache} */\n    const nodeById = new Map();\n    const startTime = this._root._startTime;\n    const endTime = this._root._endTime;\n    let lastTimeMarker = startTime;\n    const self = this;\n    TimelineModelImpl.forEachEvent(\n        this._root._events, onStartEvent, onEndEvent, undefined, startTime, endTime, this._root._filter);\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    function onStartEvent(e) {\n      const actualEndTime = e.endTime !== undefined ? Math.min(e.endTime, endTime) : endTime;\n      const duration = actualEndTime - Math.max(e.startTime, startTime);\n      if (duration < 0) {\n        console.assert(false, 'Negative duration of an event');\n      }\n      selfTimeStack[selfTimeStack.length - 1] -= duration;\n      selfTimeStack.push(duration);\n      const id = _eventId(e);\n      eventIdStack.push(id);\n      eventStack.push(e);\n    }\n\n    /**\n     * @param {!SDK.TracingModel.Event} e\n     */\n    function onEndEvent(e) {\n      const selfTime = selfTimeStack.pop();\n      const id = eventIdStack.pop();\n      eventStack.pop();\n      let node;\n      for (node = self; node._depth > 1; node = node.parent) {\n        if (node.id !== eventIdStack[eventIdStack.length + 1 - node._depth]) {\n          return;\n        }\n      }\n      if (node.id !== id || eventIdStack.length < self._depth) {\n        return;\n      }\n      const childId = eventIdStack[eventIdStack.length - self._depth];\n      node = nodeById.get(childId);\n      if (!node) {\n        const event = eventStack[eventStack.length - self._depth];\n        const hasChildren = eventStack.length > self._depth;\n        node = new BottomUpNode(self._root, childId, event, hasChildren, self);\n        nodeById.set(childId, node);\n      }\n      const actualEndTime = e.endTime !== undefined ? Math.min(e.endTime, endTime) : endTime;\n      const totalTime = actualEndTime - Math.max(e.startTime, lastTimeMarker);\n      node.selfTime += selfTime || 0;\n      node.totalTime += totalTime;\n      lastTimeMarker = actualEndTime;\n    }\n\n    this._cachedChildren = this._root._filterChildren(nodeById);\n    return this._cachedChildren;\n  }\n\n  /**\n   * @override\n   * @param {function(!SDK.TracingModel.Event):boolean} matchFunction\n   * @param {!Array<!Node>=} results\n   * @return {!Array<!Node>}\n   */\n  searchTree(matchFunction, results) {\n    results = results || [];\n    if (this.event && matchFunction(this.event)) {\n      results.push(this);\n    }\n    return results;\n  }\n}\n\n/**\n * @param {!SDK.TracingModel.Event} event\n * @return {?string}\n */\nexport function eventURL(event) {\n  const data = event.args['data'] || event.args['beginData'];\n  if (data && data['url']) {\n    return data['url'];\n  }\n  let frame = eventStackFrame(event);\n  while (frame) {\n    const url = frame['url'];\n    if (url) {\n      return url;\n    }\n    // TODO(crbug.com/1011811): Runtime.CallFrame does not seem to have .parent at all.\n    frame = /** @type {?Protocol.Runtime.CallFrame} */ (/** @type {*} */ (frame).parent);\n  }\n  return null;\n}\n\n/**\n * @param {!SDK.TracingModel.Event} event\n * @return {?Protocol.Runtime.CallFrame}\n */\nexport function eventStackFrame(event) {\n  if (event.name === RecordType.JSFrame) {\n    return /** @type {?Protocol.Runtime.CallFrame} */ (event.args['data'] || null);\n  }\n  return TimelineData.forEvent(event).topFrame();\n}\n\n/**\n * @param {!SDK.TracingModel.Event} event\n * @return {string}\n */\nexport function _eventId(event) {\n  if (event.name === RecordType.TimeStamp) {\n    return `${event.name}:${event.args.data.message}`;\n  }\n  if (event.name !== RecordType.JSFrame) {\n    return event.name;\n  }\n  const frame = event.args['data'];\n  const location = frame['scriptId'] || frame['url'] || '';\n  const functionName = frame['functionName'];\n  const name = TimelineJSProfileProcessor.isNativeRuntimeFrame(frame) ?\n      TimelineJSProfileProcessor.nativeGroup(functionName) || functionName :\n      `${functionName}:${frame['lineNumber']}:${frame['columnNumber']}`;\n  return `f:${name}@${location}`;\n}\n\n/**\n * @typedef {Map<string|symbol, !Node>}\n */\n// @ts-ignore typedef\nexport let ChildrenCache;\n"]}