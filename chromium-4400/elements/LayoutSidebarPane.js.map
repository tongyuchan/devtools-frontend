{"version":3,"file":"LayoutSidebarPane.js","sourceRoot":"","sources":["../../../../../front_end/elements/LayoutSidebarPane.js"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../common/common.js';\nimport * as Root from '../root/root.js';\nimport * as SDK from '../sdk/sdk.js';\nimport * as UI from '../ui/ui.js';\n\nimport {ElementsPanel} from './ElementsPanel.js';\nimport {LayoutElement, LayoutPane} from './LayoutPane.js';  // eslint-disable-line no-unused-vars\n\n/**\n * @param {!SDK.DOMModel.DOMNode} node\n * @return {!LayoutElement}\n */\nconst nodeToLayoutElement = node => {\n  const className = node.getAttribute('class');\n  const nodeId = node.id;\n  return {\n    id: nodeId,\n    color: '#000',\n    name: node.localName(),\n    domId: node.getAttribute('id'),\n    domClasses: className ? className.split(/\\s+/).filter(s => Boolean(s)) : undefined,\n    enabled: false,\n    reveal: () => {\n      ElementsPanel.instance().revealAndSelectNode(node, true, true);\n      node.scrollIntoView();\n    },\n    highlight: () => {\n      node.highlight();\n    },\n    hideHighlight: () => {\n      SDK.OverlayModel.OverlayModel.hideDOMNodeHighlight();\n    },\n    toggle: value => {\n      throw new Error('Not implemented');\n    },\n    setColor(value) {\n      throw new Error('Not implemented');\n    },\n  };\n};\n\n/**\n * @param {!Array<!SDK.DOMModel.DOMNode>} nodes\n * @return {!Array<!LayoutElement>}\n */\nconst gridNodesToElements = nodes => {\n  return nodes.map(node => {\n    const layoutElement = nodeToLayoutElement(node);\n    const nodeId = node.id;\n    return {\n      ...layoutElement,\n      color: node.domModel().overlayModel().colorOfGridInPersistentOverlay(nodeId) || '#000',\n      enabled: node.domModel().overlayModel().isHighlightedGridInPersistentOverlay(nodeId),\n      toggle: value => {\n        if (value) {\n          node.domModel().overlayModel().highlightGridInPersistentOverlay(nodeId);\n        } else {\n          node.domModel().overlayModel().hideGridInPersistentOverlay(nodeId);\n        }\n      },\n      setColor(value) {\n        this.color = value;\n        node.domModel().overlayModel().setColorOfGridInPersistentOverlay(nodeId, value);\n      },\n    };\n  });\n};\n\n/** @type {!LayoutSidebarPane} */\nlet layoutSidebarPaneInstance;\n\n/**\n * @param {!Array<!SDK.DOMModel.DOMNode>} nodes\n * @return {!Array<!LayoutElement>}\n */\nconst flexContainerNodesToElements = nodes => {\n  return nodes.map(node => {\n    const layoutElement = nodeToLayoutElement(node);\n    const nodeId = node.id;\n    return {\n      ...layoutElement,\n      color: node.domModel().overlayModel().colorOfFlexInPersistentOverlay(nodeId) || '#000',\n      enabled: node.domModel().overlayModel().isHighlightedFlexContainerInPersistentOverlay(nodeId),\n      toggle: value => {\n        if (value) {\n          node.domModel().overlayModel().highlightFlexContainerInPersistentOverlay(nodeId);\n        } else {\n          node.domModel().overlayModel().hideFlexContainerInPersistentOverlay(nodeId);\n        }\n      },\n      setColor(value) {\n        this.color = value;\n        node.domModel().overlayModel().setColorOfFlexInPersistentOverlay(nodeId, value);\n      },\n    };\n  });\n};\n\nexport class LayoutSidebarPane extends UI.ThrottledWidget.ThrottledWidget {\n  constructor() {\n    super(true /* isWebComponent */);\n    this._layoutPane = new LayoutPane();\n    this.contentElement.appendChild(this._layoutPane);\n    this._settings = ['showGridLineLabels', 'showGridTrackSizes', 'showGridAreas', 'extendGridLines'];\n    this._uaShadowDOMSetting = Common.Settings.Settings.instance().moduleSetting('showUAShadowDOM');\n    this._boundOnSettingChanged = this.onSettingChanged.bind(this);\n    /**\n     * @type {!Array<!SDK.DOMModel.DOMModel>}\n     */\n    this._domModels = [];\n  }\n\n  /**\n   * @param {{forceNew: ?boolean}=} opts\n   * @return {!LayoutSidebarPane}\n   */\n  static instance(opts = {forceNew: null}) {\n    const {forceNew} = opts;\n    if (!layoutSidebarPaneInstance || forceNew) {\n      layoutSidebarPaneInstance = new LayoutSidebarPane();\n    }\n\n    return layoutSidebarPaneInstance;\n  }\n\n  /**\n   * @param {!SDK.DOMModel.DOMModel} domModel\n   */\n  modelAdded(domModel) {\n    const overlayModel = domModel.overlayModel();\n    overlayModel.addEventListener(SDK.OverlayModel.Events.PersistentGridOverlayStateChanged, this.update, this);\n    overlayModel.addEventListener(\n        SDK.OverlayModel.Events.PersistentFlexContainerOverlayStateChanged, this.update, this);\n    this._domModels.push(domModel);\n  }\n\n  /**\n   * @param {!SDK.DOMModel.DOMModel} domModel\n   */\n  modelRemoved(domModel) {\n    const overlayModel = domModel.overlayModel();\n    overlayModel.removeEventListener(SDK.OverlayModel.Events.PersistentGridOverlayStateChanged, this.update, this);\n    overlayModel.removeEventListener(\n        SDK.OverlayModel.Events.PersistentFlexContainerOverlayStateChanged, this.update, this);\n    this._domModels = this._domModels.filter(model => model !== domModel);\n  }\n\n  /**\n   * @param {!Array<{ name: string, value: string }>} style\n   */\n  async _fetchNodesByStyle(style) {\n    const showUAShadowDOM = this._uaShadowDOMSetting.get();\n\n    const nodes = [];\n    for (const domModel of this._domModels) {\n      try {\n        const nodeIds = await domModel.getNodesByStyle(style, true /* pierce */);\n        for (const nodeId of nodeIds) {\n          const node = domModel.nodeForId(nodeId);\n          if (node !== null && (showUAShadowDOM || !node.ancestorUserAgentShadowRoot())) {\n            nodes.push(node);\n          }\n        }\n      } catch (error) {\n        // TODO(crbug.com/1167706): Sometimes in E2E tests the layout panel is updated after a DOM node\n        // has been removed. This causes an error that a node has not been found.\n        // We can skip nodes that resulted in an error.\n        console.warn(error);\n      }\n    }\n\n    return nodes;\n  }\n\n  async _fetchGridNodes() {\n    return await this._fetchNodesByStyle([{name: 'display', value: 'grid'}, {name: 'display', value: 'inline-grid'}]);\n  }\n\n  async _fetchFlexContainerNodes() {\n    return await this._fetchNodesByStyle([{name: 'display', value: 'flex'}, {name: 'display', value: 'inline-flex'}]);\n  }\n\n  _mapSettings() {\n    const settings = [];\n    for (const settingName of this._settings) {\n      const setting = Common.Settings.Settings.instance().moduleSetting(settingName);\n      const settingValue = setting.get();\n      const mappedSetting = {\n        type: /** @type {*} */ (setting.type()),\n        name: setting.name,\n        title: setting.title(),\n      };\n      if (typeof settingValue === 'boolean') {\n        settings.push({\n          ...mappedSetting,\n          value: settingValue,\n          options: setting.options().map(opt => ({\n                                           ...opt,\n                                           value: /** @type {boolean} */ (opt.value),\n                                         }))\n        });\n      } else if (typeof settingValue === 'string') {\n        settings.push({\n          ...mappedSetting,\n          value: settingValue,\n          options: setting.options().map(opt => ({\n                                           ...opt,\n                                           value: /** @type {string} */ (opt.value),\n                                         }))\n        });\n      }\n    }\n    return settings;\n  }\n\n  /**\n   * @override\n   * @protected\n   * @return {!Promise<void>}\n   */\n  async doUpdate() {\n    this._layoutPane.data = {\n      gridElements: gridNodesToElements(await this._fetchGridNodes()),\n      flexContainerElements: Root.Runtime.experiments.isEnabled('cssFlexboxFeatures') ?\n          flexContainerNodesToElements(await this._fetchFlexContainerNodes()) :\n          undefined,\n      settings: this._mapSettings(),\n    };\n  }\n\n  /**\n   * @param {*} event\n   */\n  onSettingChanged(event) {\n    Common.Settings.Settings.instance().moduleSetting(event.data.setting).set(event.data.value);\n  }\n\n  /**\n   * @override\n   */\n  wasShown() {\n    for (const setting of this._settings) {\n      Common.Settings.Settings.instance().moduleSetting(setting).addChangeListener(this.update, this);\n    }\n    this._layoutPane.addEventListener('setting-changed', this._boundOnSettingChanged);\n    for (const domModel of this._domModels) {\n      this.modelRemoved(domModel);\n    }\n    this._domModels = [];\n    SDK.SDKModel.TargetManager.instance().observeModels(SDK.DOMModel.DOMModel, this);\n    UI.Context.Context.instance().addFlavorChangeListener(SDK.DOMModel.DOMNode, this.update, this);\n    this._uaShadowDOMSetting.addChangeListener(this.update, this);\n    this.update();\n  }\n\n  /**\n   * @override\n   */\n  willHide() {\n    for (const setting of this._settings) {\n      Common.Settings.Settings.instance().moduleSetting(setting).removeChangeListener(this.update, this);\n    }\n    this._layoutPane.removeEventListener('setting-changed', this._boundOnSettingChanged);\n    SDK.SDKModel.TargetManager.instance().unobserveModels(SDK.DOMModel.DOMModel, this);\n    UI.Context.Context.instance().removeFlavorChangeListener(SDK.DOMModel.DOMNode, this.update, this);\n    this._uaShadowDOMSetting.removeChangeListener(this.update, this);\n  }\n}\n"]}