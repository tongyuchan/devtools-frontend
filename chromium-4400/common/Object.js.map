{"version":3,"file":"Object.js","sourceRoot":"","sources":["../../../../../front_end/common/Object.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;GAuBG;AAIH;;GAEG;AACH,IAAI,sBAAsB,CAAC,CAAE,qCAAqC;AAElE;;GAEG;AACH,MAAM,OAAO,aAAa;IACxB;QACE,+EAA+E;QAC/E,IAAI,CAAC,UAAU,CAAC;IAClB,CAAC;IAED;;;;;;OAMG;IACH,gBAAgB,CAAC,SAAS,EAAE,QAAQ,EAAE,UAAU;QAC9C,IAAI,CAAC,QAAQ,EAAE;YACb,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;SACvB;QAED,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,UAAU,GAAG,IAAI,GAAG,EAAE,CAAC;SAC7B;QAED,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;YACnC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;SACpC;QACD,MAAM,oBAAoB,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAC5D,IAAI,oBAAoB,EAAE;YACxB,oBAAoB,CAAC,IAAI,CAAC,EAAC,UAAU,EAAE,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAC,CAAC,CAAC;SAC9F;QACD,OAAO,EAAC,WAAW,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAC,CAAC;IAC/F,CAAC;IAED;;;;OAIG;IACH,IAAI,CAAC,SAAS;QACZ,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;YAC3B,MAAM,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,KAAK,CAAC,EAAE;gBAC1D,IAAI,CAAC,mBAAmB,CAAC,SAAS,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC;gBACzD,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACtB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;;;;OAKG;IACH,mBAAmB,CAAC,SAAS,EAAE,QAAQ,EAAE,UAAU;QACjD,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;QAElC,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;YACvD,OAAO;SACR;QACD,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;QACvD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YACzC,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,QAAQ,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU,KAAK,UAAU,EAAE;gBAChF,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC;gBAC7B,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;aAC1B;SACF;QAED,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;YACrB,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;SACnC;IACH,CAAC;IAED;;;;OAIG;IACH,iBAAiB,CAAC,SAAS;QACzB,OAAO,OAAO,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;IACpE,CAAC;IAED;;;;OAIG;IACH,wBAAwB,CAAC,SAAS,EAAE,SAAS;QAC3C,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;YACvD,OAAO;SACR;QAED,MAAM,KAAK,GAAG,gCAAgC,CAAC,CAAC,EAAC,IAAI,EAAE,SAAS,EAAC,CAAC,CAAC;QACnE,iDAAiD;QACjD,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;QAChE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YACzC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;gBAC1B,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;aAC5D;SACF;IACH,CAAC;CACF","sourcesContent":["/*\n * Copyright (C) 2008 Apple Inc. All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport {EventDescriptor, EventTarget, EventTargetEvent} from './EventTarget.js';  // eslint-disable-line no-unused-vars\n\n/**\n * @typedef {!{thisObject: (!Object|undefined), listener: function(!EventTargetEvent):void, disposed: (boolean|undefined)}}\n */\nlet _listenerCallbackTuple;  // eslint-disable-line no-unused-vars\n\n/**\n * @implements {EventTarget}\n */\nexport class ObjectWrapper {\n  constructor() {\n    /** @type {(!Map<string|symbol, !Array<!_listenerCallbackTuple>>|undefined)} */\n    this._listeners;\n  }\n\n  /**\n   * @override\n   * @param {string|symbol} eventType\n   * @param {function(!EventTargetEvent):void} listener\n   * @param {!Object=} thisObject\n   * @return {!EventDescriptor}\n   */\n  addEventListener(eventType, listener, thisObject) {\n    if (!listener) {\n      console.assert(false);\n    }\n\n    if (!this._listeners) {\n      this._listeners = new Map();\n    }\n\n    if (!this._listeners.has(eventType)) {\n      this._listeners.set(eventType, []);\n    }\n    const listenerForEventType = this._listeners.get(eventType);\n    if (listenerForEventType) {\n      listenerForEventType.push({thisObject: thisObject, listener: listener, disposed: undefined});\n    }\n    return {eventTarget: this, eventType: eventType, thisObject: thisObject, listener: listener};\n  }\n\n  /**\n   * @override\n   * @param {string|symbol} eventType\n   * @return {!Promise<*>}\n   */\n  once(eventType) {\n    return new Promise(resolve => {\n      const descriptor = this.addEventListener(eventType, event => {\n        this.removeEventListener(eventType, descriptor.listener);\n        resolve(event.data);\n      });\n    });\n  }\n\n  /**\n   * @override\n   * @param {string|symbol} eventType\n   * @param {function(!EventTargetEvent):void} listener\n   * @param {!Object=} thisObject\n   */\n  removeEventListener(eventType, listener, thisObject) {\n    console.assert(Boolean(listener));\n\n    if (!this._listeners || !this._listeners.has(eventType)) {\n      return;\n    }\n    const listeners = this._listeners.get(eventType) || [];\n    for (let i = 0; i < listeners.length; ++i) {\n      if (listeners[i].listener === listener && listeners[i].thisObject === thisObject) {\n        listeners[i].disposed = true;\n        listeners.splice(i--, 1);\n      }\n    }\n\n    if (!listeners.length) {\n      this._listeners.delete(eventType);\n    }\n  }\n\n  /**\n   * @override\n   * @param {string|symbol} eventType\n   * @return {boolean}\n   */\n  hasEventListeners(eventType) {\n    return Boolean(this._listeners && this._listeners.has(eventType));\n  }\n\n  /**\n   * @override\n   * @param {string|symbol} eventType\n   * @param {*=} eventData\n   */\n  dispatchEventToListeners(eventType, eventData) {\n    if (!this._listeners || !this._listeners.has(eventType)) {\n      return;\n    }\n\n    const event = /** @type {!EventTargetEvent} */ ({data: eventData});\n    // @ts-ignore we do the check for undefined above\n    const listeners = this._listeners.get(eventType).slice(0) || [];\n    for (let i = 0; i < listeners.length; ++i) {\n      if (!listeners[i].disposed) {\n        listeners[i].listener.call(listeners[i].thisObject, event);\n      }\n    }\n  }\n}\n"]}